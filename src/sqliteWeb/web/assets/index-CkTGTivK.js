const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./registerServiceWorker-1SkHNPsI.js","./vendor-BaPbTCFd.js","./maps-yMw3Pr4N.js","./maps-CuCRB34y.css","./vendor-B78enaR7.css"])))=>i.map(i=>d[i]);
import{n as U,W as Ee,r as p,c as u,o as d,a as h,b as o,d as L,e as ee,f as q,g as I,w as y,h as S,t as b,v as _,F as B,i as H,j as O,k as T,P as Ne,l as K,m as Pe,p as De,q as v,s as ze,B as ue,u as J,R as we,x as Re,y as Ae,z as Q,E as Fe,A as te,C as de,D as Ze,$,G as Ue,H as Je,I as je,L as le,J as We,K as he,M as ce,N as Ge,T as X,O as Y,Q as Ke,S as Qe,U as Ye,V as Xe,X as et,Y as tt,Z as st}from"./vendor-BaPbTCFd.js";import"./maps-yMw3Pr4N.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();const it="modulepreload",nt=function(t,e){return new URL(t,e).href},Ce={},ot=function(e,s,l){let i=Promise.resolve();if(s&&s.length>0){const r=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(s.map(g=>{if(g=nt(g,l),g in Ce)return;Ce[g]=!0;const m=g.endsWith(".css"),V=m?'[rel="stylesheet"]':"";if(!!l)for(let E=r.length-1;E>=0;E--){const C=r[E];if(C.href===g&&(!m||C.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${V}`))return;const w=document.createElement("link");if(w.rel=m?"stylesheet":it,m||(w.as="script"),w.crossOrigin="",w.href=g,c&&w.setAttribute("nonce",c),document.head.appendChild(w),m)return new Promise((E,C)=>{w.addEventListener("load",E),w.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${g}`)))})}))}function n(r){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r}return i.then(r=>{for(const a of r||[])a.status==="rejected"&&n(a.reason);return e().catch(n)})},k={isJSON(t){return t&&t.type==="application/json"},isNDJSON(t){return t&&t.name.endsWith(".ndjson")},isDatabase(t){const e=["application/vnd.sqlite3","application/x-sqlite3"];return t.type?e.includes(t.type):/\.(db|sqlite(3)?)+$/.test(t.name)},getFileName(t){return t.name.replace(/\.[^.]+$/,"")},downloadFromUrl(t,e){const s=document.createElement("a");s.href=t,s.download=e,s.click(),URL.revokeObjectURL(t)},async exportToFile(t,e,s="octet/stream"){const l=new Blob([t],{type:s}),i=URL.createObjectURL(l);this.downloadFromUrl(i,e)},getFileFromUser(t){return new Promise(e=>{const s=document.createElement("input");s.type="file",s.accept=t,s.addEventListener("change",()=>{const l=s.files[0];e(l)}),s.click()})},importFile(){return this.getFileFromUser(".json").then(t=>this.getFileContent(t))},getFileContent(t){const e=new FileReader;return new Promise(s=>{e.onload=l=>s(l.target.result),e.readAsText(t)})},readFile(t){return fetch(t)},readAsArrayBuffer(t){const e=new FileReader;return new Promise((s,l)=>{e.onerror=()=>{e.abort(),l(new Error("Problem parsing input file."))},e.onload=()=>{s(e.result)},e.readAsArrayBuffer(t)})}},M={send(t,e,s){const l=new CustomEvent("sqliteviz-app-event",{detail:{name:t,value:e,labels:s||{}}});window.dispatchEvent(l)}},lt={_migrate(t,e){if(t===1)return e.forEach(s=>{s.viewType="chart",s.viewOptions=s.chart,delete s.chart}),e}},re=lt._migrate,A={version:2,getStoredInquiries(){let t=JSON.parse(localStorage.getItem("myInquiries"));if(!t){const e=localStorage.getItem("myQueries");return e?(t=re(1,JSON.parse(e)),this.updateStorage(t),t):[]}return t&&t.inquiries||[]},duplicateInquiry(t){const e=JSON.parse(JSON.stringify(t));return e.name=e.name+" Copy",e.id=U(),e.createdAt=new Date,delete e.isPredefined,e},isTabNeedName(t){return t.isPredefined||!t.name},updateStorage(t){localStorage.setItem("myInquiries",JSON.stringify({version:this.version,inquiries:t}))},serialiseInquiries(t){const e=JSON.parse(JSON.stringify(t));return e.forEach(s=>delete s.isPredefined),JSON.stringify({version:this.version,inquiries:e},null,4)},deserialiseInquiries(t){const e=JSON.parse(t);let s=[];return e.version?s=e.inquiries||[]:(s=Array.isArray(e)?e:[e],s=re(1,s)),s.forEach(l=>{this.getStoredInquiries().map(n=>n.id).includes(l.id)&&(l.id=U())}),s},importInquiries(){return k.importFile().then(t=>{const e=this.deserialiseInquiries(t);return M.send("inquiry.import",e.length),e})},export(t,e){const s=this.serialiseInquiries(t);k.exportToFile(s,e),M.send("inquiry.export",t.length)},async readPredefinedInquiries(){const e=await(await k.readFile("./inquiries.json")).json();return e.version?e.inquiries:e.length>0?re(1,e):[]}},f=(t,e)=>{const s=t.__vccOpts||t;for(const[l,i]of e)s[l]=i;return s},rt={components:{ModalsContainer:Ee},computed:{inquiries(){return this.$store.state.inquiries}},watch:{inquiries:{deep:!0,handler(){A.updateStorage(this.inquiries)}}},created(){this.$store.commit("setInquiries",A.getStoredInquiries())}},at={id:"app"};function dt(t,e,s,l,i,n){const r=p("router-view"),a=p("modals-container");return d(),u("div",at,[h(r),h(a)])}const ct=f(rt,[["render",dt]]),ut={getCurrentMouseDrag(t,e){const s=e.getBoundingClientRect(),{clientX:l,clientY:i}="ontouchstart"in window&&t.touches?t.touches[0]:t;return{x:l-s.left,y:i-s.top}},getCurrentDragPercentage(t,e,s){let l=this.getCurrentMouseDrag(t,e);l=l[s?"y":"x"];const i=e[s?"clientHeight":"clientWidth"];return l*100/i},calculateOffset(t,{container:e,isHorisontal:s,paneBeforeMax:l,paneAfterMax:i}){const n=this.getCurrentDragPercentage(t,e,s),r=l<100&&n>=l,a=i<100&&n<=100-i;return r||a?r?l:Math.max(100-i,0):Math.min(Math.max(n,0),l)}},ve="data:image/svg+xml,%3csvg%20width='4'%20height='9'%20viewBox='0%200%204%209'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4%200.98056V4.5L4.00004%207.71428L4%209L1.10694e-07%204.5L4%200V0.98056Z'%20fill='%23506784'/%3e%3c/svg%3e",ht={name:"Splitpanes",props:{horizontal:{type:Boolean,default:!1},before:{type:Object},after:{type:Object},default:{type:Object,default:()=>({before:50,after:50})}},emits:[],data(){return{container:null,paneBefore:this.before,paneAfter:this.after,beforeMinimising:!this.after.size||!this.before.size?this.default:{before:this.before.size,after:this.after.size},dragging:!1,movableSplitter:{top:0,left:0,visibility:"hidden"}}},computed:{styles(){return{before:{[this.horizontal?"height":"width"]:`${this.paneBefore.size}%`},after:{[this.horizontal?"height":"width"]:`${this.paneAfter.size}%`}}},movableSplitterStyle(){const t={...this.movableSplitter};return t.top+="%",t.left+="%",t},directionBeforeIconStyle(){const t=this.paneBefore.size!==0,e="translate(-50%, -50%) ";let s="";return this.horizontal?s=t?"rotate(90deg)":"rotate(-90deg)":s=t?"rotate(0deg)":"rotate(180deg)",{transform:e+s}},directionAfterIconStyle(){const t=this.paneAfter.size!==0,e="translate(-50%, -50%)";let s="";return this.horizontal?s=t?"rotate(-90deg)":"rotate(90deg)":s=t?"rotate(180deg)":"rotate(0deg)",{transform:e+s}}},mounted(){this.container=this.$refs.container},methods:{bindEvents(){document.addEventListener("mousemove",this.onMouseMove,{passive:!1}),document.addEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.addEventListener("touchmove",this.onMouseMove,{passive:!1}),document.addEventListener("touchend",this.onMouseUp))},unbindEvents(){document.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),document.removeEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.removeEventListener("touchmove",this.onMouseMove,{passive:!1}),document.removeEventListener("touchend",this.onMouseUp))},onMouseMove(t){t.preventDefault(),this.dragging=!0,this.movableSplitter.visibility="visible",this.moveSplitter(t)},onMouseUp(){if(this.dragging){const t=this.horizontal?this.movableSplitter.top:this.movableSplitter.left;this.paneBefore.size=t,this.paneAfter.size=100-t,this.movableSplitter={top:0,left:0,visibility:"hidden"},this.dragging=!1}this.unbindEvents()},moveSplitter(t){const e={container:this.container,paneBeforeMax:this.paneBefore.max,paneAfterMax:this.paneAfter.max,isHorisontal:this.horizontal},s=ut.calculateOffset(t,e),l=this.horizontal?"top":"left";this.movableSplitter[l]=s},togglePane(t){if(t.size>0){this.beforeMinimising.before=this.paneBefore.size,this.beforeMinimising.after=this.paneAfter.size,t.size=0;const e=t===this.paneBefore?this.paneAfter:this.paneBefore;e.size=100-t.size}else this.paneBefore.size=this.beforeMinimising.before,this.paneAfter.size=this.beforeMinimising.after}}},pt=["size"];function mt(t,e,s,l,i,n){return d(),u("div",{ref:"container",class:q(["splitpanes",`splitpanes-${s.horizontal?"horizontal":"vertical"}`,{"splitpanes-dragging":i.dragging}])},[o("div",{ref:"movableSplitter",class:"movable-splitter",style:L(n.movableSplitterStyle)},null,4),o("div",{ref:"left",class:"splitpanes-pane",size:i.paneBefore.size,"max-size":"30",style:L(n.styles.before)},[ee(t.$slots,"left-pane")],12,pt),o("div",{class:"splitpanes-splitter",onMousedown:e[2]||(e[2]=(...r)=>n.bindEvents&&n.bindEvents(...r)),onTouchstart:e[3]||(e[3]=(...r)=>n.bindEvents&&n.bindEvents(...r))},[o("div",{class:q(["toggle-btns",{both:s.after.max===100&&s.before.max===100&&i.paneAfter.size>0&&i.paneBefore.size>0}])},[s.after.max===100&&i.paneAfter.size>0?(d(),u("div",{key:0,class:"toggle-btn",onClick:e[0]||(e[0]=r=>n.togglePane(i.paneBefore))},[o("img",{class:"direction-icon",src:ve,style:L(n.directionBeforeIconStyle)},null,4)])):I("",!0),s.before.max===100&&i.paneBefore.size>0?(d(),u("div",{key:1,class:"toggle-btn",onClick:e[1]||(e[1]=r=>n.togglePane(i.paneAfter))},[o("img",{class:"direction-icon",src:ve,style:L(n.directionAfterIconStyle)},null,4)])):I("",!0)],2)],32),o("div",{ref:"right",class:"splitpanes-pane",style:L(n.styles.after)},[ee(t.$slots,"right-pane")],4)],2)}const pe=f(ht,[["render",mt]]),ft={name:"TreeChevron",props:{expanded:{type:Boolean,required:!0}}},gt=["fill"];function Ct(t,e,s,l,i,n){return d(),u("svg",{style:L({transform:s.expanded?"rotate(90deg)":"rotate(0)"}),class:"chevron-icon",width:"9",height:"9",viewBox:"0 0 8 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:`M0.721924 9.93097L4.85292 5.79997L0.721924 1.66897L1.99992 0.399973L7.39992
      5.79997L1.99992 11.2L0.721924 9.93097Z`,fill:s.expanded?"#506784":"rgba(80, 103, 132, 0.5)"},null,8,gt)],4)}const ye=f(ft,[["render",Ct],["__scopeId","data-v-eca3a6bf"]]),vt={name:"TableDescription",components:{TreeChevron:ye},props:{name:String,columns:Array},data(){return{colVisible:!1}}},bt={class:"columns"},wt={class:"column-type"};function yt(t,e,s,l,i,n){const r=p("tree-chevron");return d(),u("div",null,[o("div",{class:"table-name",onClick:e[0]||(e[0]=a=>i.colVisible=!i.colVisible)},[h(r,{expanded:i.colVisible},null,8,["expanded"]),S(" "+b(s.name),1)]),y(o("div",bt,[(d(!0),u(B,null,H(s.columns,(a,c)=>(d(),u("div",{key:c,class:"column"},[S(b(a.name)+" ",1),o("span",wt,b(a.type),1)]))),128))],512),[[_,i.colVisible]])])}const _t=f(vt,[["render",yt],["__scopeId","data-v-55d83629"]]),R={data(){return{tooltipStyle:{visibility:"hidden"}}},computed:{tooltipElement(){return this.$refs.tooltip}},methods:{showTooltip(t,e){const s=e?e.split("-"):["top","right"],l=12;s[0]==="top"?this.tooltipStyle.top=t.clientY-l+"px":this.tooltipStyle.top=t.clientY+l+"px",s[1]==="right"?this.tooltipStyle.left=t.clientX+l+"px":this.tooltipStyle.left=t.clientX-l-this.tooltipElement.offsetWidth+"px",this.tooltipStyle.visibility="visible"},hideTooltip(){this.tooltipStyle.visibility="hidden"}}},It={name:"HintIcon",mixins:[R],props:{hint:String,maxWidth:String},emits:["click"],methods:{onClick(){this.hideTooltip(),this.$emit("click")}}};function St(t,e,s,l,i,n){return d(),u("div",null,[(d(),u("svg",{class:"hint-icon",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",onClick:e[0]||(e[0]=O((...r)=>n.onClick&&n.onClick(...r),["stop"])),onMouseenter:e[1]||(e[1]=(...r)=>t.showTooltip&&t.showTooltip(...r)),onMouseleave:e[2]||(e[2]=(...r)=>t.hideTooltip&&t.hideTooltip(...r))},e[3]||(e[3]=[o("path",{d:`M8.75 14.1666H10.4167V12.5H8.75V14.1666ZM9.58333 16.25C5.90833 16.25 2.91667 13.2583
        2.91667 9.58333C2.91667 5.90833 5.90833 2.91667 9.58333 2.91667C13.2583 2.91667 16.25
        5.90833 16.25 9.58333C16.25 13.2583 13.2583 16.25 9.58333 16.25ZM9.58333 1.25C8.48898
        1.25 7.40535 1.46555 6.3943 1.88434C5.38326 2.30313 4.4646 2.91696 3.69078
        3.69078C2.12797 5.25358 1.25 7.3732 1.25 9.58333C1.25 11.7935 2.12797 13.9131 3.69078
        15.4759C4.4646 16.2497 5.38326 16.8635 6.3943 17.2823C7.40535 17.7011 8.48898 17.9167
        9.58333 17.9167C11.7935 17.9167 13.9131 17.0387 15.4759 15.4759C17.0387 13.9131 17.9167
        11.7935 17.9167 9.58333C17.9167 8.48898 17.7011 7.40535 17.2823 6.3943C16.8635 5.38326
        16.2497 4.4646 15.4759 3.69078C14.7021 2.91696 13.7834 2.30313 12.7724 1.88434C11.7613
        1.46555 10.6777 1.25 9.58333 1.25Z`,fill:"#A2B1C6"},null,-1),o("path",{d:`M9.91601 4.51787C8.98167 4.42606 8.05144 4.69097 7.36309 5.24472C6.68735 5.78828
        6.2998 6.56661 6.2998 7.38012H7.92488C7.92488 6.97463 8.11059 6.60187 8.44779
        6.33061C8.79784 6.049 9.25647 5.92005 9.73896 5.96755C10.4832 6.04076 11.0828 6.57277
        11.1647 7.23265C11.2306 7.764 10.9661 8.28194 10.4744 8.58426C9.38676 9.25303 8.73742
        10.343 8.73742 11.5H10.3625C10.3625 10.8243 10.7477 10.184 11.3929 9.78733C12.3808
        9.17985 12.9122 8.13913 12.7798 7.07124C12.6144 5.73863 11.41 4.66476 9.91601 4.51787Z`,fill:"#A2B1C6"},null,-1)]),32)),o("span",{ref:"tooltip",class:"icon-tooltip",style:L({...t.tooltipStyle,maxWidth:s.maxWidth})},b(s.hint),5)])}const Vt=f(It,[["render",St],["__scopeId","data-v-3ec64ce0"]]),kt={name:"TextField",components:{HintIcon:Vt},props:{placeholder:String,label:String,errorMsg:String,modelValue:String,width:String,hint:String,maxHintWidth:String,disabled:Boolean},emits:["update:modelValue"]},Lt=["placeholder","value","disabled"];function Tt(t,e,s,l,i,n){const r=p("hint-icon");return d(),u("div",null,[s.label?(d(),u("div",{key:0,class:q(["text-field-label",{error:s.errorMsg},{disabled:s.disabled}])},[S(b(s.label)+" ",1),s.hint?(d(),T(r,{key:0,class:"hint",hint:s.hint,maxWidth:s.maxHintWidth||"149px"},null,8,["hint","maxWidth"])):I("",!0)],2)):I("",!0),o("input",{type:"text",placeholder:s.placeholder,class:q({error:s.errorMsg}),style:L({width:s.width}),value:s.modelValue,disabled:s.disabled,onInput:e[0]||(e[0]=a=>t.$emit("update:modelValue",a.target.value))},null,46,Lt),y(o("div",{class:"text-field-error"},b(s.errorMsg),513),[[_,s.errorMsg]])])}const ie=f(kt,[["render",Tt],["__scopeId","data-v-83b1bd1a"]]),xt={name:"ChangeDbIcon",mixins:[R],emits:["click"],methods:{onClick(){this.hideTooltip(),this.$emit("click")}}};function qt(t,e,s,l,i,n){return d(),u("div",null,[(d(),u("svg",{class:"db-edit-icon",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",onClick:e[0]||(e[0]=O((...r)=>n.onClick&&n.onClick(...r),["stop"])),onMouseenter:e[1]||(e[1]=(...r)=>t.showTooltip&&t.showTooltip(...r)),onMouseleave:e[2]||(e[2]=(...r)=>t.hideTooltip&&t.hideTooltip(...r))},e[3]||(e[3]=[o("path",{d:`M3 10.5V12.75C3 14.25 5.2875 15.54 8.25 15.75V13.5825L8.3475 13.5C5.34 13.32 3 12.045 3
      10.5ZM9 9.75C5.685 9.75 3 8.4075 3 6.75V9C3 10.6575 5.685 12 9 12C9.2925 12 9.5775 12
      9.87 12L12.75 9.09C11.55 9.54 10.2825 9.75 9 9.75ZM9 2.25C5.685 2.25 3 3.5925 3 5.25C3
      6.9075 5.685 8.25 9 8.25C12.315 8.25 15 6.9075 15 5.25C15 3.5925 12.315 2.25 9 2.25ZM15.75
      8.3475C15.6375 8.3475 15.5325 8.3925 15.4575 8.475L14.7075 9.225L16.245 10.725L16.995
      9.975C17.1525 9.825 17.16 9.57 16.995 9.3975L16.065 8.475C15.99 8.3925 15.885 8.3475 15.78
      8.3475H15.75ZM14.28 9.66L9.75 14.205V15.75H11.295L15.84 11.1975L14.28 9.66Z`,fill:"#A2B1C6"},null,-1)]),32)),o("span",{ref:"tooltip",class:"icon-tooltip",style:L(t.tooltipStyle)}," Load another database, CSV, JSON or NDJSON ",4)])}const Mt=f(xt,[["render",qt],["__scopeId","data-v-b4b3e7bf"]]);function $t(){const t=new Worker(new URL(""+new URL("_worker-DD8HPbbt.js",import.meta.url).href,import.meta.url),{type:"module"});return new Ht(t)}const me={getNewDatabase:$t};let Bt=0;class Ht{constructor(e){this.dbName=null,this.schema=null,this.worker=e,this.pw=new Ne(e),this.importProgresses={},e.addEventListener("message",s=>{const l=s.data.progress;if(l!==void 0){const i=s.data.id;this.importProgresses[i].dispatchEvent(new CustomEvent("progress",{detail:l}))}})}shutDown(){this.worker.terminate()}createProgressCounter(e){const s=Bt++;return this.importProgresses[s]=new EventTarget,this.importProgresses[s].addEventListener("progress",l=>{e(l.detail)}),s}deleteProgressCounter(e){delete this.importProgresses[e]}async addTableFromCsv(e,s,l){const i=await this.pw.postMessage({action:"import",data:s,progressCounterId:l,tabName:e});if(i.error)throw new Error(i.error);this.dbName=this.dbName||"database",this.refreshSchema()}async loadDb(e){const s=e?await k.readAsArrayBuffer(e):null,l=await this.pw.postMessage({action:"open",buffer:s});if(l.error)throw new Error(l.error);this.dbName=e?k.getFileName(e):"database",await this.refreshSchema(),M.send("database.import",e?e.size:0,{from:e?"sqlite":"none",new_db:!0})}async refreshSchema(){const s=await this.execute(`
    WITH columns as (
      SELECT
        a.tbl_name,
        json_group_array(
          json_object('name', b.name,'type', IIF(b.type = '', 'N/A', b.type))
        ) as column_json
      FROM sqlite_master a, pragma_table_info(a.name) b
      WHERE a.type in ('table','view') AND a.name NOT LIKE 'sqlite_%' group by tbl_name
    )
    SELECT json_group_array(json_object('name',tbl_name, 'columns', json(column_json))) objects
    FROM columns;
    `);this.schema=JSON.parse(s.values.objects[0])}async execute(e){await this.pw.postMessage({action:"reopen"});const s=await this.pw.postMessage({action:"exec",sql:e});if(s.error)throw new Error(s.error);return s[s.length-1]}async export(e){const s=await this.pw.postMessage({action:"export"});if(s.error)throw new Error(s.error);k.exportToFile(s,e),M.send("database.export",s.byteLength,{to:"sqlite"})}async validateTableName(e){if(e.startsWith("sqlite_"))throw new Error("Table name can't start with sqlite_");if(/[^\w]/.test(e))throw new Error("Table name can contain only letters, digits and underscores");if(/^(\d)/.test(e))throw new Error("Table name can't start with a digit");await this.execute(`BEGIN; CREATE TABLE "${e}"(id); ROLLBACK;`)}sanitizeTableName(e){return e.replace(/[^\w]/g,"_").replace(/^(\d)/,"_$1").replace(/_{2,}/g,"_")}}const Ot={MissingQuotes:"Edit your CSV so that the field has a closing quote char.",TooFewFields:"Add fields or try another delimiter.",TooManyFields:"Edit your CSV or try another delimiter."},se={getResult(t,e){const s={columns:e||[]},l={};if(t.meta.fields)t.meta.fields.forEach(i=>{const n=i.trim();s.columns.push(n),l[n]=t.data.map(r=>{let a=r[i];return a instanceof Date&&(a=a.toISOString()),a})});else if(e)e.forEach((i,n)=>{l[i]=t.data.map(r=>{let a=r[n];return a instanceof Date&&(a=a.toISOString()),a})});else for(let i=0;t.data[0]&&i<=t.data[0].length-1;i++){const n=`col${i+1}`;s.columns.push(n),l[n]=t.data.map(r=>{let a=r[i];return a instanceof Date&&(a=a.toISOString()),a})}return s.values=l,s},prepareForExport(t){const e=t.columns,s=t.values[e[0]].length,l={fields:e,data:[]};for(let i=0;i<s;i++)l.data.push(e.map(n=>t.values[n][i]));return l},parse(t,e={}){return new Promise((s,l)=>{const i={delimiter:"",newline:"",quoteChar:'"',escapeChar:'"',header:!1,transformHeader:void 0,dynamicTyping:!0,preview:0,encoding:"UTF-8",worker:!0,comments:!1,step:void 0,complete:n=>{let r;try{r={data:this.getResult(n,e.columns),delimiter:n.meta.delimiter,hasErrors:!1,rowCount:n.data.length},r.messages=n.errors.map(a=>(a.type=a.code==="UndetectableDelimiter"?"info":"error",a.type==="error"&&(r.hasErrors=!0),a.hint=Ot[a.code],a))}catch(a){l(a)}s(r)},error:n=>{l(n)},download:!1,downloadRequestHeaders:void 0,downloadRequestBody:void 0,skipEmptyLines:"greedy",chunk:void 0,chunkSize:void 0,fastMode:void 0,beforeFirstChunk:void 0,withCredentials:void 0,transform:void 0,delimitersToGuess:[",","	","|",";",K.RECORD_SEP,K.UNIT_SEP]};K.parse(t,{...i,...e})})},serialize(t){return K.unparse(this.prepareForExport(t),{delimiter:"	"})}},Et={name:"CloseIcon",props:{size:{type:Number,required:!1,default:14},disabled:{type:Boolean,required:!1,default:!1}},emits:["click"]},Nt=["width","height"];function Pt(t,e,s,l,i,n){return d(),u("svg",{class:q(["icon",{disabled:s.disabled}]),width:s.size,height:s.size,viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",onClick:e[0]||(e[0]=O(r=>t.$emit("click"),["stop"]))},e[1]||(e[1]=[o("path",{d:`M14 1.41L12.59 0L7 5.59L1.41 0L0 1.41L5.59 7L0 12.59L1.41 14L7 8.41L12.59 14L14
      12.59L8.41 7L14 1.41Z`,fill:"#A2B1C6"},null,-1)]),10,Nt)}const Z=f(Et,[["render",Pt],["__scopeId","data-v-4a5f24cc"]]),Dt={0:{name:"null character"},1:{name:"start of header"},2:{name:"start of text"},3:{name:"end of text"},4:{name:"end of transmission"},5:{name:"enquiry"},6:{name:"acknowledge"},7:{name:"bell (ring)"},8:{name:"backspace"},9:{name:"horizontal tab"},10:{name:"line feed"},11:{name:"vertical tab"},12:{name:"form feed"},13:{name:"carriage return"},14:{name:"shift out"},15:{name:"shift in"},16:{name:"data link escape"},17:{name:"device control 1"},18:{name:"device control 2"},19:{name:"device control 3"},20:{name:"device control 4"},21:{name:"negative acknowledge"},22:{name:"synchronize"},23:{name:"end transmission block"},24:{name:"cancel"},25:{name:"end of medium"},26:{name:"substitute"},27:{name:"escape"},28:{name:"file separator"},29:{name:"group separator"},30:{name:"record separator"},31:{name:"unit separator"},32:{name:"space"},33:{name:"exclamation mark"},34:{name:"quotation mark"},35:{name:"number sign"},36:{name:"dollar sign"},37:{name:"percent sign"},38:{name:"ampersand"},39:{name:"apostrophe"},40:{name:"left parenthesis"},41:{name:"right parenthesis"},42:{name:"asterisk"},43:{name:"plus sign"},44:{name:"comma"},45:{name:"hyphen"},46:{name:"period"},47:{name:"slash"},48:{name:"digit 0"},49:{name:"digit 1"},50:{name:"digit 2"},51:{name:"digit 3"},52:{name:"digit 4"},53:{name:"digit 5"},54:{name:"digit 6"},55:{name:"digit 7"},56:{name:"digit 8"},57:{name:"digit 9"},58:{name:"colon"},59:{name:"semicolon"},60:{name:"less-than"},61:{name:"equals-to"},62:{name:"greater-than"},63:{name:"question mark"},64:{name:"at sign"},65:{name:"uppercase A"},66:{name:"uppercase B"},67:{name:"uppercase C"},68:{name:"uppercase D"},69:{name:"uppercase E"},70:{name:"uppercase F"},71:{name:"uppercase G"},72:{name:"uppercase H"},73:{name:"uppercase I"},74:{name:"uppercase J"},75:{name:"uppercase K"},76:{name:"uppercase L"},77:{name:"uppercase M"},78:{name:"uppercase N"},79:{name:"uppercase O"},80:{name:"uppercase P"},81:{name:"uppercase Q"},82:{name:"uppercase R"},83:{name:"uppercase S"},84:{name:"uppercase T"},85:{name:"uppercase U"},86:{name:"uppercase V"},87:{name:"uppercase W"},88:{name:"uppercase X"},89:{name:"uppercase Y"},90:{name:"uppercase Z"},91:{name:"left square bracket"},92:{name:"backslash"},93:{name:"right square bracket"},94:{name:"caret"},95:{name:"underscore"},96:{name:"grave accent"},97:{name:"lowercase a"},98:{name:"lowercase b"},99:{name:"lowercase c"},100:{name:"lowercase d"},101:{name:"lowercase e"},102:{name:"lowercase f"},103:{name:"lowercase g"},104:{name:"lowercase h"},105:{name:"lowercase i"},106:{name:"lowercase j"},107:{name:"lowercase k"},108:{name:"lowercase l"},109:{name:"lowercase m"},110:{name:"lowercase n"},111:{name:"lowercase o"},112:{name:"lowercase p"},113:{name:"lowercase q"},114:{name:"lowercase r"},115:{name:"lowercase s"},116:{name:"lowercase t"},117:{name:"lowercase u"},118:{name:"lowercase v"},119:{name:"lowercase w"},120:{name:"lowercase x"},121:{name:"lowercase y"},122:{name:"lowercase z"},123:{name:"left curly brace"},124:{name:"vertical bar"},125:{name:"right curly brace"},126:{name:"tilde"},127:{name:"delete (rubout)"}},zt={name:"DropDownChevron",props:{disabled:Boolean}};function Rt(t,e,s,l,i,n){return d(),u("svg",{class:q(["chevron-icon",{disabled:s.disabled}]),width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e[0]||(e[0]=[o("path",{d:"M6.175 7.15002L10 10.975L13.825 7.15002L15 8.33336L10 13.3334L5 8.33336L6.175 7.15002Z",fill:"#C8D4E3"},null,-1)]),2)}const At=f(zt,[["render",Rt],["__scopeId","data-v-65f0484a"]]),Ft={name:"ClearIcon",props:{disabled:Boolean}};function Zt(t,e,s,l,i,n){return d(),u("svg",{class:q(["clear-icon",{disabled:s.disabled}]),width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e[0]||(e[0]=[o("path",{d:`M14.3481 14.849C13.8791 15.318 13.1191 15.318 12.6511 14.849L10.0001 11.819L7.34907
        14.848C6.88007 15.317 6.12007 15.317 5.65207 14.848C5.18307 14.379 5.18307 13.619
        5.65207 13.151L8.41007 10.001L5.65107 6.84898C5.18207 6.37998 5.18207 5.62098 5.65107
        5.15198C6.12007 4.68298 6.87907 4.68298 7.34807 5.15198L10.0001 8.18298L12.6511
        5.15198C13.1201 4.68298 13.8791 4.68298 14.3481 5.15198C14.8171 5.62098 14.8171 6.38098
        14.3481 6.84898L11.5901 10.001L14.3481 13.151C14.8171 13.62 14.8171 14.38 14.3481
        14.849V14.849Z`,fill:"#C8D4E3"},null,-1)]),2)}const Ut=f(Ft,[["render",Zt],["__scopeId","data-v-b840edd0"]]),Jt={name:"DelimiterSelector",components:{DropDownChevron:At,ClearIcon:Ut},props:{modelValue:String,width:String,disabled:Boolean},emits:["update:modelValue"],data(){return{showOptions:!1,options:[",","	"," ","|",";","",""],filled:!1,inputValue:""}},watch:{inputValue(){this.inputValue?(this.filled=!0,this.inputValue!==this.modelValue&&this.$emit("update:modelValue",this.inputValue)):this.filled=!1}},created(){this.inputValue=this.modelValue},methods:{getSymbolName(t){return t?Dt[t.charCodeAt(0).toString()].name:""},chooseOption(t){this.inputValue=t,this.showOptions=!1},onContainerClick(){this.$refs.delimiterInput.focus()},clear(){this.disabled||(this.inputValue="",this.$refs.delimiterInput.focus())}}},jt={class:"value"},Wt=["disabled"],Gt={class:"name"},Kt=["onClick"];function Qt(t,e,s,l,i,n){const r=p("clear-icon"),a=p("drop-down-chevron");return d(),u("div",{class:q({disabled:s.disabled})},[e[5]||(e[5]=o("div",{class:"text-field-label"},"Delimiter",-1)),o("div",{class:"delimiter-selector-container",style:L({width:s.width}),onClick:e[4]||(e[4]=(...c)=>n.onContainerClick&&n.onContainerClick(...c))},[o("div",jt,[y(o("input",{ref:"delimiterInput","onUpdate:modelValue":e[0]||(e[0]=c=>i.inputValue=c),class:q({filled:i.filled}),type:"text",maxlength:"1",disabled:s.disabled,onClick:e[1]||(e[1]=O(()=>{},["stop"]))},null,10,Wt),[[Pe,i.inputValue]]),o("div",Gt,b(n.getSymbolName(s.modelValue)),1)]),o("div",{class:"controls",onClick:e[3]||(e[3]=O(()=>{},["stop"]))},[h(r,{disabled:s.disabled,onClick:n.clear},null,8,["disabled","onClick"]),h(a,{disabled:s.disabled,onClick:e[2]||(e[2]=c=>!s.disabled&&(i.showOptions=!i.showOptions))},null,8,["disabled"])])],4),y(o("div",{class:"options",style:L({width:s.width})},[(d(!0),u(B,null,H(i.options,(c,g)=>(d(),u("div",{key:g,class:"option",onClick:m=>n.chooseOption(c)},[o("pre",null,b(c),1),o("div",null,b(n.getSymbolName(c)),1)],8,Kt))),128))],4),[[_,i.showOptions]])],2)}const Yt=f(Jt,[["render",Qt],["__scopeId","data-v-76028415"]]),Xt="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='0.5'%20y='0.5'%20width='17'%20height='17'%20rx='2.5'%20fill='%23F3F6FA'%20stroke='%23C8D4E3'/%3e%3cg%20filter='url(%23filter0_d)'%3e%3cpath%20d='M15.75%205.24988L6.75%2014.2499L2.625%2010.1249L3.6825%209.06738L6.75%2012.1274L14.6925%204.19238L15.75%205.24988Z'%20fill='%23119DFF'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d'%20x='0.625'%20y='3.19238'%20width='17.125'%20height='14.0575'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'/%3e%3cfeOffset%20dy='1'/%3e%3cfeGaussianBlur%20stdDeviation='1'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.164706%200%200%200%200%200.247059%200%200%200%200%200.372549%200%200%200%200.45%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",es="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='0.5'%20y='0.5'%20width='17'%20height='17'%20rx='2.5'%20fill='%23119DFF'%20stroke='%230D76BF'/%3e%3cg%20filter='url(%23filter0_d)'%3e%3cpath%20d='M15.75%205.25L6.75%2014.25L2.625%2010.125L3.6825%209.0675L6.75%2012.1275L14.6925%204.1925L15.75%205.25Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d'%20x='0.625'%20y='3.1925'%20width='17.125'%20height='14.0575'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'/%3e%3cfeOffset%20dy='1'/%3e%3cfeGaussianBlur%20stdDeviation='1'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.164706%200%200%200%200%200.247059%200%200%200%200%200.372549%200%200%200%200.7%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",ts="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='0.5'%20y='0.5'%20width='17'%20height='17'%20rx='2.5'%20fill='%23DFE8F3'%20stroke='%23C8D4E3'/%3e%3cg%20filter='url(%23filter0_d)'%3e%3cpath%20d='M15.75%205.25L6.75%2014.25L2.625%2010.125L3.6825%209.0675L6.75%2012.1275L14.6925%204.1925L15.75%205.25Z'%20fill='%23A2B1C6'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d'%20x='0.625'%20y='3.1925'%20width='17.125'%20height='14.0575'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'/%3e%3cfeOffset%20dy='1'/%3e%3cfeGaussianBlur%20stdDeviation='1'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.164706%200%200%200%200%200.247059%200%200%200%200%200.372549%200%200%200%200.2%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",ss={name:"CheckBox",props:{theme:{type:String,required:!1,default:"accent",validator:t=>["accent","light"].includes(t)},init:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1,default:""},disabled:{type:Boolean,required:!1,default:!1}},emits:["click"],data(){return{checked:this.init}},methods:{onClick(){this.disabled||(this.checked=!this.checked,this.$emit("click",this.checked))}}},is={class:"unchecked"},ns={class:"checked-light",src:Xt},os={class:"checked",src:es},ls={class:"checked-disabled",src:ts},rs={key:0,class:"label"};function as(t,e,s,l,i,n){return d(),u("div",{class:q(["checkbox-container",{checked:i.checked},{disabled:s.disabled}]),onClick:e[0]||(e[0]=O((...r)=>n.onClick&&n.onClick(...r),["stop"]))},[y(o("div",is,null,512),[[_,!i.checked]]),y(o("img",ns,null,512),[[_,i.checked&&!s.disabled&&s.theme==="light"]]),y(o("img",os,null,512),[[_,i.checked&&!s.disabled&&s.theme!=="light"]]),y(o("img",ls,null,512),[[_,i.checked&&s.disabled]]),s.label?(d(),u("span",rs,b(s.label),1)):I("",!0)],2)}const _e=f(ss,[["render",as],["__scopeId","data-v-66bdc9b6"]]),ds={name:"Pager",components:{Paginate:De},props:{pageCount:Number,modelValue:Number},emits:["update:modelValue"],data(){return{page:this.modelValue,chevron:`
        <svg width="9" height="9" viewBox="0 0 8 12" fill="none">
        <path
          d="M0.721924 9.93097L4.85292 5.79997L0.721924 1.66897L1.99992 0.399973L7.39992
            5.79997L1.99992 11.2L0.721924 9.93097Z" fill="#506784"
        />
        </svg>
      `}},watch:{page(){this.$emit("update:modelValue",this.page)},modelValue(){this.page=this.modelValue}}};function cs(t,e,s,l,i,n){const r=p("paginate");return d(),T(r,{modelValue:i.page,"onUpdate:modelValue":e[0]||(e[0]=a=>i.page=a),pageCount:s.pageCount,pageRange:5,marginPages:1,prevText:i.chevron,nextText:i.chevron,noLiSurround:!0,containerClass:"paginator-continer",pageLinkClass:"paginator-page-link",activeClass:"paginator-active-page",breakViewLinkClass:"paginator-break",nextLinkClass:"paginator-next",prevLinkClass:"paginator-prev",disabledClass:"paginator-disabled"},null,8,["modelValue","pageCount","prevText","nextText"])}const us=f(ds,[["render",cs],["__scopeId","data-v-0171b8c0"]]),hs={name:"SqlTable",components:{Pager:us},props:{dataSet:Object,time:[String,Number],pageSize:{type:Number,default:20},page:{type:Number,default:1},preview:Boolean,selectedCellCoordinates:Object},emits:["updateSelectedCell"],data(){return{header:null,tableWidth:null,currentPage:this.page,resizeObserver:null,selectedCellElement:null}},computed:{columns(){return this.dataSet.columns},rowCount(){return this.dataSet.values[this.columns[0]].length},cellStyle(){const t=this.tableWidth/this.columns.length;return{maxWidth:`${Math.max(t,100)}px`}},pageCount(){return Math.ceil(this.rowCount/this.pageSize)},currentPageData(){const t=(this.currentPage-1)*this.pageSize;let e=t+this.pageSize;return e>this.rowCount-1&&(e=this.rowCount-1),{start:t,end:e,count:e-t+1}}},watch:{currentPageData(){this.calculateHeadersWidth(),this.selectCell(null)},dataSet(){this.currentPage=1}},mounted(){if(this.resizeObserver=new ResizeObserver(this.calculateHeadersWidth),this.resizeObserver.observe(this.$refs.table),this.calculateHeadersWidth(),this.selectedCellCoordinates){const{row:t,col:e}=this.selectedCellCoordinates,s=this.$refs.table.querySelector(`td[data-col="${e}"][data-row="${t}"]`);s&&this.selectCell(s)}},beforeUnmount(){this.resizeObserver.unobserve(this.$refs.table)},methods:{isBlob(t){return t&&ArrayBuffer.isView(t)},isNull(t){return t===null},getCellValue(t,e){return this.dataSet.values[t][e-1+this.currentPageData.start]},getCellText(t,e){const s=this.getCellValue(t,e);return this.isNull(s)?"NULL":this.isBlob(s)?"BLOB":s},calculateHeadersWidth(){this.tableWidth=this.$refs["table-container"].offsetWidth,this.$nextTick(()=>{this.header=this.$refs.th.map(t=>({name:t.innerText,width:t.getBoundingClientRect().width}))})},onScrollTable(){this.$refs["header-container"].scrollLeft=this.$refs["table-container"].scrollLeft},onTableKeydown(t){const e={37:"left",39:"right",38:"up",40:"down"};!this.selectedCellElement||!Object.keys(e).includes(t.keyCode.toString())||(t.preventDefault(),this.moveFocusInTable(this.selectedCellElement,e[t.keyCode]))},onCellClick(t){this.selectCell(t.target.closest("td"),!1)},selectCell(t,e=!0){t?!t.ariaSelected||t.ariaSelected==="false"?(this.selectedCellElement&&(this.selectedCellElement.ariaSelected="false"),t.ariaSelected="true",this.selectedCellElement=t):(t.ariaSelected="false",this.selectedCellElement=null):(this.selectedCellElement&&(this.selectedCellElement.ariaSelected="false"),this.selectedCellElement=t),this.selectedCellElement&&e&&this.selectedCellElement.scrollIntoView(),this.$emit("updateSelectedCell",this.selectedCellElement)},moveFocusInTable(t,e){const s=+t.dataset.row,l=+t.dataset.col;let i,n;e==="right"?l===this.columns.length-1?(i=s+1,n=0):(i=s,n=l+1):e==="left"?l===0?(i=s-1,n=this.columns.length-1):(i=s,n=l-1):e==="up"?(i=s-1,n=l):e==="down"&&(i=s+1,n=l);const r=this.$refs.table.querySelector(`td[data-col="${n}"][data-row="${i}"]`);r&&this.selectCell(r)}}},ps={class:"rounded-bg"},ms={ref:"header-container",class:"header-container"},fs=["title"],gs=["data-col","data-row","data-isNull","data-isBlob"],Cs={class:"table-footer"},vs={class:"table-footer-count"},bs={key:0},ws={key:1};function ys(t,e,s,l,i,n){const r=p("pager");return d(),u("div",null,[o("div",ps,[o("div",ms,[o("div",null,[(d(!0),u(B,null,H(i.header,(a,c)=>(d(),u("div",{key:c,class:"fixed-header",style:L({width:`${a.width}px`}),title:a.name},b(a.name),13,fs))),128))])],512),o("div",{ref:"table-container",class:"table-container",onScroll:e[2]||(e[2]=(...a)=>n.onScrollTable&&n.onScrollTable(...a))},[o("table",{ref:"table",class:"sqliteviz-table",tabindex:"0",onKeydown:e[1]||(e[1]=(...a)=>n.onTableKeydown&&n.onTableKeydown(...a))},[o("thead",null,[o("tr",null,[(d(!0),u(B,null,H(n.columns,(a,c)=>(d(),u("th",{key:c,ref_for:!0,ref:"th"},[o("div",{class:"cell-data",style:L(n.cellStyle)},b(a),5)]))),128))])]),o("tbody",null,[(d(!0),u(B,null,H(n.currentPageData.count,a=>(d(),u("tr",{key:a},[(d(!0),u(B,null,H(n.columns,(c,g)=>(d(),u("td",{key:g,"data-col":g,"data-row":s.pageSize*(i.currentPage-1)+a-1,"data-isNull":n.isNull(n.getCellValue(c,a)),"data-isBlob":n.isBlob(n.getCellValue(c,a)),"aria-selected":!1,onClick:e[0]||(e[0]=(...m)=>n.onCellClick&&n.onCellClick(...m))},[o("div",{class:"cell-data",style:L(n.cellStyle)},b(n.getCellText(c,a)),5)],8,gs))),128))]))),128))])],544)],544)]),o("div",Cs,[o("div",vs,[S(b(n.rowCount)+" "+b(n.rowCount===1?"row":"rows")+" retrieved ",1),s.preview?(d(),u("span",bs,"for preview")):I("",!0),s.time?(d(),u("span",ws,"in "+b(s.time),1)):I("",!0)]),y(h(r,{modelValue:i.currentPage,"onUpdate:modelValue":e[3]||(e[3]=a=>i.currentPage=a),pageCount:n.pageCount},null,8,["modelValue","pageCount"]),[[_,n.pageCount>1]])])])}const Ie=f(hs,[["render",ys],["__scopeId","data-v-771480cb"]]),_s={name:"LoadingIndicator",props:{progress:{type:Number,required:!1},size:{type:Number,required:!1,default:20}},emits:[],computed:{circleProgress(){const t=this.radius*3.14*2,e=this.progress?t*this.progress/100:t*1/3,s=t-e;return`${e}px, ${s}px`},animationClass(){return this.progress===void 0?"loading":"progress"},radius(){return this.size/2-this.strokeWidth},offset(){return this.radius*3.14/2},strokeWidth(){return this.size/10}}},Is=["height","width","viewBox"],Ss=["cx","cy","r"],Vs=["cx","cy","r"];function ks(t,e,s,l,i,n){return d(),u("svg",{class:q(n.animationClass),height:s.size,width:s.size,viewBox:`0 0 ${s.size} ${s.size}`},[o("circle",{class:"loader-svg bg",style:L({strokeWidth:n.strokeWidth}),cx:s.size/2,cy:s.size/2,r:n.radius},null,12,Ss),o("circle",{class:"loader-svg front",style:L({strokeDasharray:n.circleProgress,strokeDashoffset:n.offset,strokeWidth:n.strokeWidth}),cx:s.size/2,cy:s.size/2,r:n.radius},null,12,Vs)],10,Is)}const j=f(_s,[["render",ks],["__scopeId","data-v-e6b5bfe7"]]),Ls="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.99984%2016.6667C6.32484%2016.6667%203.33317%2013.675%203.33317%2010C3.33317%206.32502%206.32484%203.33335%209.99984%203.33335C13.6748%203.33335%2016.6665%206.32502%2016.6665%2010C16.6665%2013.675%2013.6748%2016.6667%209.99984%2016.6667ZM9.99984%201.66669C8.90549%201.66669%207.82186%201.88224%206.81081%202.30102C5.79976%202.71981%204.8811%203.33364%204.10728%204.10746C2.54448%205.67027%201.6665%207.78988%201.6665%2010C1.6665%2012.2102%202.54448%2014.3298%204.10728%2015.8926C4.8811%2016.6664%205.79976%2017.2802%206.81081%2017.699C7.82186%2018.1178%208.90549%2018.3334%209.99984%2018.3334C12.21%2018.3334%2014.3296%2017.4554%2015.8924%2015.8926C17.4552%2014.3298%2018.3332%2012.2102%2018.3332%2010C18.3332%208.90567%2018.1176%207.82204%2017.6988%206.81099C17.28%205.79995%2016.6662%204.88129%2015.8924%204.10746C15.1186%203.33364%2014.1999%202.71981%2013.1889%202.30102C12.1778%201.88224%2011.0942%201.66669%209.99984%201.66669Z'%20fill='%23EF553B'/%3e%3crect%20x='6.36768'%20y='7.54855'%20width='1.67'%20height='8.60363'%20transform='rotate(-45%206.36768%207.54855)'%20fill='%23EF553B'/%3e%3crect%20x='12.4517'%20y='6.36771'%20width='1.67'%20height='8.60363'%20transform='rotate(45%2012.4517%206.36771)'%20fill='%23EF553B'/%3e%3c/svg%3e",ne="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M11%209H13V7H11V9ZM12%2020C7.59%2020%204%2016.41%204%2012C4%207.59%207.59%204%2012%204C16.41%204%2020%207.59%2020%2012C20%2016.41%2016.41%2020%2012%2020ZM12%202C10.6868%202%209.38642%202.25866%208.17317%202.7612C6.95991%203.26375%205.85752%204.00035%204.92893%204.92893C3.05357%206.8043%202%209.34784%202%2012C2%2014.6522%203.05357%2017.1957%204.92893%2019.0711C5.85752%2019.9997%206.95991%2020.7362%208.17317%2021.2388C9.38642%2021.7413%2010.6868%2022%2012%2022C14.6522%2022%2017.1957%2020.9464%2019.0711%2019.0711C20.9464%2017.1957%2022%2014.6522%2022%2012C22%2010.6868%2021.7413%209.38642%2021.2388%208.17317C20.7362%206.95991%2019.9997%205.85752%2019.0711%204.92893C18.1425%204.00035%2017.0401%203.26375%2015.8268%202.7612C14.6136%202.25866%2013.3132%202%2012%202V2ZM11%2017H13V11H11V17Z'%20fill='%23A2B1C6'/%3e%3c/svg%3e",Se="data:image/svg+xml,%3csvg%20width='21'%20height='20'%20viewBox='0%200%2021%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M10.4998%2016.6667C6.82484%2016.6667%203.83317%2013.675%203.83317%2010C3.83317%206.32502%206.82484%203.33335%2010.4998%203.33335C14.1748%203.33335%2017.1665%206.32502%2017.1665%2010C17.1665%2013.675%2014.1748%2016.6667%2010.4998%2016.6667ZM10.4998%201.66669C9.40549%201.66669%208.32186%201.88224%207.31081%202.30102C6.29976%202.71981%205.3811%203.33364%204.60728%204.10746C3.04448%205.67027%202.1665%207.78988%202.1665%2010C2.1665%2012.2102%203.04448%2014.3298%204.60728%2015.8926C5.3811%2016.6664%206.29976%2017.2802%207.31081%2017.699C8.32186%2018.1178%209.40549%2018.3334%2010.4998%2018.3334C12.71%2018.3334%2014.8296%2017.4554%2016.3924%2015.8926C17.9552%2014.3298%2018.8332%2012.2102%2018.8332%2010C18.8332%208.90567%2018.6176%207.82204%2018.1988%206.81099C17.78%205.79995%2017.1662%204.88129%2016.3924%204.10746C15.6186%203.33364%2014.6999%202.71981%2013.6889%202.30102C12.6778%201.88224%2011.5942%201.66669%2010.4998%201.66669Z'%20fill='%2300CC96'/%3e%3crect%20x='6.09717'%20y='10.2771'%20width='1.67'%20height='4.345'%20transform='rotate(-45%206.09717%2010.2771)'%20fill='%2300CC96'/%3e%3crect%20x='13.752'%20y='6.97589'%20width='1.67'%20height='7.74359'%20transform='rotate(45%2013.752%206.97589)'%20fill='%2300CC96'/%3e%3c/svg%3e",Ts={name:"Logs",components:{LoadingIndicator:j},props:{messages:Array},emits:[],watch:{"messages.length":"scrollToBottom"},mounted(){this.scrollToBottom()},methods:{async scrollToBottom(){const t=this.$refs.logsContainer;t&&(await this.$nextTick(),t.scrollTop=t.scrollHeight)},serializeMessage(t){let e="";return t.row!==null&&t.row!==void 0&&(t.type==="error"?e+=`Error in row ${t.row}. `:e+=`Information about row ${t.row}. `),e+=t.message,/(\.|!|\?)$/.test(e)||(e+="."),t.hint&&(e+=` ${t.hint}`),e}}},xs={ref:"logsContainer",class:"logs-container"},qs={key:0,src:Ls},Ms={key:1,src:ne,width:"20px"},$s={key:2,src:Se},Bs={class:"msg-text"};function Hs(t,e,s,l,i,n){const r=p("loading-indicator");return d(),u("div",xs,[(d(!0),u(B,null,H(s.messages,(a,c)=>(d(),u("div",{key:c,class:"msg"},[a.type==="error"?(d(),u("img",qs)):I("",!0),a.type==="info"?(d(),u("img",Ms)):I("",!0),a.type==="success"?(d(),u("img",$s)):I("",!0),a.type==="loading"?(d(),T(r,{key:3,progress:a.progress},null,8,["progress"])):I("",!0),o("span",Bs,b(n.serializeMessage(a)),1)]))),128))],512)}const oe=f(Ts,[["render",Hs],["__scopeId","data-v-f297e2a3"]]),D={getPeriod(t,e){return((e.getTime()-t.getTime())/1e3).toFixed(3)+"s"},debounce(t,e){let s;return function(){clearTimeout(s),s=setTimeout(()=>t.apply(this,arguments),e)}},sleep(t){return new Promise(e=>{setTimeout(()=>{e()},t)})}},Os={name:"CsvJsonImport",components:{CloseIcon:Z,TextField:ie,DelimiterSelector:Yt,CheckBox:_e,SqlTable:Ie,Logs:oe},props:{file:File,db:Object,dialogName:String},emits:["cancel","finish"],data(){return{disableDialog:!1,disableImport:!1,tableName:"",delimiter:"",quoteChar:'"',escapeChar:'"',header:!0,importCompleted:!1,importMessages:[],previewData:null,addedTable:null,tableNameError:""}},computed:{isJson(){return k.isJSON(this.file)},isNdJson(){return k.isNDJSON(this.file)},typeName(){return this.isJson||this.isNdJson?"JSON":"CSV"}},watch:{isJson(){this.isJson&&(this.delimiter="",this.header=!1)},isNdJson(){this.isNdJson&&(this.delimiter="",this.header=!1)},tableName:D.debounce(function(){this.tableNameError="",this.tableName&&this.db.validateTableName(this.tableName).catch(t=>{this.tableNameError=t.message+". Try another table name."})},400)},methods:{changeHeaderDisplaying(t){this.header=t,this.preview()},cancelImport(){this.disableDialog||(this.addedTable&&(this.db.execute(`DROP TABLE "${this.addedTable}"`),this.db.refreshSchema()),this.$modal.hide(this.dialogName),this.$emit("cancel"))},reset(){this.header=!this.isJson&&!this.isNdJson,this.quoteChar='"',this.escapeChar='"',this.delimiter=!this.isJson&&!this.isNdJson?"":"",this.tableName="",this.disableDialog=!1,this.disableImport=!1,this.importCompleted=!1,this.importMessages=[],this.previewData=null,this.addedTable=null,this.tableNameError=""},open(){this.tableName=this.db.sanitizeTableName(k.getFileName(this.file)),this.$modal.show(this.dialogName)},async preview(){if(this.disableImport=!1,!this.file)return;this.importCompleted=!1;const t={preview:3,quoteChar:this.quoteChar||'"',escapeChar:this.escapeChar,header:this.header,delimiter:this.delimiter,columns:!this.isJson&&!this.isNdJson?null:["doc"]};try{const e=new Date,s=this.isJson?await this.getJsonParseResult(this.file):await se.parse(this.file,t),l=new Date;this.previewData=s.data,this.previewData.rowCount=s.rowCount,this.delimiter=s.delimiter,this.importMessages=s.messages||[],this.previewData.rowCount===0&&(this.disableImport=!0,this.importMessages.push({type:"info",message:"No rows to import."})),s.hasErrors||this.importMessages.push({message:`Preview parsing is completed in ${D.getPeriod(e,l)}.`,type:"success"})}catch(e){console.error(e),this.importMessages=[{message:e,type:"error"}]}},async getJsonParseResult(t){const e=await k.getFileContent(t),s=!e.trim();return{data:{columns:["doc"],values:{doc:s?[]:[e]}},hasErrors:!1,messages:[],rowCount:+!s}},async loadToDb(t){if(!this.tableName){this.tableNameError="Table name can't be empty";return}this.disableDialog=!0;const e={quoteChar:this.quoteChar||'"',escapeChar:this.escapeChar,header:this.header,delimiter:this.delimiter,columns:!this.isJson&&!this.isNdJson?null:["doc"]};let s={};this.importMessages.push({message:`Parsing ${this.typeName}...`,type:"info"}),s=this.importMessages[this.importMessages.length-1];const l=setTimeout(()=>{s.type="loading"},1e3);let i={},n=null;const r=c=>{i.progress=c},a=this.db.createProgressCounter(r);try{let c=new Date;const g=this.isJson?await this.getJsonParseResult(t):await se.parse(this.file,e);let m=new Date;if(g.hasErrors)s.message="Parsing ended with errors.",s.type="info",this.importMessages=this.importMessages.concat(g.messages);else{const V=g.rowCount;let x=D.getPeriod(c,m);s.type="success",g.messages.length>0?(this.importMessages=this.importMessages.concat(g.messages),s.message=`${V} rows are parsed in ${x}.`):s.message=`${V} rows are parsed successfully in ${x}.`,clearTimeout(l),this.importMessages.push({message:`Importing ${this.typeName} into a SQLite database...`,type:"info"}),i=this.importMessages[this.importMessages.length-1],n=setTimeout(()=>{i.type="loading"},1e3),c=new Date,await this.db.addTableFromCsv(this.tableName,g.data,a),m=new Date,this.addedTable=this.tableName,x=D.getPeriod(c,m),i.message=`Importing ${this.typeName} into a SQLite database is completed in ${x}.`,i.type="success",clearTimeout(n),this.importCompleted=!0}}catch(c){console.error(c),s.type==="loading"&&(s.type="info"),i.type==="loading"&&(i.type="info"),this.importMessages.push({message:c,type:"error"})}clearTimeout(l),clearTimeout(n),this.db.deleteProgressCounter(a),this.disableDialog=!1},async finish(){this.$modal.hide(this.dialogName);const t=this.getQueryExample(),e=await this.$store.dispatch("addTab",{query:t});this.$store.commit("setCurrentTabId",e),this.importCompleted=!1,this.$emit("finish"),M.send("inquiry.create",null,{auto:!0})},getQueryExample(){return this.isNdJson?this.getNdJsonQueryExample():this.isJson?this.getJsonQueryExample():["/*",` * Your CSV file has been imported into ${this.addedTable} table.`," * You can run this SQL query to make all CSV records available for charting."," */",`SELECT * FROM "${this.addedTable}"`].join(`
`)},getNdJsonQueryExample(){try{const t=JSON.parse(this.previewData.values.doc[0]),e=Object.keys(t)[0];return["/*",` * Your NDJSON file has been imported into ${this.addedTable} table.`,` * Run this SQL query to get values of property ${e} and make them available for charting.`," */",`SELECT doc->>'${e}'`,`FROM "${this.addedTable}"`].join(`
`)}catch(t){return console.error(t),["/*",` * Your NDJSON file has been imported into ${this.addedTable} table.`," */","SELECT *",`FROM "${this.addedTable}"`].join(`
`)}},getJsonQueryExample(){try{const t=JSON.parse(this.previewData.values.doc[0]),e=Object.keys(t)[0];return["/*",` * Your JSON file has been imported into ${this.addedTable} table.`,` * Run this SQL query to get values of property ${e} and make them available for charting.`," */","SELECT *",`FROM "${this.addedTable}"`,`JOIN json_each(doc, '$.${e}')`].join(`
`)}catch(t){return console.error(t),["/*",` * Your NDJSON file has been imported into ${this.addedTable} table.`," */","SELECT *",`FROM "${this.addedTable}"`].join(`
`)}}}},Es={class:"dialog-header"},Ns={class:"dialog-body"},Ps={key:0,class:"chars"},Ds={key:3,class:"no-data"},zs={class:"dialog-buttons-container"},Rs=["disabled"],As=["disabled"],Fs=["disabled"];function Zs(t,e,s,l,i,n){const r=p("close-icon"),a=p("text-field"),c=p("delimiter-selector"),g=p("check-box"),m=p("sql-table"),V=p("logs"),x=p("modal");return d(),T(x,{modalId:s.dialogName,class:"dialog",contentClass:"import-modal",scrollable:"",clickToClose:!1},{default:v(()=>[o("div",Es,[S(b(n.typeName)+" import ",1),h(r,{disabled:i.disableDialog,onClick:n.cancelImport},null,8,["disabled","onClick"])]),o("div",Ns,[h(a,{id:"csv-json-table-name",modelValue:i.tableName,"onUpdate:modelValue":e[0]||(e[0]=w=>i.tableName=w),label:"Table name",width:"484px",disabled:i.disableDialog,errorMsg:i.tableNameError},null,8,["modelValue","disabled","errorMsg"]),!n.isJson&&!n.isNdJson?(d(),u("div",Ps,[h(c,{modelValue:i.delimiter,"onUpdate:modelValue":e[1]||(e[1]=w=>i.delimiter=w),width:"210px",class:"char-input",disabled:i.disableDialog,onInput:n.preview},null,8,["modelValue","disabled","onInput"]),h(a,{id:"quote-char",modelValue:i.quoteChar,"onUpdate:modelValue":e[2]||(e[2]=w=>i.quoteChar=w),label:"Quote char",hint:"The character used to quote fields.",width:"93px",disabled:i.disableDialog,class:"char-input",onInput:n.preview},null,8,["modelValue","disabled","onInput"]),h(a,{id:"escape-char",modelValue:i.escapeChar,"onUpdate:modelValue":e[3]||(e[3]=w=>i.escapeChar=w),label:"Escape char",hint:`
            The character used to escape the quote character within a field
            (e.g. "column with ""quotes"" in text").
          `,maxHintWidth:"242px",width:"93px",disabled:i.disableDialog,class:"char-input",onInput:n.preview},null,8,["modelValue","disabled","onInput"])])):I("",!0),!n.isJson&&!n.isNdJson?(d(),T(g,{key:1,init:i.header,label:"Use first row as column headers",disabled:i.disableDialog,onClick:n.changeHeaderDisplaying},null,8,["init","disabled","onClick"])):I("",!0),i.previewData&&i.previewData.rowCount>0?(d(),T(m,{key:2,"data-set":i.previewData,preview:!0,class:"preview-table"},null,8,["data-set"])):(d(),u("div",Ds,"No data")),h(V,{class:"import-errors",messages:i.importMessages},null,8,["messages"])]),o("div",zs,[o("button",{id:"import-cancel",class:"secondary",disabled:i.disableDialog,onClick:e[4]||(e[4]=(...w)=>n.cancelImport&&n.cancelImport(...w))}," Cancel ",8,Rs),y(o("button",{id:"import-start",class:"primary",disabled:i.disableDialog||i.disableImport,onClick:e[5]||(e[5]=w=>n.loadToDb(s.file))}," Import ",8,As),[[_,!i.importCompleted]]),y(o("button",{id:"import-finish",class:"primary",disabled:i.disableDialog,onClick:e[6]||(e[6]=(...w)=>n.finish&&n.finish(...w))}," Finish ",8,Fs),[[_,i.importCompleted]])])]),_:1},8,["modalId"])}const Ve=f(Os,[["render",Zs],["__scopeId","data-v-e60cb497"]]),Us="data:image/svg+xml,%3csvg%20width='450'%20height='175'%20viewBox='0%200%20450%20175'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cmask%20id='mask0'%20mask-type='alpha'%20maskUnits='userSpaceOnUse'%20x='0'%20y='0'%20width='450'%20height='175'%3e%3crect%20width='450'%20height='175'%20fill='%23C4C4C4'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0)'%3e%3cpath%20d='M128.207%201.99272C70.1972%20-9.84897%2018.745%2030.8895%204.31985%2092.6678C-10.1054%20154.446%2014.3337%20186.332%2037.3218%20226.189C72.3784%20286.971%20181.551%20341.237%20265.083%20337.789C337.517%20334.8%20389.028%20316.514%20425.936%20248.111C489.378%20130.532%20417.444%2053.9065%20325.527%2068.2551C214.571%2085.576%20213.629%2019.4302%20128.207%201.99272Z'%20fill='%23DFE8F3'/%3e%3cpath%20d='M156.284%20169.426C158.158%20167.553%20160.699%20166.5%20163.349%20166.5H331.911C334.561%20166.5%20337.102%20167.553%20338.976%20169.426L346.041%20176.491H149.22L156.284%20169.426Z'%20fill='%23C8D4E3'/%3e%3cpath%20d='M174.099%20170.258C174.283%20170.09%20174.524%20169.997%20174.773%20169.997H318.49C318.739%20169.997%20318.98%20170.09%20319.164%20170.258V170.258C319.837%20170.874%20319.402%20171.995%20318.49%20171.995H174.773C173.861%20171.995%20173.426%20170.874%20174.099%20170.258V170.258Z'%20fill='%23506784'/%3e%3cpath%20d='M94.227%2087.881C94.3962%2080.1988%2092.5048%2065.0608%2083.5857%2065.9664C83.5857%2065.9664%2070.5776%2076.0877%2075.6391%2083.6188C80.7005%2091.1498%2093.4677%2094.5083%2094.227%2087.881Z'%20fill='%23F3C6BF'/%3e%3cpath%20d='M89.275%2091.3105L88%2098C85.5023%2099.4986%2076.5531%2099.0196%2074.5%2095C74.5%2095%2076.8298%2089.9135%2077.8446%2084.9226L89.275%2091.3105Z'%20fill='%23F3C6BF'/%3e%3cpath%20d='M92.2719%2067.1161C92.2719%2072.7689%2084.2242%2068.8872%2082.3423%2072.9126C80.4605%2076.9379%2077.3952%2086.9208%2077.3952%2086.9208C72.6323%2084.7414%2066.7273%2069.33%2073.2936%2065.1034C79.3506%2061.2047%2092.2719%2063.0102%2092.2719%2067.1161Z'%20fill='%23506784'/%3e%3cpath%20d='M79.7654%2083.9628C75.1522%2080.7269%2076.371%2075.1343%2079.7562%2076.9534C85.1994%2079.8785%2081.2934%2082.9808%2079.7654%2083.9628Z'%20fill='%23F3C6BF'/%3e%3c/g%3e%3c/svg%3e",Js="data:image/svg+xml,%3csvg%20width='114'%20height='90'%20viewBox='0%200%20114%2090'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M96.3828%201.93895C91.4244%200.092814%2086.6022%205.62505%2085.858%2010.6816L97.2851%2015.549C100.194%2010.5856%20101.341%203.78508%2096.3828%201.93895Z'%20fill='%23F3C6BF'/%3e%3cpath%20d='M84.9775%209.12413C75.0653%2035.2035%2030.7179%2046.7359%2021.4106%2037.7265L14.5359%2079.4857C67.7607%2086.4912%2091.9264%2055.4111%2099.0973%2014.7138L84.9775%209.12413Z'%20fill='%23A2B1C6'/%3e%3c/svg%3e",js=""+new URL("file-B83D6tR8.png",import.meta.url).href,Ws="data:image/svg+xml,%3csvg%20width='450'%20height='167'%20viewBox='0%200%20450%20167'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cmask%20id='mask0'%20mask-type='alpha'%20maskUnits='userSpaceOnUse'%20x='0'%20y='0'%20width='450'%20height='167'%3e%3crect%20width='450'%20height='167'%20fill='%23C4C4C4'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0)'%3e%3cpath%20d='M128.207%20-169.007C70.1972%20-180.849%2018.745%20-140.11%204.31985%20-78.3322C-10.1054%20-16.5539%2014.3337%2015.3318%2037.3218%2055.1891C72.3784%20115.971%20181.551%20170.237%20265.083%20166.789C337.517%20163.8%20389.028%20145.514%20425.936%2077.1107C489.378%20-40.4679%20417.444%20-117.093%20325.527%20-102.745C214.571%20-85.424%20213.629%20-151.57%20128.207%20-169.007Z'%20fill='%23DFE8F3'/%3e%3cpath%20d='M147.222%209.48716C147.222%206.72824%20149.458%204.4917%20152.217%204.4917H343.044C345.802%204.4917%20348.039%206.72824%20348.039%209.48715V122.384C348.039%20125.143%20345.802%20127.38%20343.044%20127.38H152.217C149.458%20127.38%20147.222%20125.143%20147.222%20122.384V9.48716Z'%20fill='white'/%3e%3cpath%20d='M156.284%20-1.57373C158.158%20-3.44739%20160.699%20-4.5%20163.349%20-4.5H331.911C334.561%20-4.5%20337.102%20-3.44739%20338.976%20-1.57373L346.041%205.49091H149.22L156.284%20-1.57373Z'%20fill='%23C8D4E3'/%3e%3cpath%20d='M147.222%209.48715C147.222%206.72824%20149.458%204.4917%20152.217%204.4917H343.044C345.802%204.4917%20348.039%206.72824%20348.039%209.48715V27.4708H147.222V9.48715Z'%20fill='%23A2B1C6'/%3e%3cpath%20d='M254.939%2067.9571C254.25%2067.5335%20253.597%2067.0519%20252.988%2066.5174V57.6935H256.832V69.018C256.195%2068.6869%20255.564%2068.3332%20254.939%2067.9571ZM262.341%2063.5031H258.498V69.7253C259.752%2070.309%20261.035%2070.8288%20262.341%2071.2829V63.5031ZM252.988%2068.2855L252.737%2068.0834C252.352%2067.7635%20251.992%2067.4351%20251.648%2067.1068L242.53%2066.0459L244.205%2069.2959L255.927%2070.2557C254.899%2069.6758%20253.916%2069.0172%20252.988%2068.2855V68.2855ZM262.14%2073.009C260.832%2072.5793%20259.549%2072.0762%20258.297%2071.5018L257.828%2071.2661L250.099%2070.7525L251.406%2073.4889L264.887%2073.8004C263.966%2073.5815%20263.036%2073.3121%20262.14%2073.009ZM246.097%2057.6935C247.572%2060.2875%20249.327%2062.7101%20251.33%2064.9176V56.1275L242.882%2051.9429L242.128%2061.7518L250.828%2066.2395C248.547%2063.8469%20246.918%2060.9036%20246.097%2057.6935V57.6935Z'%20fill='%23119DFF'/%3e%3cpath%20d='M210.738%2084.2858C211.795%2084.8763%20212.858%2085.1715%20213.926%2085.1715C214.815%2085.1715%20215.336%2084.8557%20215.49%2084.2242C215.541%2084.0085%20215.567%2083.7467%20215.567%2083.4386C215.567%2083.1254%20215.531%2082.884%20215.459%2082.7146C215.387%2082.54%20215.266%2082.4117%20215.097%2082.3295C214.927%2082.2422%20214.702%2082.178%20214.419%2082.137C214.142%2082.0959%20213.788%2082.0394%20213.356%2081.9675C212.925%2081.8905%20212.53%2081.8058%20212.17%2081.7134C211.811%2081.6209%20211.505%2081.4874%20211.254%2081.3129C210.72%2080.938%20210.463%2080.3065%20210.483%2079.4182V79.2256C210.483%2078.2912%20210.792%2077.6262%20211.408%2077.2309C212.003%2076.8406%20212.987%2076.7071%20214.358%2076.8304C215.292%2076.9176%20216.037%2077.0794%20216.591%2077.3156L216.229%2078.4786C215.613%2078.2167%20214.874%2078.0267%20214.011%2077.9086C213.744%2077.8727%20213.492%2077.8547%20213.256%2077.8547C213.025%2077.8547%20212.815%2077.8727%20212.625%2077.9086C212.435%2077.9446%20212.275%2078.0113%20212.147%2078.1089C211.901%2078.3091%20211.772%2078.6814%20211.762%2079.2256C211.747%2079.8675%20211.926%2080.2757%20212.301%2080.4503C212.661%2080.6197%20213.087%2080.7378%20213.58%2080.8045C214.073%2080.8662%20214.476%2080.9226%20214.789%2080.974C215.102%2081.0202%20215.387%2081.0844%20215.644%2081.1665C215.9%2081.2487%20216.121%2081.3796%20216.306%2081.5593C216.691%2081.9239%20216.879%2082.558%20216.868%2083.4617C216.843%2085.038%20216.185%2085.9366%20214.897%2086.1574C214.506%2086.2241%20214.116%2086.2575%20213.726%2086.2575C213.336%2086.2575%20212.976%2086.2318%20212.648%2086.1805C212.324%2086.1343%20212.014%2086.0675%20211.716%2085.9802C211.151%2085.821%20210.64%2085.6105%20210.183%2085.3487L210.738%2084.2858Z'%20fill='%232A3F5F'/%3e%3cpath%20d='M225.779%2085.2254C224.799%2085.9135%20223.762%2086.2575%20222.668%2086.2575C221.389%2086.2575%20220.537%2085.8031%20220.111%2084.8942C219.864%2084.3808%20219.721%2083.7313%20219.68%2082.9457C219.664%2082.5862%20219.656%2082.1909%20219.656%2081.7596C219.656%2081.3231%20219.659%2080.8841%20219.664%2080.4425C219.674%2080.001%20219.708%2079.5928%20219.764%2079.2179C219.821%2078.8431%20219.908%2078.5068%20220.026%2078.209C220.149%2077.9061%20220.324%2077.6493%20220.55%2077.4388C221.017%2077.0024%20221.736%2076.7841%20222.706%2076.7841C223.682%2076.7841%20224.719%2077.046%20225.818%2077.5697L225.941%2076.9382H227.05L227.058%2089.6078H225.779V85.2254ZM225.779%2078.6326C224.855%2078.1705%20223.962%2077.9394%20223.099%2077.9394C222.473%2077.9394%20222.059%2077.9908%20221.859%2078.0935C221.659%2078.1962%20221.505%2078.3297%20221.397%2078.494C221.294%2078.6583%20221.21%2078.8842%20221.143%2079.1717C221.025%2079.7109%20220.966%2080.5992%20220.966%2081.8366V82.006C220.966%2083.1459%20221.107%2083.9443%20221.389%2084.4013C221.672%2084.8686%20222.188%2085.1022%20222.937%2085.1022H223.053C223.762%2085.1022%20224.486%2084.9071%20225.225%2084.5169C225.435%2084.409%20225.62%2084.2986%20225.779%2084.1857V78.6326Z'%20fill='%232A3F5F'/%3e%3cpath%20d='M230.701%2073.0102L231.972%2072.9024V86.1034H230.716L230.701%2073.0102Z'%20fill='%232A3F5F'/%3e%3cpath%20d='M236.608%2074.7431C236.264%2074.7431%20236.044%2074.6944%20235.946%2074.5968C235.792%2074.4376%20235.715%2074.2194%20235.715%2073.9421C235.715%2073.6597%20235.73%2073.4595%20235.761%2073.3414C235.797%2073.2182%20235.848%2073.1232%20235.915%2073.0564C236.038%2072.9332%20236.226%2072.8716%20236.477%2072.8716C236.734%2072.8716%20236.916%2072.8844%20237.024%2072.9101C237.137%2072.9358%20237.23%2072.9845%20237.301%2073.0564C237.425%2073.1797%20237.486%2073.3825%20237.486%2073.6649C237.486%2073.9421%20237.471%2074.1424%20237.44%2074.2656C237.414%2074.3837%20237.368%2074.4787%20237.301%2074.5506C237.173%2074.679%20236.942%2074.7431%20236.608%2074.7431ZM235.984%2076.9382H237.248V86.1034H236L235.984%2076.9382Z'%20fill='%232A3F5F'/%3e%3cpath%20d='M245.473%2085.6644C244.636%2086.0598%20243.864%2086.2575%20243.155%2086.2575C241.871%2086.2575%20241.142%2085.7081%20240.968%2084.6093C240.927%2084.3474%20240.906%2083.9675%20240.906%2083.4694V78.0087H239.797V77.0614L240.906%2076.9382L241.106%2074.8433H242.177V76.9382H244.849V78.0087H242.177V83.4463C242.177%2084.0778%20242.223%2084.4809%20242.315%2084.6555C242.485%2084.9738%20242.824%2085.133%20243.332%2085.133C243.84%2085.133%20244.408%2084.9764%20245.034%2084.6632L245.473%2085.6644Z'%20fill='%232A3F5F'/%3e%3cpath%20d='M254.715%2085.6182C253.653%2086.0444%20252.479%2086.2575%20251.196%2086.2575C250.451%2086.2575%20249.82%2086.1805%20249.301%2086.0264C248.474%2085.7902%20247.925%2085.3024%20247.653%2084.5631C247.401%2083.8699%20247.275%2082.843%20247.275%2081.4823V81.0895C247.275%2079.4618%20247.614%2078.3194%20248.292%2077.6622C248.903%2077.0768%20249.922%2076.7841%20251.35%2076.7841C252.741%2076.7841%20253.691%2077.1282%20254.199%2077.8162C254.446%2078.1499%20254.608%2078.5556%20254.685%2079.0331C254.767%2079.5055%20254.808%2079.9573%20254.808%2080.3886C254.808%2081.0613%20254.793%2081.5824%20254.762%2081.9521C254.038%2081.9829%20253.388%2081.9983%20252.813%2081.9983C252.813%2081.9983%20252.4%2081.9983%20251.573%2081.9983C250.279%2081.9983%20249.283%2081.9419%20248.585%2081.8289C248.585%2083.0098%20248.734%2083.834%20249.031%2084.3012C249.396%2084.8711%20250.123%2085.1561%20251.211%2085.1561C252.3%2085.1561%20253.342%2084.943%20254.338%2084.5169L254.715%2085.6182ZM253.506%2080.9278V80.1884C253.506%2079.3823%20253.35%2078.8072%20253.036%2078.4632C252.687%2078.0781%20252.084%2077.8855%20251.227%2077.8855C250.2%2077.8855%20249.499%2078.1089%20249.124%2078.5556C248.764%2078.9818%20248.585%2079.7725%20248.585%2080.9278H253.506Z'%20fill='%232A3F5F'/%3e%3cpath%20d='M256.957%2076.9382H258.335L260.738%2084.4167L260.969%2085.1792L261.185%2084.4167L263.48%2076.9382H264.874L261.778%2086.1034H260.099L256.957%2076.9382Z'%20fill='%232A3F5F'/%3e%3cpath%20d='M268.155%2074.7431C267.811%2074.7431%20267.59%2074.6944%20267.493%2074.5968C267.339%2074.4376%20267.262%2074.2194%20267.262%2073.9421C267.262%2073.6597%20267.277%2073.4595%20267.308%2073.3414C267.344%2073.2182%20267.395%2073.1232%20267.462%2073.0564C267.585%2072.9332%20267.773%2072.8716%20268.024%2072.8716C268.281%2072.8716%20268.463%2072.8844%20268.571%2072.9101C268.684%2072.9358%20268.777%2072.9845%20268.848%2073.0564C268.972%2073.1797%20269.033%2073.3825%20269.033%2073.6649C269.033%2073.9421%20269.018%2074.1424%20268.987%2074.2656C268.961%2074.3837%20268.915%2074.4787%20268.848%2074.5506C268.72%2074.679%20268.489%2074.7431%20268.155%2074.7431ZM267.531%2076.9382H268.795V86.1034H267.547L267.531%2076.9382Z'%20fill='%232A3F5F'/%3e%3cpath%20d='M271.606%2085.2331L276.296%2078.001H271.506V76.9382H277.852V77.8085L273.177%2085.0329H278.045V86.1034H271.606V85.2331Z'%20fill='%232A3F5F'/%3e%3cpath%20d='M204.17%2016.481C204.17%2014.2739%20205.959%2012.4846%20208.166%2012.4846H336.05C338.257%2012.4846%20340.046%2014.2739%20340.046%2016.481V16.481C340.046%2018.6881%20338.257%2020.4773%20336.05%2020.4773H208.166C205.959%2020.4773%20204.17%2018.6881%20204.17%2016.481V16.481Z'%20fill='%23F3F6FA'/%3e%3cpath%20d='M165.205%2016.4808C165.205%2019.2397%20162.969%2021.4763%20160.21%2021.4763C157.451%2021.4763%20155.214%2019.2397%20155.214%2016.4808C155.214%2013.7219%20157.451%2011.4854%20160.21%2011.4854C162.969%2011.4854%20165.205%2013.7219%20165.205%2016.4808Z'%20fill='%23C8D4E3'/%3e%3cpath%20d='M181.191%2016.4808C181.191%2019.2397%20178.954%2021.4763%20176.195%2021.4763C173.436%2021.4763%20171.2%2019.2397%20171.2%2016.4808C171.2%2013.7219%20173.436%2011.4854%20176.195%2011.4854C178.954%2011.4854%20181.191%2013.7219%20181.191%2016.4808Z'%20fill='%23C8D4E3'/%3e%3cpath%20d='M197.176%2016.4808C197.176%2019.2397%20194.94%2021.4763%20192.181%2021.4763C189.422%2021.4763%20187.186%2019.2397%20187.186%2016.4808C187.186%2013.7219%20189.422%2011.4854%20192.181%2011.4854C194.94%2011.4854%20197.176%2013.7219%20197.176%2016.4808Z'%20fill='%23C8D4E3'/%3e%3cpath%20d='M174.099%20-0.741535C174.283%20-0.909843%20174.524%20-1.00317%20174.773%20-1.00317H318.49C318.739%20-1.00317%20318.98%20-0.909843%20319.164%20-0.741533V-0.741533C319.837%20-0.126316%20319.402%200.995008%20318.49%200.995008H174.773C173.861%200.995008%20173.426%20-0.126319%20174.099%20-0.741535V-0.741535Z'%20fill='%23506784'/%3e%3cpath%20d='M34.875%20119.735L42.5465%20126.136L30.3855%20140.712L22.714%20134.311L34.875%20119.735Z'%20fill='%23F3C6BF'/%3e%3cpath%20d='M27.0972%20129.257L34.7687%20135.657C34.7687%20135.657%2038.808%20141.112%2039.3034%20146.597C39.4941%20148.708%2037.0633%20149.282%2037.0633%20149.282L21.3367%20136.161L27.0972%20129.257Z'%20fill='%23506784'/%3e%3cpath%20d='M52.8921%2032.8145L92.2718%2064.2858C104.874%2096.2923%2038.3209%20133.723%2038.3209%20133.723L27.8556%20126.058C27.8556%20126.058%2039.6888%20108.526%2050.8095%2081.7699C56.8301%2067.2843%2054.5731%2048.1488%2052.8921%2032.8145Z'%20fill='%230D76BF'/%3e%3cpath%20d='M103.262%20130.726H113.253V149.708H103.262V130.726Z'%20fill='%23F3C6BF'/%3e%3cpath%20d='M54.3067%2042.3059C50.8101%2035.8118%2048.8117%2031.3159%2049.7739%2017.8281H115.011C121.246%2028.3186%20125.242%2054.2949%20125.242%2075.7754C125.242%2097.2559%20122.245%20116.239%20115.011%20141.216H100.764C100.764%20141.216%2094.7701%20101.252%2092.2723%2082.769C90.9679%2073.116%2057.0197%2047.3445%2054.3067%2042.3059Z'%20fill='%23119DFF'/%3e%3cpath%20d='M103.262%20144.426H113.253C113.253%20144.426%20119.849%20146.027%20123.744%20149.921C125.242%20151.42%20123.744%20153.418%20123.744%20153.418H103.262V144.426Z'%20fill='%23506784'/%3e%3c/g%3e%3c/svg%3e",Gs="data:image/svg+xml,%3csvg%20width='74'%20height='96'%20viewBox='0%200%2074%2096'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M42%204L28.8857%200C7.43729%2016.4512%201.84318e-05%2061.7961%200%2096H74C71.7416%2062.1085%2057.5%2024%2042%204Z'%20fill='%23C8D4E3'/%3e%3cmask%20id='mask0'%20mask-type='alpha'%20maskUnits='userSpaceOnUse'%20x='0'%20y='0'%20width='74'%20height='96'%3e%3cpath%20d='M42%204L28.8857%200C7.43729%2016.4512%201.84318e-05%2061.7961%200%2096H74C71.7416%2062.1085%2057.5%2024%2042%204Z'%20fill='%23C8D4E3'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0)'%3e%3cpath%20d='M32.0001%2060.5C38.5001%2073%2063.5001%2076.4999%2073.4999%2073C73.4999%2073%2075.7992%2060.7994%2075.5%2060.5002C69.7339%2054.7338%2043.0003%2057.9998%2032.0001%2060.5Z'%20fill='%23A2B1C6'/%3e%3c/g%3e%3c/svg%3e",Ks="data:image/svg+xml,%3csvg%20width='106'%20height='56'%20viewBox='0%200%20106%2056'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M104.252%201.40855C100.262%20-2.0494%2093.7773%201.40854%2091.2832%205.85426L100.262%2014.3939C104.751%2010.7941%20108.243%204.86646%20104.252%201.40855Z'%20fill='%23F3C6BF'/%3e%3cpath%20d='M91.0123%204.37207C72.4568%2025.1704%2030.4279%2022.9263%2019.9527%204.37207L0%2044.6615C38.409%2069.8547%2086.7944%2050.0954%20102.258%2014.5286L91.0123%204.37207Z'%20fill='%23C8D4E3'/%3e%3c/svg%3e",Qs={name:"DbUploader",components:{ChangeDbIcon:Mt,CsvJsonImport:Ve},props:{type:{type:String,required:!1,default:"small",validator:t=>["illustrated","small"].includes(t)},width:{type:String,required:!1,default:"unset"}},emits:[],data(){return{state:"",animationPromise:Promise.resolve(),file:null,newDb:null}},mounted(){this.type==="illustrated"&&(this.animationPromise=new Promise(t=>{this.$refs.fileImg.addEventListener("animationend",e=>{e.animationName.startsWith("fly")&&(this.state="dropped",t())})}))},methods:{cancelImport(){this.newDb&&(this.newDb.shutDown(),this.newDb=null)},async finish(){this.$store.commit("setDb",this.newDb),this.$route.path!=="/workspace"&&this.$router.push("/workspace")},loadDb(t){return Promise.all([this.newDb.loadDb(t),this.animationPromise]).then(this.finish)},async checkFile(t){if(this.state="dropping",this.newDb=me.getNewDatabase(),k.isDatabase(t))this.loadDb(t);else{const e=k.isJSON(t)||k.isNDJSON(t);M.send("database.import",t.size,{from:e?"json":"csv",new_db:!0}),this.file=t,await this.$nextTick();const s=this.$refs.addCsvJson;return s.reset(),Promise.all([s.preview(),this.animationPromise]).then(s.open)}},browse(){k.getFileFromUser(".db,.sqlite,.sqlite3,.csv,.json,.ndjson").then(this.checkFile)},drop(t){this.checkFile(t.dataTransfer.files[0])}}},Ys={key:1,class:"drop-area-container"},Xs={key:2,id:"img-container"};function ei(t,e,s,l,i,n){const r=p("change-db-icon"),a=p("csv-json-import");return d(),u("div",{class:"db-uploader-container",style:L({width:s.width})},[s.type==="small"?(d(),T(r,{key:0,onClick:n.browse},null,8,["onClick"])):I("",!0),s.type==="illustrated"?(d(),u("div",Ys,[o("div",{class:"drop-area",onDragover:e[0]||(e[0]=O(c=>i.state="dragover",["prevent"])),onDragleave:e[1]||(e[1]=O(c=>i.state="",["prevent"])),onDrop:e[2]||(e[2]=O((...c)=>n.drop&&n.drop(...c),["prevent"])),onClick:e[3]||(e[3]=(...c)=>n.browse&&n.browse(...c))},e[4]||(e[4]=[o("div",{class:"text"}," Drop the database, CSV, JSON or NDJSON file here or click to choose a file from your computer. ",-1)]),32)])):I("",!0),s.type==="illustrated"?(d(),u("div",Xs,[e[5]||(e[5]=o("img",{id:"drop-file-top-img",src:Us},null,-1)),o("img",{id:"left-arm-img",class:q({swing:i.state==="dragover"}),src:Js},null,2),o("img",{id:"file-img",ref:"fileImg",class:q({swing:i.state==="dragover",fly:i.state==="dropping",hidden:i.state==="dropped"}),src:js},null,2),e[6]||(e[6]=o("img",{id:"drop-file-bottom-img",src:Ws},null,-1)),e[7]||(e[7]=o("img",{id:"body-img",src:Gs},null,-1)),o("img",{id:"right-arm-img",class:q({swing:i.state==="dragover"}),src:Ks},null,2)])):I("",!0),e[8]||(e[8]=o("div",{id:"error",class:"error"},null,-1)),h(a,{ref:"addCsvJson",file:i.file,db:i.newDb,dialogName:"importFromCsvJson",onCancel:n.cancelImport,onFinish:n.finish},null,8,["file","db","onCancel","onFinish"])],4)}const ke=f(Qs,[["render",ei],["__scopeId","data-v-4e5df2b2"]]),ti={name:"ExportIcon",mixins:[R],props:{tooltip:String,tooltipPosition:String},emits:["click"],methods:{onClick(){this.hideTooltip(),this.$emit("click")}}};function si(t,e,s,l,i,n){return d(),u("span",null,[(d(),u("svg",{class:"icon",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",onClick:e[0]||(e[0]=O((...r)=>n.onClick&&n.onClick(...r),["stop"])),onMouseenter:e[1]||(e[1]=r=>t.showTooltip(r,s.tooltipPosition)),onMouseleave:e[2]||(e[2]=(...r)=>t.hideTooltip&&t.hideTooltip(...r))},e[3]||(e[3]=[o("path",{d:`M10.5 1.5H4.5C3.675 1.5 3 2.175 3 3V15C3 15.825 3.675 16.5 4.5 16.5H13.5C14.325 16.5
        15 15.825 15 15V6L10.5 1.5ZM13.5 15H4.5V3H9.75V6.75H13.5V15ZM12 8.25V13.575L10.425
        12L8.325 14.1L6.225 12L8.325 9.9L6.675 8.25H12Z`,fill:"#A2B1C6"},null,-1)]),32)),o("span",{ref:"tooltip",class:"icon-tooltip",style:L(t.tooltipStyle)},b(s.tooltip),5)])}const Le=f(ti,[["render",si],["__scopeId","data-v-1cbf6877"]]),ii={name:"AddTableIcon",mixins:[R],props:{tooltip:String},emits:["click"],methods:{onClick(){this.hideTooltip(),this.$emit("click")}}};function ni(t,e,s,l,i,n){return d(),u("span",null,[(d(),u("svg",{class:"icon",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",onClick:e[0]||(e[0]=O((...r)=>n.onClick&&n.onClick(...r),["stop"])),onMouseenter:e[1]||(e[1]=(...r)=>t.showTooltip&&t.showTooltip(...r)),onMouseleave:e[2]||(e[2]=(...r)=>t.hideTooltip&&t.hideTooltip(...r))},e[3]||(e[3]=[o("g",{"clip-path":"url(#clip0)"},[o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:`M13.6573 1.5H2.59985C1.77485 1.5 1.09985 2.175 1.09985 3V13.6649C1.09985 14.4899
            1.77485 15.1649 2.59985
            15.1649H9.84V13.6649H8.87866V9.08244H13.6573V9.83777H15.1573V3C15.1573
            2.17 14.4873 1.5 13.6573 1.5ZM13.6573
            7.58244V3H8.87866V7.58244H13.6573ZM7.37866 3H2.59985V7.58244H7.37866V3ZM2.59985
            9.08244V13.6649H7.37866V9.08244H2.59985ZM13.1702
            10.8434H15.6702V13.1717H18.0001V15.6717H15.6702V18H13.1702V15.6717H10.8401V13.1717H13.1702V10.8434Z`,fill:"#A2B1C6"})],-1),o("defs",null,[o("clipPath",{id:"clip0"},[o("rect",{width:"18",height:"18",fill:"white"})])],-1)]),32)),o("span",{ref:"tooltip",class:"icon-tooltip",style:L(t.tooltipStyle)}," Add new table from CSV, JSON or NDJSON ",4)])}const oi=f(ii,[["render",ni],["__scopeId","data-v-20ff5dc5"]]),li={name:"Schema",components:{TableDescription:_t,TextField:ie,TreeChevron:ye,DbUploader:ke,ExportIcon:Le,AddTableIcon:oi,CsvJsonImport:Ve},data(){return{schemaVisible:!0,filter:null,file:null}},computed:{schema(){return this.$store.state.db.schema?this.filter?this.$store.state.db.schema.filter(t=>t.name.toUpperCase().indexOf(this.filter.toUpperCase())!==-1):this.$store.state.db.schema:[]},dbName(){return this.$store.state.db.dbName}},methods:{exportToFile(){this.$store.state.db.export(`${this.dbName}.sqlite`)},async addCsvJson(){this.file=await k.getFileFromUser(".csv,.json,.ndjson"),await this.$nextTick();const t=this.$refs.addCsvJson;t.reset(),await t.preview(),t.open();const e=k.isJSON(this.file)||k.isNDJSON(this.file);M.send("database.import",this.file.size,{from:e?"json":"csv",new_db:!1})}}},ri={id:"schema-container"},ai={id:"schema-filter"},di={id:"db"},ci={class:"schema"};function ui(t,e,s,l,i,n){const r=p("text-field"),a=p("tree-chevron"),c=p("db-uploader"),g=p("export-icon"),m=p("add-table-icon"),V=p("table-description"),x=p("csv-json-import");return d(),u("div",ri,[o("div",ai,[h(r,{modelValue:i.filter,"onUpdate:modelValue":e[0]||(e[0]=w=>i.filter=w),placeholder:"Search table",width:"100%"},null,8,["modelValue"])]),o("div",di,[o("div",{class:"db-name",onClick:e[1]||(e[1]=w=>i.schemaVisible=!i.schemaVisible)},[y(h(a,{expanded:i.schemaVisible},null,8,["expanded"]),[[_,n.schema.length>0]]),S(" "+b(n.dbName),1)]),h(c,{id:"db-edit",type:"small"}),h(g,{tooltip:"Export database",onClick:n.exportToFile},null,8,["onClick"]),h(m,{onClick:n.addCsvJson},null,8,["onClick"])]),y(o("div",ci,[(d(!0),u(B,null,H(n.schema,w=>(d(),T(V,{key:w.name,name:w.name,columns:w.columns},null,8,["name","columns"]))),128))],512),[[_,i.schemaVisible]]),h(x,{ref:"addCsvJson",file:i.file,db:t.$store.state.db,dialogName:"addCsvJson"},null,8,["file","db"])])}const hi=f(li,[["render",ui],["__scopeId","data-v-69554550"]]),pi={tabs:[],currentTab:null,currentTabId:null,untitledLastIndex:0,inquiries:[],predefinedInquiries:[],loadingPredefinedInquiries:!1,predefinedInquiriesLoaded:!1,db:null,isWorkspaceVisible:!1},mi={setDb(t,e){t.db&&t.db.shutDown(),t.db=e},updateTab(t,{tab:e,newValues:s}){const{name:l,id:i,query:n,viewType:r,viewOptions:a,isSaved:c}=s,g=e.id;i&&t.currentTabId===g&&(t.currentTabId=i),i&&(e.id=i),l&&(e.name=l),n&&(e.query=n),r&&(e.viewType=r),a&&(e.viewOptions=a),c!==void 0&&(e.isSaved=c),c&&delete e.isPredefined},deleteTab(t,e){const s=t.tabs.indexOf(e);e.id===t.currentTabId&&(s<t.tabs.length-1?t.currentTabId=t.tabs[s+1].id:s>0?t.currentTabId=t.tabs[s-1].id:(t.currentTabId=null,t.untitledLastIndex=0),t.currentTab=t.currentTabId?t.tabs.find(l=>l.id===t.currentTabId):null),t.tabs.splice(s,1)},setCurrentTabId(t,e){try{t.currentTabId=e,t.currentTab=t.tabs.find(s=>s.id===e)}catch{console.error("Can't open a tab id:"+e)}},updatePredefinedInquiries(t,e){t.predefinedInquiries=Array.isArray(e)?e:[e]},setLoadingPredefinedInquiries(t,e){t.loadingPredefinedInquiries=e},setPredefinedInquiriesLoaded(t,e){t.predefinedInquiriesLoaded=e},setInquiries(t,e){t.inquiries=e},setIsWorkspaceVisible(t,e){t.isWorkspaceVisible=e}};let fi=class{constructor(e,s={}){this.id=s.id||U(),this.name=s.id?s.name:null,this.tempName=s.name||(e.untitledLastIndex?`Untitled ${e.untitledLastIndex}`:"Untitled"),this.query=s.query,this.viewOptions=s.viewOptions||void 0,this.isPredefined=s.isPredefined,this.viewType=s.viewType||"chart",this.result=null,this.isGettingResults=!1,this.error=null,this.time=0,this.layout=s.layout||{sqlEditor:"above",table:"bottom",dataView:"hidden"},this.maximize=s.maximize,this.isSaved=!!s.id,this.state=e}async execute(){this.isGettingResults=!0,this.result=null,this.error=null;const e=this.state.db;try{const s=new Date;this.result=await e.execute(this.query+";"),this.time=D.getPeriod(s,new Date),this.result&&this.result.values&&M.send("resultset.create",this.result.values[this.result.columns[0]].length),M.send("query.run",parseFloat(this.time),{status:"success"})}catch(s){this.error={type:"error",message:s},M.send("query.run",0,{status:"error"})}e.refreshSchema(),this.isGettingResults=!1}};const gi={async addTab({state:t},e={}){if(!t.tabs.some(s=>s.id===e.id)){const s=new fi(t,JSON.parse(JSON.stringify(e)));return t.tabs.push(s),s.name||(t.untitledLastIndex+=1),s.id}return e.id},async saveInquiry({state:t},{inquiryTab:e,newName:s}){const l={id:e.isPredefined?U():e.id,query:e.query,viewType:e.dataView.mode,viewOptions:e.dataView.getOptionsForSave(),name:s||e.name},i=t.inquiries;if(s)l.createdAt=new Date;else{var n=i.findIndex(r=>r.id===e.id);l.createdAt=i[n].createdAt}return s?i.push(l):i.splice(n,1,l),l},addInquiry({state:t},e){t.inquiries.push(e)},deleteInquiries({state:t,commit:e},s){t.inquiries=t.inquiries.filter(n=>!s.has(n.id));const l=t.tabs;let i=l.length-1;for(;i>-1;)s.has(l[i].id)&&e("deleteTab",l[i]),i--},renameInquiry({state:t,commit:e},{inquiryId:s,newName:l}){const i=t.inquiries.find(r=>r.id===s);i.name=l;const n=t.tabs.find(r=>r.id===i.id);n&&e("updateTab",{tab:n,newValues:{name:l}})}},F=ze({state:pi,mutations:mi,actions:gi});function Ci(t){return typeof t=="string"?t:t.text}function Te(t,e){const s=ue.hint.sql(t,e),l=t.getRange(s.from,s.to).toUpperCase();return s.list.length===1&&Ci(s.list[0]).toUpperCase()===l&&(s.list=[]),s}const xe={get tables(){const t={};return F.state.db.schema&&F.state.db.schema.forEach(e=>{t[e.name]=e.columns.map(s=>s.name)}),t},get defaultTable(){const t=F.state.db.schema;return t&&t.length===1?t[0].name:null},completeSingle:!1,completeOnSingleClick:!0,alignWithWord:!1};function vi(t){ue.showHint(t,Te,xe)}function bi(t){const e=t.getTokenAt(t.getCursor()),s=e.string.slice(-1);e.type==="string"||!s||s===" "||s===";"||ue.showHint(t,Te,xe)}const wi={name:"SideBarButton",components:{LoadingIndicator:j},mixins:[R],props:{active:Boolean,disabled:Boolean,tooltip:String,tooltipPosition:String,loading:Boolean},emits:["click"],methods:{onClick(){this.hideTooltip(),this.$emit("click")}}},yi=["disabled"],_i={class:"icon"},Ii={class:"icon-in-progress"};function Si(t,e,s,l,i,n){const r=p("loading-indicator");return d(),u("button",{class:q(["icon-btn",{active:s.active}]),disabled:s.disabled,onClick:e[0]||(e[0]=(...a)=>n.onClick&&n.onClick(...a)),onMouseenter:e[1]||(e[1]=a=>t.showTooltip(a,s.tooltipPosition)),onMouseleave:e[2]||(e[2]=(...a)=>t.hideTooltip&&t.hideTooltip(...a))},[o("div",_i,[ee(t.$slots,"default",{},void 0,!0)]),y(o("div",Ii,[h(r)],512),[[_,s.loading]]),s.tooltip?(d(),u("span",{key:0,ref:"tooltip",class:"icon-tooltip",style:L(t.tooltipStyle)},b(s.tooltip),5)):I("",!0)],42,yi)}const W=f(wi,[["render",Si],["__scopeId","data-v-968ea131"]]),Vi={name:"TableIcon"},ki={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none"};function Li(t,e,s,l,i,n){return d(),u("svg",ki,e[0]||(e[0]=[J(`<path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 2.16512L3.5 2.16999C2.675 2.16999 2 2.84499 2 3.66999V14.3349C2 15.1599 2.675
        15.8349 3.5 15.8349L14.5 15.83C15.3327 15.83 16 15.1551 16 14.33V3.66512C16 2.83511 15.33
        2.16512 14.5 2.16512ZM14.5014 3.66512L3.49878 3.66999V14.33L14.5014 14.3251V3.66512Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M6.27319 14.7069L6.27319 3.32135L7.77319 3.32135L7.77319 14.7069L6.27319 14.7069Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.2639 14.6932L10.2639 3.30772L11.7639 3.30772L11.7639 14.6932L10.2639 14.6932Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M15.5108 7.48325H2.4895V5.98325H15.5108V7.48325Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M15.5108 11.6056H2.4895V10.1056H15.5108V11.6056Z" fill="#A2B1C6"></path>`,5)]))}const Ti=f(Vi,[["render",Li]]),xi={name:"SqlEditorIcon"},qi={width:"18",height:"19",viewBox:"0 0 18 19",fill:"none"};function Mi(t,e,s,l,i,n){return d(),u("svg",qi,e[0]||(e[0]=[J(`<g clip-path="url(#clip0)"><path d="M4.5 1.51343H10.5L15 6.01343V8.45284H13.5V6.76343H9.75V3.01343H4.5V8.45284H3V3.01343C3
          2.18843 3.675 1.51343 4.5 1.51343Z" fill="#A2B1C6"></path><path d="M4.28369 14.8127C4.28369 14.5872 4.20312 14.4114 4.04199 14.2854C3.88379 14.1594
          3.604 14.0291 3.20264 13.8943C2.80127 13.7595 2.47314 13.6292 2.21826 13.5032C1.38916
          13.0959 0.974609 12.5364 0.974609 11.8245C0.974609 11.47 1.07715 11.158 1.28223
          10.8884C1.49023 10.616 1.7832 10.405 2.16113 10.2556C2.53906 10.1033 2.96387 10.0271
          3.43555 10.0271C3.89551 10.0271 4.30713 10.1091 4.67041 10.2732C5.03662 10.4373 5.3208
          10.6716 5.52295 10.9763C5.7251 11.2781 5.82617 11.6238 5.82617 12.0134H4.28809C4.28809
          11.7527 4.20752 11.5505 4.04639 11.407C3.88818 11.2634 3.67285 11.1917 3.40039
          11.1917C3.125 11.1917 2.90674 11.2532 2.74561 11.3762C2.5874 11.4963 2.5083
          11.6501 2.5083 11.8376C2.5083 12.0017 2.59619 12.1511 2.77197 12.2859C2.94775 12.4177
          3.25684 12.5554 3.69922 12.699C4.1416 12.8396 4.50488 12.9919 4.78906 13.156C5.48047
          13.5544 5.82617 14.1038 5.82617 14.804C5.82617 15.3635 5.61523 15.803 5.19336
          16.1223C4.77148 16.4417 4.19287 16.6013 3.45752 16.6013C2.93896 16.6013 2.46875 16.509
          2.04688 16.3245C1.62793 16.137 1.31152 15.8821 1.09766 15.5598C0.886719 15.2346
          0.78125 14.8611 0.78125 14.4392H2.32812C2.32812 14.782 2.41602 15.0354 2.5918
          15.1995C2.77051 15.3606 3.05908 15.4412 3.45752 15.4412C3.7124 15.4412 3.91309
          15.387 4.05957 15.2786C4.20898 15.1672 4.28369 15.012 4.28369 14.8127ZM12.0444
          13.446C12.0444 14.0378 11.9463 14.5549 11.75 14.9973C11.5537 15.4368 11.2827 15.7898
          10.937 16.0564L11.9697 16.8738L11.0161 17.6824L9.64062 16.575C9.51172 16.5925 9.38281
          16.6013 9.25391 16.6013C8.70898 16.6013 8.22559 16.4753 7.80371 16.2234C7.38184 15.9714
          7.05225 15.6111 6.81494 15.1423C6.58057 14.6736 6.45898 14.1345 6.4502
          13.5251V13.1868C6.4502 12.5569 6.56445 12.0032 6.79297 11.5256C7.02441 11.0481 7.35254
          10.679 7.77734 10.4182C8.20508 10.1575 8.69434 10.0271 9.24512 10.0271C9.78711 10.0271
          10.2705 10.156 10.6953 10.4138C11.1201 10.6716 11.4497 11.0393 11.6841 11.5168C11.9214
          11.9915 12.0415 12.5364 12.0444 13.1516V13.446ZM10.4756 13.178C10.4756 12.5422 10.3687
          12.0603 10.1548 11.7322C9.94385 11.4011 9.64062 11.2356 9.24512 11.2356C8.83789 11.2356
          8.53174 11.3982 8.32666 11.7234C8.12158 12.0486 8.01758 12.5247 8.01465
          13.1516V13.446C8.01465 14.0759 8.11865 14.5593 8.32666 14.8962C8.53467 15.2302 8.84375
          15.3972 9.25391 15.3972C9.64648 15.3972 9.94678 15.2317 10.1548 14.9006C10.3657
          14.5696 10.4727 14.0935 10.4756 13.4724V13.178ZM14.3735
          15.3269H17.0586V16.5134H12.8311V10.115H14.3735V15.3269Z" fill="#A2B1C6"></path></g><defs><clipPath id="clip0"><rect width="18" height="18" fill="white" transform="translate(0 0.0134277)"></rect></clipPath></defs>`,2)]))}const $i=f(xi,[["render",Mi]]),Bi={name:"DataViewIcon"},Hi={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none"};function Oi(t,e,s,l,i,n){return d(),u("svg",Hi,e[0]||(e[0]=[o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:`M13.5552 6.91522C13.7584 6.91357 13.9535 6.99442 14.096 7.13926L17.2582 10.3541C17.5486
        10.6494 17.5447 11.1242 17.2494 11.4147C16.9541 11.7051 16.4793 11.7012 16.1888
        11.4059L13.57 8.74357L9.29577 13.2318C9.01977 13.5216 8.56484 13.5436 8.2621
        13.2819L5.35435 10.7677L2.03285 13.7321C1.72382 14.0079 1.24971 13.981 0.973901
        13.6719C0.69809 13.3629 0.725022 12.8888 1.03406 12.613L4.8471 9.20986C5.12827 8.95892
        5.55198 8.95559 5.83705 9.20208L8.70249 11.6797L13.0182 7.14796C13.1583 7.00084 13.3521
        6.91686 13.5552 6.91522Z`,fill:"#A2B1C6"},null,-1),o("circle",{cx:"5.50049",cy:"6.00339",r:"1.5",fill:"#A2B1C6"},null,-1),o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:`M16.036 1.21788L1.96546 1.213C1.14046 1.213 0.465462 1.888 0.465462 2.713L0.464111
        15.2821C0.464111 16.1071 1.13911 16.7821 1.96411 16.7821L16.0347 16.787C16.8674 16.787
        17.5347 16.1121 17.5347 15.287L17.536 2.71788C17.536 1.88787 16.866 1.21788 16.036
        1.21788ZM16.0374 2.71788L1.96424 2.713L1.96289 15.2773L16.036 15.2821L16.0374 2.71788Z`,fill:"#A2B1C6"},null,-1)]))}const Ei=f(Bi,[["render",Oi]]),Ni={name:"SideToolBar",components:{IconButton:W,SqlEditorIcon:$i,DataViewIcon:Ei,TableIcon:Ti},props:{panel:String},emits:["switchTo"]},Pi={class:"side-tool-bar"},Di={key:0,class:"side-tool-bar-divider"};function zi(t,e,s,l,i,n){const r=p("sql-editor-icon"),a=p("icon-button"),c=p("table-icon"),g=p("data-view-icon");return d(),u("div",Pi,[h(a,{ref:"sqlEditorBtn",active:s.panel==="sqlEditor",tooltip:"Switch panel to SQL editor",tooltipPosition:"top-left",onClick:e[0]||(e[0]=m=>t.$emit("switchTo","sqlEditor"))},{default:v(()=>[h(r)]),_:1},8,["active"]),h(a,{ref:"tableBtn",active:s.panel==="table",tooltip:"Switch panel to result set",tooltipPosition:"top-left",onClick:e[1]||(e[1]=m=>t.$emit("switchTo","table"))},{default:v(()=>[h(c)]),_:1},8,["active"]),h(a,{ref:"dataViewBtn",active:s.panel==="dataView",tooltip:"Switch panel to data view",tooltipPosition:"top-left",onClick:e[2]||(e[2]=m=>t.$emit("switchTo","dataView"))},{default:v(()=>[h(g)]),_:1},8,["active"]),t.$slots.default?(d(),u("div",Di)):I("",!0),ee(t.$slots,"default",{},void 0,!0)])}const fe=f(Ni,[["render",zi],["__scopeId","data-v-10ab3ab5"]]),Ri={name:"RunIcon"},Ai={width:"12",height:"13",viewBox:"0 0 12 13",fill:"none"};function Fi(t,e,s,l,i,n){return d(),u("svg",Ai,e[0]||(e[0]=[o("path",{d:"M11.1624 6.94358L0.770043 12.9436L0.770043 0.943573L11.1624 6.94358Z",fill:"#A2B1C6"},null,-1)]))}const Zi=f(Ri,[["render",Fi]]),Ui={name:"SqlEditor",components:{Codemirror:we,SideToolBar:fe,IconButton:W,RunIcon:Zi},props:{modelValue:String,isGettingResults:Boolean},emits:["update:modelValue","run","switchTo"],data(){return{query:this.modelValue,cmOptions:{tabSize:4,mode:"text/x-mysql",theme:"neo",lineNumbers:!0,line:!0,autoRefresh:!0,styleActiveLine:!1,extraKeys:{"Ctrl-Space":vi}}}},computed:{runDisabled(){return!this.$store.state.db||!this.query||this.isGettingResults}},watch:{query(){this.$emit("update:modelValue",this.query)}},methods:{onChange:D.debounce((t,e)=>bi(e),400),focus(){var t;(t=this.$refs.cm.cminstance)==null||t.focus()}}},Ji={class:"sql-editor-panel"},ji={class:"codemirror-box original-style"};function Wi(t,e,s,l,i,n){const r=p("codemirror"),a=p("run-icon"),c=p("icon-button"),g=p("side-tool-bar");return d(),u("div",Ji,[o("div",ji,[h(r,{ref:"cm",value:i.query,"onUpdate:value":e[0]||(e[0]=m=>i.query=m),options:i.cmOptions,originalStyle:!0,onChange:n.onChange},null,8,["value","options","onChange"])]),h(g,{panel:"sqlEditor",onSwitchTo:e[2]||(e[2]=m=>t.$emit("switchTo",m))},{default:v(()=>[h(c,{ref:"runBtn",disabled:n.runDisabled,loading:s.isGettingResults,tooltip:"Run SQL query",tooltipPosition:"top-left",onClick:e[1]||(e[1]=m=>t.$emit("run"))},{default:v(()=>[h(a,{disabled:n.runDisabled},null,8,["disabled"])]),_:1},8,["disabled","loading"])]),_:1})])}const Gi=f(Ui,[["render",Wi],["__scopeId","data-v-7c08166c"]]);class Ki extends Re{constructor(e){super(e),this.plotComponentRef=Ae.createRef()}render(){return Q.createElement("div",{className:"plotly_editor"},!this.props.hideControls&&Q.createElement(Fe,{graphDiv:this.state.graphDiv,dataSources:this.props.dataSources,dataSourceOptions:this.props.dataSourceOptions,plotly:this.props.plotly,onUpdate:this.props.onUpdate,advancedTraceTypeSelector:this.props.advancedTraceTypeSelector,locale:this.props.locale,traceTypesConfig:this.props.traceTypesConfig,dictionaries:this.props.dictionaries,showFieldTooltips:this.props.showFieldTooltips,srcConverters:this.props.srcConverters,makeDefaultTrace:this.props.makeDefaultTrace,glByDefault:this.props.glByDefault,mapBoxAccess:!!(this.props.config&&this.props.config.mapboxAccessToken),fontOptions:this.props.fontOptions,chartHelp:this.props.chartHelp,customConfig:this.props.customConfig},this.props.children),Q.createElement("div",{className:"plotly_editor_plot",style:{width:"100%",height:"100%"}},Q.createElement(this.PlotComponent,{ref:this.plotComponentRef,data:this.props.data,layout:this.props.layout,frames:this.props.frames,config:this.props.config,useResizeHandler:this.props.useResizeHandler,debug:this.props.debug,onInitialized:this.handleRender,onUpdate:this.handleRender,style:{width:"100%",height:"100%"},divId:this.props.divId})))}}function Qi(t){return t?Object.keys(t).map(e=>({value:e,label:e})):[]}function Yi(t,e){const s=JSON.parse(JSON.stringify(t)),l={};for(const i in e)l[i]=[];return de(s.data,l),s}async function Xi(t,e){const s=t.querySelector(".js-plotly-plot");return await te.toImage(s,{format:e,width:null,height:null})}function en(t){const e=t.querySelector(".js-plotly-plot");return{data:e.data,layout:e.layout}}function tn(t){const e=U();return`
      <script src="https://cdn.plot.ly/plotly-latest.js" charset="UTF-8"><\/script>
      <div id="${e}"></div>
      <script>
        const el = document.getElementById("${e}")
        
        let timeout
        function debounceResize() {
          clearTimeout(timeout)
          timeout = setTimeout(() => {
            var r = el.getBoundingClientRect()
            Plotly.relayout(el, {width: r.width, height: r.height})
          }, 200)
        }
        
        const resizeObserver = new ResizeObserver(debounceResize)
        resizeObserver.observe(el)
      
        Plotly.newPlot(el, ${JSON.stringify(t.data)}, ${JSON.stringify(t.layout)})
      <\/script>
  `}const P={getOptionsFromDataSources:Qi,getOptionsForSave:Yi,getImageDataUrl:Xi,getHtml:tn,getChartData:en},sn={name:"Chart",components:{PlotlyEditor:Ze(Ki)},props:{dataSources:Object,initOptions:Object,importToPngEnabled:Boolean,importToSvgEnabled:Boolean,forPivot:Boolean},emits:["update:importToSvgEnabled","update","loadingImageCompleted"],data(){return{plotly:te,state:this.initOptions||{data:[],layout:{autosize:!0},frames:[]},config:{editable:!0,displaylogo:!1,modeBarButtonsToRemove:["toImage"]},resizeObserver:null,useResizeHandler:this.$store.state.isWorkspaceVisible}},computed:{dataSourceOptions(){return P.getOptionsFromDataSources(this.dataSources)}},watch:{dataSources(){this.dataSources&&(de(this.state.data,this.dataSources),this.updatePlotly())}},created(){te.setPlotConfig({notifyOnLogging:1}),this.$watch(()=>this.state&&this.state.data&&this.state.data.map(t=>`${t.type}${t.mode?"-"+t.mode:""}`).join(","),t=>{M.send("viz_plotly.render",null,{type:t,pivot:!!this.forPivot})},{deep:!0}),this.$emit("update:importToSvgEnabled",!0)},mounted(){this.resizeObserver=new ResizeObserver(this.handleResize),this.resizeObserver.observe(this.$refs.chartContainer),this.dataSources&&(de(this.state.data,this.dataSources),this.updatePlotly())},activated(){this.useResizeHandler=!0},deactivated(){this.useResizeHandler=!1},beforeUnmount(){this.resizeObserver.unobserve(this.$refs.chartContainer)},methods:{async handleResize(){this.updatePlotly()},onRender(){},update(t,e,s){this.state={data:t,layout:e,frames:s},this.$emit("update")},updatePlotly(){const t=this.$refs.plotlyEditor.plotComponentRef.current;t.updatePlotly(!0,t.props.onUpdate,!1)},getOptionsForSave(){return P.getOptionsForSave(this.state,this.dataSources)},async saveAsPng(){const t=await this.prepareCopy();this.$emit("loadingImageCompleted"),k.downloadFromUrl(t,"chart")},async saveAsSvg(){const t=await this.prepareCopy("svg");k.downloadFromUrl(t,"chart")},saveAsHtml(){k.exportToFile(P.getHtml(this.state),"chart.html","text/html")},async prepareCopy(t="png"){return await P.getImageDataUrl(this.$refs.plotlyEditor.$el,t)}}},nn={ref:"chartContainer",class:"chart-container"},on={class:"warning chart-warning"};function ln(t,e,s,l,i,n){const r=p("PlotlyEditor");return d(),u("div",nn,[y(o("div",on," There is no data to build a chart. Run your SQL query and make sure the result is not empty. ",512),[[_,!s.dataSources]]),o("div",{class:"chart",style:L({height:s.dataSources?"100%":"calc(100% - 40px)"})},[h(r,{ref:"plotlyEditor",data:i.state.data,layout:i.state.layout,frames:i.state.frames,config:i.config,dataSources:s.dataSources,dataSourceOptions:n.dataSourceOptions,plotly:i.plotly,useResizeHandler:i.useResizeHandler,debug:!0,advancedTraceTypeSelector:!0,onUpdate:n.update,onRender:n.onRender},null,8,["data","layout","frames","config","dataSources","dataSourceOptions","plotly","useResizeHandler","onUpdate","onRender"])],4)],512)}const qe=f(sn,[["render",ln],["__scopeId","data-v-dc953106"]]),rn={name:"SortIcon",props:{horizontal:{type:Boolean,required:!1,default:!1},asc:{type:Boolean,required:!1,default:!0}}};function an(t,e,s,l,i,n){return d(),u("svg",{class:q(["sort-icon",{horizontal:s.horizontal},{asc:s.asc}]),width:"6",height:"12",viewBox:"0 0 6 12",fill:"none"},e[0]||(e[0]=[o("path",{d:`M2.99932 -3.63032e-05C2.75092 -3.63032e-05 2.54932 0.201563 2.54932 0.449964L2.54932
        11.55C2.54932 11.7984 2.75092 12 2.99932 12C3.24772 12 3.44932 11.7984 3.44932
        11.55L3.44932 0.449964C3.44932 0.201563 3.24772 -3.63032e-05 2.99932 -3.63032e-05Z`,fill:"#506784"},null,-1),o("path",{d:`M2.99915 1.80492e-05C2.8839 1.80492e-05 2.76865 0.0438534 2.68109 0.132073L0.581055
        2.232C0.405273 2.40789 0.405273 2.69287 0.581055 2.86865C0.756946 3.04443 1.04193 3.04443
        1.21771 2.86865L2.99969 1.08667L4.78168 2.86865C4.95746 3.04443 5.24255 3.04443 5.41833
        2.86865C5.59412 2.69287 5.59412 2.40789 5.41833 2.232L3.3183 0.132073C3.22953 0.0438534
        3.11428 1.80492e-05 2.99915 1.80492e-05V1.80492e-05Z`,fill:"#506784"},null,-1)]),2)}const dn=f(rn,[["render",an],["__scopeId","data-v-7f2db618"]]),cn={name:"PivotSortBtn",components:{SortIcon:dn},props:{direction:String,modelValue:String},emits:["update:modelValue"],methods:{changeSorting(){this.modelValue==="key_a_to_z"?this.$emit("update:modelValue","value_a_to_z"):this.modelValue==="value_a_to_z"?this.$emit("update:modelValue","value_z_to_a"):this.$emit("update:modelValue","key_a_to_z")}}};function un(t,e,s,l,i,n){const r=p("sort-icon");return d(),u("div",{class:q(["pivot-sort-btn",s.direction]),onClick:e[0]||(e[0]=(...a)=>n.changeSorting&&n.changeSorting(...a))},[S(b(s.modelValue.includes("key")?"key":"value")+" ",1),h(r,{class:"sort-icon",horizontal:s.direction==="col",asc:s.modelValue.includes("a_to_z")},null,8,["horizontal","asc"])],2)}const hn=f(cn,[["render",un],["__scopeId","data-v-797adbe7"]]),pn=["Count","Count as Fraction of Total","Count as Fraction of Rows","Count as Fraction of Columns"],mn=["Sum over Sum","80% Upper Bound","80% Lower Bound"];function fn(t){const e=t.getRowKeys(),s=t.getColKeys(),l={"Column keys":s.map(c=>c.join("-")),"Row keys":e.map(c=>c.join("-"))},i={},n={},r=t.rowAttrs.join("-"),a=t.colAttrs.join("-");return s.forEach(c=>{const g=a+":"+c.join("-");n[g]=[],e.forEach(m=>{const V=t.getAggregator(m,c).value();n[g].push(V);const x=r+":"+m.join("-");i[x]||(i[x]=[]),i[x].push(V)})}),Object.assign(l,n,i)}function gn(t,e){const s=e.getCustomComponentsProps();return s.dataSources=fn(t),null}$.extend($.pivotUtilities.renderers,$.pivotUtilities.export_renderers,$.pivotUtilities.plotly_renderers,{"Custom chart":gn});const Cn=Object.keys($.pivotUtilities.renderers).map(t=>({name:t,fun:$.pivotUtilities.renderers[t]})),vn=Object.keys($.pivotUtilities.aggregators).map(t=>({name:t,fun:$.pivotUtilities.aggregators[t]}));async function bn(t){const e=t.querySelector(".pvtTable");return await Ue(e,{logging:!1})}function wn(t){return`
      <style>
        table.pvtTable {
          font-family: Arial, sans-serif;
          font-size: 12px;
          text-align: left;
          border-collapse: collapse;
          min-width: 100%;
        }
        table.pvtTable .pvtColLabel {
          text-align: center;
        }
        table.pvtTable .pvtTotalLabel {
          text-align: right;
        }
        table.pvtTable tbody tr td {
          color: #506784;
          border: 1px solid #DFE8F3;
          text-align: right;
        }
        table.pvtTable thead tr th,
        table.pvtTable tbody tr th {
          background-color: #506784;
          color: #fff;
          border: 1px solid #DFE8F3;
        }
      </style>
      ${t.outerHTML}
  `}const ae={getPivotCanvas:bn,getPivotHtml:wn},yn={name:"PivotUi",components:{Multiselect:Je,PivotSortBtn:hn},props:{keyNames:Array,modelValue:Object},emits:["update:modelValue","update"],data(){const t=this.modelValue&&this.modelValue.aggregatorName||"Count",e=this.modelValue&&this.modelValue.rendererName||"Table";return{collapsed:!1,renderer:{name:e,fun:$.pivotUtilities.renderers[e]},aggregator:{name:t,fun:$.pivotUtilities.aggregators[t]},rows:this.modelValue&&this.modelValue.rows||[],cols:this.modelValue&&this.modelValue.cols||[],val1:this.modelValue&&this.modelValue.vals&&this.modelValue.vals[0]||"",val2:this.modelValue&&this.modelValue.vals&&this.modelValue.vals[1]||"",colOrder:this.modelValue&&this.modelValue.colOrder||"key_a_to_z",rowOrder:this.modelValue&&this.modelValue.rowOrder||"key_a_to_z"}},computed:{valCount(){return pn.includes(this.aggregator.name)?0:mn.includes(this.aggregator.name)?2:1},renderers(){return Cn},aggregators(){return vn},rowsToSelect(){return this.keyNames.filter(t=>!this.cols.includes(t))},colsToSelect(){return this.keyNames.filter(t=>!this.rows.includes(t))}},watch:{renderer(){this.returnValue()},aggregator(){this.returnValue()},rows(){this.returnValue()},cols(){this.returnValue()},val1(){this.returnValue()},val2(){this.returnValue()},colOrder(){this.returnValue()},rowOrder(){this.returnValue()}},methods:{returnValue(){const t=[];for(let e=1;e<=this.valCount;e++)t.push(this[`val${e}`]);this.$emit("update"),this.$emit("update:modelValue",{rows:this.rows,cols:this.cols,colOrder:this.colOrder,rowOrder:this.rowOrder,aggregator:this.aggregator.fun(t),aggregatorName:this.aggregator.name,renderer:this.renderer.fun,rendererName:this.renderer.name,vals:t})}}},_n={class:"pivot-ui"},In={class:"row"},Sn={class:"row"},Vn={class:"row aggregator"},kn={class:"row"};function Ln(t,e,s,l,i,n){const r=p("multiselect"),a=p("pivot-sort-btn");return d(),u("div",_n,[o("div",{class:q({collapsed:i.collapsed})},[o("div",In,[e[12]||(e[12]=o("label",null,"Columns",-1)),h(r,{modelValue:i.cols,"onUpdate:modelValue":e[0]||(e[0]=c=>i.cols=c),class:"sqliteviz-select cols",options:n.colsToSelect,disabled:n.colsToSelect.length===0,multiple:!0,hideSelected:!0,closeOnSelect:!0,showLabels:!1,max:n.colsToSelect.length,openDirection:"bottom",placeholder:""},{maxElements:v(()=>e[9]||(e[9]=[o("span",{class:"no-results"},"No Results",-1)])),placeholder:v(()=>e[10]||(e[10]=[S("Choose columns")])),noResult:v(()=>e[11]||(e[11]=[o("span",{class:"no-results"},"No Results",-1)])),_:1},8,["modelValue","options","disabled","max"]),h(a,{modelValue:i.colOrder,"onUpdate:modelValue":e[1]||(e[1]=c=>i.colOrder=c),class:"sort-btn",direction:"col"},null,8,["modelValue"])]),o("div",Sn,[e[16]||(e[16]=o("label",null,"Rows",-1)),h(r,{modelValue:i.rows,"onUpdate:modelValue":e[2]||(e[2]=c=>i.rows=c),class:"sqliteviz-select rows",options:n.rowsToSelect,disabled:n.rowsToSelect.length===0,multiple:!0,hideSelected:!0,closeOnSelect:!0,showLabels:!1,max:n.rowsToSelect.length,optionHeight:29,openDirection:"bottom",placeholder:""},{maxElements:v(()=>e[13]||(e[13]=[o("span",{class:"no-results"},"No Results",-1)])),placeholder:v(()=>e[14]||(e[14]=[S("Choose rows")])),noResult:v(()=>e[15]||(e[15]=[o("span",{class:"no-results"},"No Results",-1)])),_:1},8,["modelValue","options","disabled","max"]),h(a,{modelValue:i.rowOrder,"onUpdate:modelValue":e[3]||(e[3]=c=>i.rowOrder=c),class:"sort-btn",direction:"row"},null,8,["modelValue"])]),o("div",Vn,[e[18]||(e[18]=o("label",null,"Aggregator",-1)),h(r,{modelValue:i.aggregator,"onUpdate:modelValue":e[4]||(e[4]=c=>i.aggregator=c),class:"sqliteviz-select short aggregator",options:n.aggregators,label:"name",trackBy:"name",closeOnSelect:!0,showLabels:!1,hideSelected:!0,optionHeight:29,openDirection:"bottom",placeholder:"Choose a function"},{noResult:v(()=>e[17]||(e[17]=[o("span",{class:"no-results"},"No Results",-1)])),_:1},8,["modelValue","options"]),y(h(r,{modelValue:i.val1,"onUpdate:modelValue":e[5]||(e[5]=c=>i.val1=c),class:"sqliteviz-select aggr-arg",options:s.keyNames,disabled:s.keyNames.length===0,closeOnSelect:!0,showLabels:!1,hideSelected:!0,optionHeight:29,openDirection:"bottom",placeholder:"Choose an argument"},null,8,["modelValue","options","disabled"]),[[_,n.valCount>0]]),y(h(r,{modelValue:i.val2,"onUpdate:modelValue":e[6]||(e[6]=c=>i.val2=c),class:"sqliteviz-select aggr-arg",options:s.keyNames,disabled:s.keyNames.length===0,closeOnSelect:!0,showLabels:!1,hideSelected:!0,optionHeight:29,openDirection:"bottom",placeholder:"Choose a second argument"},null,8,["modelValue","options","disabled"]),[[_,n.valCount>1]])]),o("div",kn,[e[20]||(e[20]=o("label",null,"View",-1)),h(r,{modelValue:i.renderer,"onUpdate:modelValue":e[7]||(e[7]=c=>i.renderer=c),class:"sqliteviz-select short renderer",options:n.renderers,label:"name",trackBy:"name",closeOnSelect:!0,allowEmpty:!1,showLabels:!1,hideSelected:!0,optionHeight:29,openDirection:"bottom",placeholder:"Choose a view"},{noResult:v(()=>e[19]||(e[19]=[o("span",{class:"no-results"},"No Results",-1)])),_:1},8,["modelValue","options"])])],2),o("span",{class:"switcher",onClick:e[8]||(e[8]=c=>i.collapsed=!i.collapsed)},b(i.collapsed?"Show pivot settings":"Hide pivot settings"),1)])}const Tn=f(yn,[["render",Ln],["__scopeId","data-v-5b3ec194"]]),xn={name:"Pivot",components:{PivotUi:Tn,Chart:qe},props:{dataSources:Object,initOptions:Object,importToPngEnabled:Boolean,importToSvgEnabled:Boolean},emits:["loadingImageCompleted","update","update:importToSvgEnabled","update:importToPngEnabled"],data(){var t,e;return{resizeObserver:null,pivotOptions:this.initOptions?{rows:this.initOptions.rows,cols:this.initOptions.cols,colOrder:this.initOptions.colOrder,rowOrder:this.initOptions.rowOrder,aggregatorName:this.initOptions.aggregatorName,aggregator:$.pivotUtilities.aggregators[this.initOptions.aggregatorName](this.initOptions.vals),vals:this.initOptions.vals,rendererName:this.initOptions.rendererName,renderer:$.pivotUtilities.renderers[this.initOptions.rendererName]}:{rows:[],cols:[],colOrder:"key_a_to_z",rowOrder:"key_a_to_z",aggregatorName:"Count",aggregator:$.pivotUtilities.aggregators.Count(),vals:[],rendererName:"Table",renderer:$.pivotUtilities.renderers.Table},customChartComponentProps:{initOptions:(e=(t=this.initOptions)==null?void 0:t.rendererOptions)==null?void 0:e.customChartOptions,forPivot:!0}}},computed:{columns(){return Object.keys(this.dataSources||{})},viewStandartChart(){return this.pivotOptions.rendererName in $.pivotUtilities.plotly_renderers},viewCustomChart(){return this.pivotOptions.rendererName==="Custom chart"}},watch:{dataSources(){this.show()},"pivotOptions.rendererName":{immediate:!0,handler(){this.$emit("update:importToPngEnabled",this.pivotOptions.rendererName!=="TSV Export"),this.$emit("update:importToSvgEnabled",this.viewStandartChart||this.viewCustomChart),M.send("viz_pivot.render",null,{type:this.pivotOptions.rendererName})}},pivotOptions(){this.show()}},mounted(){this.show(),this.resizeObserver=new ResizeObserver(this.handleResize),this.resizeObserver.observe(this.$refs.pivotOutput)},beforeUnmount(){this.resizeObserver.unobserve(this.$refs.pivotOutput)},methods:{handleResize(){this.viewStandartChart&&te.Plots.resize(this.$refs.pivotOutput.querySelector(".js-plotly-plot"))},show(){const t={...this.pivotOptions};this.viewStandartChart&&(t.rendererOptions={plotly:{autosize:!0,width:null,height:null},plotlyConfig:{displaylogo:!1,responsive:!0,modeBarButtonsToRemove:["toImage"]}}),this.viewCustomChart&&(t.rendererOptions={getCustomComponentsProps:()=>this.customChartComponentProps}),$(this.$refs.pivotOutput).pivot((function(e){const s=this.dataSources?this.dataSources[this.columns[0]].length:0;for(let l=1;l<=s;l++){const i={};this.columns.forEach(n=>{i[n]=this.dataSources[n][l-1]}),e(i)}}).bind(this),t),this.handleResize()},getOptionsForSave(){const t={...this.pivotOptions};if(this.viewCustomChart){const e=this.$refs.customChart;t.rendererOptions={customChartOptions:e.getOptionsForSave()}}return t},async saveAsPng(){if(this.viewCustomChart)this.$refs.customChart.saveAsPng();else{const t=this.viewStandartChart?await P.getImageDataUrl(this.$refs.pivotOutput,"png"):(await ae.getPivotCanvas(this.$refs.pivotOutput)).toDataURL("image/png");this.$emit("loadingImageCompleted"),k.downloadFromUrl(t,"pivot")}},async prepareCopy(){return this.viewCustomChart?await this.$refs.customChart.prepareCopy():this.viewStandartChart?await P.getImageDataUrl(this.$refs.pivotOutput,"png"):await ae.getPivotCanvas(this.$refs.pivotOutput)},async saveAsSvg(){if(this.viewCustomChart)this.$refs.customChart.saveAsSvg();else if(this.viewStandartChart){const t=await P.getImageDataUrl(this.$refs.pivotOutput,"svg");k.downloadFromUrl(t,"pivot")}},saveAsHtml(){if(this.viewCustomChart){this.$refs.customChart.saveAsHtml();return}if(this.viewStandartChart){const t=P.getChartData(this.$refs.pivotOutput);k.exportToFile(P.getHtml(t),"chart.html","text/html");return}k.exportToFile(ae.getPivotHtml(this.$refs.pivotOutput),"pivot.html","text/html")}}},qn={class:"pivot-container"},Mn={class:"warning pivot-warning"},$n={ref:"pivotOutput",class:"pivot-output"},Bn={ref:"customChartOutput",class:"custom-chart-output"};function Hn(t,e,s,l,i,n){const r=p("pivot-ui"),a=p("chart");return d(),u("div",qn,[y(o("div",Mn," There is no data to build a pivot. Run your SQL query and make sure the result is not empty. ",512),[[_,!s.dataSources]]),h(r,{modelValue:i.pivotOptions,"onUpdate:modelValue":e[0]||(e[0]=c=>i.pivotOptions=c),keyNames:n.columns,onUpdate:e[1]||(e[1]=c=>t.$emit("update"))},null,8,["modelValue","keyNames"]),o("div",$n,null,512),y(o("div",Bn,[h(a,je({ref:"customChart"},i.customChartComponentProps,{onUpdate:e[2]||(e[2]=c=>t.$emit("update")),onLoadingImageCompleted:e[3]||(e[3]=c=>t.$emit("loadingImageCompleted"))}),null,16)],512),[[_,n.viewCustomChart]])])}const On=f(xn,[["render",Hn],["__scopeId","data-v-30c04ec2"]]),En={name:"ChartIcon"},Nn={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none"};function Pn(t,e,s,l,i,n){return d(),u("svg",Nn,e[0]||(e[0]=[J(`<path fill-rule="evenodd" clip-rule="evenodd" d="M8.41943 16V10H10.4194V16H8.41943Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M2.41943 16L2.41943 10H4.41943V16H2.41943Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M11.4194 16V7H13.4194V16H11.4194Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.4194 16V8H16.4194V16H14.4194Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M7.41943 12V16H5.41943V12H7.41943Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M12.4332 1.80676L16.6265 6.00001L15.9194 6.70712L12.4055 3.19326L5.93169 9.1691L1.71436
        5.55424L2.36515 4.79499L5.90707 7.83092L12.4332 1.80676Z" fill="#A2B1C6"></path>`,6)]))}const Dn=f(En,[["render",Pn]]),zn={name:"PivotIcon"},Rn={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none"};function An(t,e,s,l,i,n){return d(),u("svg",Rn,e[0]||(e[0]=[o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:`M15.7661 5.13901L18.3407 9.43008H16.5161V12.8467C16.5161 13.7957 16.2783 14.6451 15.6714
      15.2521C15.0645 15.859 14.215 16.0967 13.2661 16.0967H9.84942V17.9214L5.55835
      15.3467L9.84942 12.7721V14.5967H13.2661C13.9838 14.5967 14.3844 14.4178 14.6108
      14.1914C14.8372 13.965 15.0161 13.5645 15.0161 12.8467V9.43008H13.1914L15.7661 5.13901Z`,fill:"#A2B1C6"},null,-1),o("path",{d:"M6.41943 0H18.4194V4H6.41943V0Z",fill:"#A2B1C6"},null,-1),o("path",{d:"M0.419434 6H4.41943V18H0.419434V6Z",fill:"#A2B1C6"},null,-1),o("path",{d:"M0.419434 0H4.41943V4H0.419434V0Z",fill:"#A2B1C6"},null,-1)]))}const Fn=f(zn,[["render",An]]),Zn={name:"HtmlIcon"},Un={width:"19",height:"18",viewBox:"0 0 19 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Jn(t,e,s,l,i,n){return d(),u("svg",Un,e[0]||(e[0]=[J(`<path d="M5.1626 10.0745L7.56641 10.8831V12.2322L3.68164 10.6501V9.4812L7.56641
        7.89917V9.2439L5.1626 10.0745ZM8.99023 13.3H7.93994L10.124 6.35229H11.1787L8.99023
        13.3ZM14.1099 10.0613L11.7192 9.24829V7.90356L15.582 9.4856V10.6545L11.7192
        12.2366V10.8918L14.1099 10.0613Z" fill="#A2B1C6"></path><path d="M2.17041 0.0637207H16.2185V1.56372H2.17041V9.30354H0.67041V1.56372C0.67041 0.73872
      1.34541 0.0637207 2.17041 0.0637207Z" fill="#A2B1C6"></path><path d="M17.1704 0.0637207H15.3052V1.56372H17.1704V9.84163H18.6704V1.56372C18.6704 0.73872
      17.9954 0.0637207 17.1704 0.0637207Z" fill="#A2B1C6"></path><path d="M2.17041 17.1098H15.8754V15.6098H2.17041V8.78486H0.67041V15.6098C0.67041 16.4348
      1.34541 17.1098 2.17041 17.1098Z" fill="#A2B1C6"></path><path d="M17.1704 17.1098H15.3052V15.6098H17.1704V8.55939H18.6704V15.6098C18.6704 16.4348
      17.9954 17.1098 17.1704 17.1098Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M18.1197 4.13787H1.76172V3.03787H18.1197V4.13787Z" fill="#A2B1C6"></path>`,6)]))}const jn=f(Zn,[["render",Jn]]),Wn={name:"ExportToSvgIcon"},Gn={width:"19",height:"18",viewBox:"0 0 19 18",fill:"none"};function Kn(t,e,s,l,i,n){return d(),u("svg",Gn,e[0]||(e[0]=[o("path",{d:`M4.28369 13.9966C4.28369 13.7711 4.20312 13.5953 4.04199 13.4693C3.88379 13.3433 3.604
        13.213 3.20264 13.0782C2.80127 12.9434 2.47314 12.813 2.21826 12.6871C1.38916 12.2798
        0.974609 11.7203 0.974609 11.0084C0.974609 10.6539 1.07715 10.3419 1.28223
        10.0723C1.49023 9.79987 1.7832 9.58893 2.16113 9.43951C2.53906 9.28717 2.96387 9.211
        3.43555 9.211C3.89551 9.211 4.30713 9.29303 4.67041 9.45709C5.03662 9.62115 5.3208
        9.85553 5.52295 10.1602C5.7251 10.462 5.82617 10.8077 5.82617 11.1973H4.28809C4.28809
        10.9366 4.20752 10.7344 4.04639 10.5909C3.88818 10.4473 3.67285 10.3755 3.40039
        10.3755C3.125 10.3755 2.90674 10.4371 2.74561 10.5601C2.5874 10.6802 2.5083 10.834
        2.5083 11.0215C2.5083 11.1856 2.59619 11.335 2.77197 11.4698C2.94775 11.6016 3.25684
        11.7393 3.69922 11.8829C4.1416 12.0235 4.50488 12.1758 4.78906 12.3399C5.48047 12.7383
        5.82617 13.2877 5.82617 13.9879C5.82617 14.5474 5.61523 14.9869 5.19336 15.3062C4.77148
        15.6255 4.19287 15.7852 3.45752 15.7852C2.93896 15.7852 2.46875 15.6929 2.04688
        15.5084C1.62793 15.3209 1.31152 15.066 1.09766 14.7437C0.886719 14.4185 0.78125 14.045
        0.78125 13.6231H2.32812C2.32812 13.9659 2.41602 14.2193 2.5918 14.3834C2.77051 14.5445
        3.05908 14.6251 3.45752 14.6251C3.7124 14.6251 3.91309 14.5709 4.05957 14.4625C4.20898
        14.3511 4.28369 14.1959 4.28369 13.9966ZM9.1001 13.9571L10.3745 9.29889H12.0972L9.94385
        15.6973H8.25635L6.12061 9.29889H7.83008L9.1001 13.9571ZM17.7441 14.9063C17.5068 15.17
        17.1597 15.3824 16.7026 15.5435C16.2456 15.7047 15.7446 15.7852 15.1997 15.7852C14.3618
        15.7852 13.6924 15.5289 13.1914 15.0162C12.6904 14.5035 12.4224 13.7901 12.3872
        12.876L12.3828 12.3223C12.3828 11.6924 12.4941 11.1431 12.7168 10.6744C12.9395 10.2027
        13.2573 9.84088 13.6704 9.58893C14.0864 9.33405 14.5669 9.2066 15.1118 9.2066C15.9087
        9.2066 16.5269 9.38971 16.9663 9.75592C17.4087 10.1192 17.6665 10.6627 17.7397
        11.3863H16.2544C16.2017 11.0289 16.0874 10.774 15.9116 10.6216C15.7358 10.4693 15.4868
        10.3931 15.1646 10.3931C14.7778 10.3931 14.479 10.5572 14.2681 10.8853C14.0571 11.2134
        13.9502 11.6822 13.9473 12.2916V12.6783C13.9473 13.317 14.0557 13.7974 14.2725
        14.1197C14.4922 14.439 14.8364 14.5987 15.3052 14.5987C15.7065 14.5987 16.0054 14.5093
        16.2017 14.3306V13.3375H15.1294V12.2784H17.7441V14.9063Z`,fill:"#A2B1C6"},null,-1),o("path",{d:`M2.86768 0.991333H4.73292V2.49133H2.86768V7.93074H1.36768V2.49133C1.36768 1.66633
        2.04268 0.991333 2.86768 0.991333Z`,fill:"#A2B1C6"},null,-1),o("path",{d:`M15.7512 0.991333H13.886V2.49133H15.7512V7.93074H17.2512V2.49133C17.2512 1.66633 16.5762
        0.991333 15.7512 0.991333Z`,fill:"#A2B1C6"},null,-1),o("path",{d:`M9.36466 -1.76931e-05L13.0541 3.83972L10.8272 3.79527L10.7679 6.76452L7.79865
        6.70526L7.85791 3.736L5.52492 3.68944L9.36466 -1.76931e-05Z`,fill:"#A2B1C6"},null,-1)]))}const Qn=f(Wn,[["render",Kn]]),Yn={name:"PngIcon"},Xn={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none"};function eo(t,e,s,l,i,n){return d(),u("svg",Xn,e[0]||(e[0]=[o("path",{d:`M9 5.51953C6.57686 5.51953 4.60547 7.49092 4.60547 9.91406C4.60547 12.3372 6.57686
        14.3086 9 14.3086C11.4231 14.3086 13.3945 12.3372 13.3945 9.91406C13.3945 7.49092 11.4231
        5.51953 9 5.51953ZM9 12.9023C7.35226 12.9023 6.01172 11.5618 6.01172 9.91406C6.01172
        8.26632 7.35226 6.92578 9 6.92578C10.6477 6.92578 11.9883 8.26632 11.9883
        9.91406C11.9883 11.5618 10.6477 12.9023 9 12.9023Z`,fill:"#A2B1C6"},null,-1),o("path",{d:`M15.8906 3.41016H13.304C13.2221 3.41016 13.1483 3.36547 13.1104 3.29319L12.3948
        1.78945C12.3928 1.78534 12.3908 1.78126 12.3887 1.77718C12.1117 1.22312 11.5548 0.878906
        10.9353 0.878906H7.11478C6.49529 0.878906 5.93835 1.22312 5.66135 1.77722C5.65928 1.7813
        5.65731 1.78538 5.65534 1.78949L4.9397 3.2933C4.90173 3.36547 4.82797 3.41016 4.74609
        3.41016H2.10938C0.946266 3.41016 0 4.35642 0 5.51953V15.0117C0 16.1748 0.946266 17.1211
        2.10938 17.1211H15.8906C17.0537 17.1211 18 16.1748 18 15.0117V5.51953C18 4.35642 17.0537
        3.41016 15.8906 3.41016ZM16.5938 15.0117C16.5938 15.3994 16.2783 15.7148 15.8906
        15.7148H2.10938C1.72167 15.7148 1.40625 15.3994 1.40625 15.0117V5.51953C1.40625 5.13183
        1.72167 4.81641 2.10938 4.81641H4.74609C5.36555 4.81641 5.92249 4.47223 6.19952
        3.91816C6.2016 3.91409 6.20357 3.90997 6.20557 3.90586L6.92121 2.40205C6.95914 2.32984
        7.0329 2.28516 7.11478 2.28516H10.9353C11.0172 2.28516 11.091 2.32984 11.1289
        2.40202L11.8445 3.90582C11.8465 3.90994 11.8485 3.91405 11.8506 3.91813C12.1276 4.47219
        12.6846 4.81637 13.304 4.81637H15.8906C16.2783 4.81637 16.5938 5.13179 16.5938
        5.5195V15.0117Z`,fill:"#A2B1C6"},null,-1),o("path",{d:"M15.1875 6.22266H13.7812V7.62891H15.1875V6.22266Z",fill:"#A2B1C6"},null,-1)]))}const to=f(Yn,[["render",eo]]),so={name:"ClipboardIcon"},io={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none"};function no(t,e,s,l,i,n){return d(),u("svg",io,e[0]||(e[0]=[o("path",{d:`M14.1917 1.3851H12.4806V0.703125C12.4806 0.314758 12.1658 0 11.7775 0H6.246C5.85764 0
      5.54288 0.314758 5.54288 0.703125V1.3851H3.83203C2.86276 1.3851 2.07422 2.17365 2.07422
      3.14291V16.2422C2.07422 17.2115 2.86276 18 3.83203 18H14.1917C15.161 18 15.9495 17.2115
      15.9495 16.2422V3.14291C15.9495 2.17365 15.1609 1.3851 14.1917 1.3851V1.3851ZM11.0744
      1.40625V2.77034H6.94899C6.94899 2.30301 6.94899 1.91698 6.94899 1.40625H11.0744ZM14.5433
      16.2422C14.5433 16.4361 14.3855 16.5938 14.1917 16.5938H3.83203C3.63812 16.5938 3.48047
      16.4361 3.48047 16.2422V3.14291C3.48047 2.94914 3.63812 2.79135 3.83203
      2.79135H5.54274V3.47346C5.54274 3.86183 5.85764 4.17659 6.24586 4.17659H11.7775C12.1657
      4.17659 12.4806 3.86183 12.4806 3.47346V2.79135H14.1917C14.3855 2.79135 14.5433 2.94914
      14.5433 3.14291V16.2422ZM12.2745 8.20967C12.5491 8.48433 12.5491 8.92955 12.2745
      9.20407L8.5795 12.899C8.30498 13.1737 7.85976 13.1737 7.5851 12.899L5.74887
      11.0628C5.47435 10.7883 5.47435 10.3431 5.74887 10.0684C6.02353 9.7939 6.46861 9.7939
      6.74327 10.0684L8.08237 11.4075L11.2801 8.20981C11.5547 7.93515 11.9998 7.93515 12.2745
      8.20967V8.20967Z`,fill:"#A2B1C6"},null,-1)]))}const Me=f(so,[["render",no]]),ge={async copyText(t,e){await navigator.clipboard.writeText(t),e&&le.notifier(e,"long")},async copyImage(t){return t instanceof HTMLCanvasElement?this._copyCanvas(t):this._copyFromDataUrl(t)},async _copyBlob(t){await navigator.clipboard.write([new ClipboardItem({[t.type]:t})])},async _copyFromDataUrl(t){const e=We(t);await this._copyBlob(e),le.notifier("Image copied to clipboard successfully","long")},async _copyCanvas(t){t.toBlob(async e=>{await this._copyBlob(e),le.notifier("Image copied to clipboard successfully","long")},"image/png",1)}},oo={name:"LoadingDialog",components:{LoadingIndicator:j,CloseIcon:Z},props:{loadingMsg:String,successMsg:String,actionBtnName:String,name:String,title:String,loading:Boolean},emits:["cancel","action"],watch:{loading(){this.loading&&this.$modal.show(this.name)}},methods:{cancel(){this.$emit("cancel")}}},lo={class:"dialog-header"},ro={class:"dialog-body"},ao={key:0,class:"loading-dialog-body"},co={key:1,class:"loading-dialog-body"},uo={class:"dialog-buttons-container"},ho=["disabled"],po=["disabled"];function mo(t,e,s,l,i,n){const r=p("close-icon"),a=p("loading-indicator"),c=p("modal");return d(),T(c,{modalId:s.name,class:"dialog",clickToClose:!1,contentTransition:{name:"loading-dialog"},overlayTransition:{name:"loading-dialog"}},{default:v(()=>[o("div",lo,[S(b(s.title)+" ",1),h(r,{disabled:s.loading,onClick:e[0]||(e[0]=g=>t.$emit("cancel"))},null,8,["disabled"])]),o("div",ro,[s.loading?(d(),u("div",ao,[h(a,{size:30,class:"state-icon"}),S(" "+b(s.loadingMsg),1)])):(d(),u("div",co,[e[3]||(e[3]=o("img",{src:Se,class:"success-icon state-icon"},null,-1)),S(" "+b(s.successMsg),1)]))]),o("div",uo,[o("button",{class:"secondary",type:"button",disabled:s.loading,onClick:e[1]||(e[1]=g=>t.$emit("cancel"))}," Cancel ",8,ho),o("button",{class:"primary",type:"button",disabled:s.loading,onClick:e[2]||(e[2]=g=>t.$emit("action"))},b(s.actionBtnName),9,po)])]),_:1},8,["modalId"])}const $e=f(oo,[["render",mo],["__scopeId","data-v-2acabd1d"]]),fo={name:"DataView",components:{Chart:qe,Pivot:On,SideToolBar:fe,IconButton:W,ChartIcon:Dn,PivotIcon:Fn,ExportToSvgIcon:Qn,PngIcon:to,HtmlIcon:jn,ClipboardIcon:Me,loadingDialog:$e},props:{dataSource:Object,initOptions:Object,initMode:String},emits:["update","switchTo"],data(){return{mode:this.initMode||"chart",importToPngEnabled:!0,importToSvgEnabled:!0,loadingImage:!1,copyingImage:!1,preparingCopy:!1,dataToCopy:null}},computed:{plotlyInPivot(){return this.mode==="pivot"&&this.$refs.viewComponent.viewCustomChart}},watch:{mode(){this.$emit("update"),this.importToPngEnabled=!0}},methods:{async saveAsPng(){this.loadingImage=!0,await D.sleep(0),this.$refs.viewComponent.saveAsPng(),this.exportSignal("png")},getOptionsForSave(){return this.$refs.viewComponent.getOptionsForSave()},async prepareCopy(){if("ClipboardItem"in window){this.preparingCopy=!0,this.$modal.show("prepareCopy");const t=performance.now();await D.sleep(0),this.dataToCopy=await this.$refs.viewComponent.prepareCopy(),performance.now()-t<950?(this.$modal.hide("prepareCopy"),this.copyToClipboard()):this.preparingCopy=!1}else alert("Your browser doesn't support copying images into the clipboard. If you use Firefox you can enable it by setting dom.events.asyncClipboard.clipboardItem to true.")},async copyToClipboard(){ge.copyImage(this.dataToCopy),this.$modal.hide("prepareCopy"),this.exportSignal("clipboard")},cancelCopy(){this.dataToCopy=null,this.$modal.hide("prepareCopy")},saveAsSvg(){this.$refs.viewComponent.saveAsSvg(),this.exportSignal("svg")},saveAsHtml(){this.$refs.viewComponent.saveAsHtml(),this.exportSignal("html")},exportSignal(t){const e={type:t};(this.mode==="chart"||this.plotlyInPivot)&&(e.pivot=this.plotlyInPivot),M.send(this.mode==="chart"||this.plotlyInPivot?"viz_plotly.export":"viz_pivot.export",null,e)}}},go={class:"data-view-panel"},Co={class:"data-view-panel-content"};function vo(t,e,s,l,i,n){const r=p("chart-icon"),a=p("icon-button"),c=p("pivot-icon"),g=p("png-icon"),m=p("export-to-svg-icon"),V=p("HtmlIcon"),x=p("clipboard-icon"),w=p("side-tool-bar"),E=p("loading-dialog");return d(),u("div",go,[o("div",Co,[(d(),T(he(i.mode),{ref:"viewComponent",importToPngEnabled:i.importToPngEnabled,"onUpdate:importToPngEnabled":e[0]||(e[0]=C=>i.importToPngEnabled=C),importToSvgEnabled:i.importToSvgEnabled,"onUpdate:importToSvgEnabled":e[1]||(e[1]=C=>i.importToSvgEnabled=C),initOptions:i.mode===s.initMode?s.initOptions:void 0,"data-sources":s.dataSource,onLoadingImageCompleted:e[2]||(e[2]=C=>i.loadingImage=!1),onUpdate:e[3]||(e[3]=C=>t.$emit("update"))},null,40,["importToPngEnabled","importToSvgEnabled","initOptions","data-sources"]))]),h(w,{panel:"dataView",onSwitchTo:e[6]||(e[6]=C=>t.$emit("switchTo",C))},{default:v(()=>[h(a,{active:i.mode==="chart",tooltip:"Switch to chart",tooltipPosition:"top-left",onClick:e[4]||(e[4]=C=>i.mode="chart")},{default:v(()=>[h(r)]),_:1},8,["active"]),h(a,{ref:"pivotBtn",active:i.mode==="pivot",tooltip:"Switch to pivot",tooltipPosition:"top-left",onClick:e[5]||(e[5]=C=>i.mode="pivot")},{default:v(()=>[h(c)]),_:1},8,["active"]),e[7]||(e[7]=o("div",{class:"side-tool-bar-divider"},null,-1)),h(a,{disabled:!i.importToPngEnabled||i.loadingImage,loading:i.loadingImage,tooltip:"Save as PNG image",tooltipPosition:"top-left",onClick:n.saveAsPng},{default:v(()=>[h(g)]),_:1},8,["disabled","loading","onClick"]),h(a,{ref:"svgExportBtn",disabled:!i.importToSvgEnabled,tooltip:"Save as SVG",tooltipPosition:"top-left",onClick:n.saveAsSvg},{default:v(()=>[h(m)]),_:1},8,["disabled","onClick"]),h(a,{ref:"htmlExportBtn",tooltip:"Save as HTML",tooltipPosition:"top-left",onClick:n.saveAsHtml},{default:v(()=>[h(V)]),_:1},8,["onClick"]),h(a,{ref:"copyToClipboardBtn",loading:i.copyingImage,tooltip:"Copy visualisation to clipboard",tooltipPosition:"top-left",onClick:n.prepareCopy},{default:v(()=>[h(x)]),_:1},8,["loading","onClick"])]),_:1}),h(E,{loadingMsg:"Rendering the visualisation...",successMsg:"Image is ready",actionBtnName:"Copy",name:"prepareCopy",title:"Copy to clipboard",loading:i.preparingCopy,onAction:n.copyToClipboard,onCancel:n.cancelCopy},null,8,["loading","onAction","onCancel"])])}const bo=f(fo,[["render",vo],["__scopeId","data-v-156d47fd"]]),wo={name:"ExportToCsvIcon"},yo={width:"19",height:"18",viewBox:"0 0 19 18",fill:"none"};function _o(t,e,s,l,i,n){return d(),u("svg",yo,e[0]||(e[0]=[o("path",{d:`M6.07959 13.5756C6.05908 14.0209 5.93896 14.415 5.71924 14.7578C5.49951 15.0976 5.19043
        15.3613 4.79199 15.5488C4.39648 15.7363 3.94385 15.83 3.43408 15.83C2.59326 15.83
        1.93115 15.5561 1.44775 15.0082C0.964355 14.4604 0.722656 13.687 0.722656
        12.6879V12.3715C0.722656 11.7446 0.831055 11.1967 1.04785 10.728C1.26758 10.2563 1.58252
        9.89301 1.99268 9.63812C2.40283 9.38031 2.87744 9.2514 3.4165 9.2514C4.19287 9.2514
        4.81689 9.45648 5.28857 9.86664C5.76025 10.2739 6.02832 10.8364 6.09277
        11.5541H4.55469C4.54297 11.1645 4.44482 10.8847 4.26025 10.7148C4.07568 10.5449 3.79443
        10.4599 3.4165 10.4599C3.03271 10.4599 2.75146 10.6035 2.57275 10.8906C2.39404 11.1777
        2.30029 11.6362 2.2915 12.2661V12.7187C2.2915 13.4013 2.37646 13.8891 2.54639
        14.1821C2.71924 14.475 3.01514 14.6215 3.43408 14.6215C3.78857 14.6215 4.05957 14.538
        4.24707 14.371C4.43457 14.204 4.53418 13.9389 4.5459 13.5756H6.07959ZM10.1094
        14.0414C10.1094 13.8159 10.0288 13.6401 9.86768 13.5141C9.70947 13.3881 9.42969 13.2578
        9.02832 13.123C8.62695 12.9882 8.29883 12.8578 8.04395 12.7319C7.21484 12.3246 6.80029
        11.7651 6.80029 11.0532C6.80029 10.6987 6.90283 10.3867 7.10791 10.1171C7.31592 9.84467
        7.60889 9.63373 7.98682 9.48431C8.36475 9.33197 8.78955 9.2558 9.26123 9.2558C9.72119
        9.2558 10.1328 9.33783 10.4961 9.50189C10.8623 9.66595 11.1465 9.90033 11.3486
        10.205C11.5508 10.5068 11.6519 10.8525 11.6519 11.2421H10.1138C10.1138 10.9814 10.0332
        10.7792 9.87207 10.6357C9.71387 10.4921 9.49854 10.4203 9.22607 10.4203C8.95068 10.4203
        8.73242 10.4819 8.57129 10.6049C8.41309 10.725 8.33398 10.8788 8.33398 11.0663C8.33398
        11.2304 8.42188 11.3798 8.59766 11.5146C8.77344 11.6464 9.08252 11.7841 9.5249
        11.9277C9.96729 12.0683 10.3306 12.2206 10.6147 12.3847C11.3062 12.7831 11.6519 13.3325
        11.6519 14.0327C11.6519 14.5922 11.4409 15.0317 11.019 15.351C10.5972 15.6703 10.0186
        15.83 9.2832 15.83C8.76465 15.83 8.29443 15.7377 7.87256 15.5532C7.45361 15.3657 7.13721
        15.1108 6.92334 14.7885C6.7124 14.4633 6.60693 14.0898 6.60693 13.6679H8.15381C8.15381
        14.0107 8.2417 14.2641 8.41748 14.4282C8.59619 14.5893 8.88477 14.6699 9.2832
        14.6699C9.53809 14.6699 9.73877 14.6157 9.88525 14.5073C10.0347 14.3959 10.1094 14.2407
        10.1094 14.0414ZM14.9258 14.0019L16.2002 9.34369H17.9229L15.7695 15.7421H14.082L11.9463
        9.34369H13.6558L14.9258 14.0019Z`,fill:"#A2B1C6"},null,-1),o("path",{d:`M3.03345 0.991333H4.89869V2.49133H3.03345V7.93074H1.53345V2.49133C1.53345 1.66633
        2.20845 0.991333 3.03345 0.991333Z`,fill:"#A2B1C6"},null,-1),o("path",{d:`M15.917 0.991333H14.0517V2.49133H15.917V7.93074H17.417V2.49133C17.417 1.66633 16.742
      0.991333 15.917 0.991333Z`,fill:"#A2B1C6"},null,-1),o("path",{d:`M9.53043 1.28245e-05L13.2199 3.83975L10.9929 3.7953L10.9337 6.76455L7.96442
      6.70529L8.02368 3.73603L5.6907 3.68947L9.53043 1.28245e-05Z`,fill:"#A2B1C6"},null,-1)]))}const Io=f(wo,[["render",_o]]),So={name:"ViewCellValueIcon"},Vo={width:"19",height:"19",viewBox:"0 0 19 19",fill:"none"};function ko(t,e,s,l,i,n){return d(),u("svg",Vo,e[0]||(e[0]=[J(`<g clip-path="url(#clip0_2131_6054)"><path d="M3.53784 11.5846L3.53784 3.14734L11.9751 3.14734V7.676C12.4655 7.51991
      12.9771 7.47439 13.4751 7.53264V3.14734C13.4751 2.31891 12.8035 1.64734
      11.9751 1.64734L3.53784 1.64734C2.70941 1.64734 2.03784 2.31891 2.03784
      3.14734L2.03784 11.5846C2.03784 12.413 2.70942 13.0846 3.53784
      13.0846H10.0831C9.771 12.6184 9.58279 12.1055 9.51083
      11.5846H3.53784Z" fill="#A2B1C6"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.7887 9.9291C15.4307 10.8837 15.1773 12.1779 14.2228
      12.8199C13.2682 13.4618 11.974 13.2084 11.332 12.2539C10.69 11.2993
      10.9434 10.0051 11.898 9.3631C12.8525 8.72113 14.1468 8.97454 14.7887
      9.9291ZM14.4606 14.3901L16.6181 17.5982C16.8492 17.9419 17.3153 18.0331
      17.659 17.802C18.0027 17.5708 18.0939 17.1048 17.8628 16.7611L15.6884
      13.5279C16.7949 12.3365 16.9801 10.4996 16.0334 9.092C14.9292 7.45002
      12.7029 7.01412 11.0609 8.1184C9.41891 9.22268 8.98302 11.449 10.0873
      13.0909C11.062 14.5403 12.9109 15.05 14.4606 14.3901Z" fill="#A2B1C6"></path></g><defs><clipPath id="clip0_2131_6054"><rect width="18" height="18" fill="white" transform="translate(0.5 18.5916) rotate(-90)"></rect></clipPath></defs>`,2)]))}const Lo=f(So,[["render",ko]]),To={name:"RowIcon"},xo={width:"19",height:"19",viewBox:"0 0 19 19",fill:"none"};function qo(t,e,s,l,i,n){return d(),u("svg",xo,e[0]||(e[0]=[o("g",{"clip-path":"url(#clip0_2130_5292)"},[o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:`M1.85303 11.3794L1.85303 7.80371L5.86304 7.80371L5.86304
      11.3794L1.85303 11.3794ZM7.36304 11.3794L7.36304 7.80371L11.3428
      7.80371L11.3428 11.3794L7.36304 11.3794ZM12.8428 11.3794L16.853
      11.3794L16.853 7.80371L12.8428 7.80371L12.8428 11.3794ZM15.353
      6.30371L16.853 6.30371C17.6815 6.30371 18.353 6.97528 18.353
      7.80371L18.353 11.3794C18.353 12.2078 17.6815 12.8794 16.853
      12.8794L15.353 12.8794L15.353 14.3111C15.353 15.0153 14.7603 15.5916
      14.0358 15.5916L4.67027 15.5916C3.94579 15.5916 3.35303 15.0153 3.35303
      14.3111L3.35303 12.8794L1.85303 12.8794C1.0246 12.8794 0.353027 12.2078
      0.353027 11.3794L0.353027 7.80371C0.353027 6.97528 1.0246 6.30371
      1.85303 6.30371L3.35303 6.30371L3.35303 4.87201C3.35303 4.16349 3.94139
      3.59155 4.67027 3.59155L14.0358 3.59155C14.7604 3.59155 15.353 4.16117
      15.353 4.87201L15.353 6.30371ZM14.0315 6.30371L14.0315 4.87086L11.887
      4.87086L11.887 6.30371L12.8428 6.30371L14.0315 6.30371ZM10.387
      6.30371L10.387 4.87086L8.26685 4.87086L8.26685 6.30371L10.387
      6.30371ZM6.76685 6.30371L6.76685 4.87086L4.67027 4.87086L4.67027
      6.30371L6.76685 6.30371ZM4.67027 12.8794L4.67027 14.3121L6.76685
      14.3121L6.76685 12.8794L4.67027 12.8794ZM8.26685 12.8794L8.26685
      14.3121L10.387 14.3121L10.387 12.8794L8.26685 12.8794ZM11.887
      12.8794L11.887 14.3121L14.0315 14.3121L14.0315 12.8794L11.887 12.8794Z`,fill:"#A2B1C6"})],-1),o("defs",null,[o("clipPath",{id:"clip0_2130_5292"},[o("rect",{width:"18",height:"18",fill:"white",transform:"translate(0.353027 18.5916) rotate(-90)"})])],-1)]))}const Mo=f(To,[["render",qo]]),$o={components:{Codemirror:we,Logs:oe},props:{cellValue:[String,Number,Uint8Array]},data(){return{formats:[{text:"Text",value:"text"},{text:"JSON",value:"json"}],currentFormat:"text",lineWrapping:!1,formattedJson:"",messages:[]}},computed:{cmOptions(){return{tabSize:4,mode:{name:"javascript",json:!0},theme:"neo",lineNumbers:!0,line:!0,lineWrapping:this.lineWrapping,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],readOnly:!0}},isBlob(){return this.cellValue&&ArrayBuffer.isView(this.cellValue)},isNull(){return this.cellValue===null},cellText(){const t=this.cellValue;return this.isNull?"NULL":this.isBlob?"BLOB":t}},watch:{currentFormat(){this.messages=[],this.formattedJson="",this.currentFormat==="json"&&this.formatJson(this.cellValue)},cellValue(){this.messages=[],this.currentFormat==="json"&&this.formatJson(this.cellValue)}},methods:{formatJson(t){try{this.formattedJson=JSON.stringify(JSON.parse(t),null,4)}catch{this.formattedJson="",this.messages=[{type:"error",message:"Can't parse JSON."}]}},copyToClipboard(){ge.copyText(this.currentFormat==="json"?this.formattedJson:this.cellValue,"The value is copied to clipboard.")}}},Bo={class:"value-viewer"},Ho={class:"value-viewer-toolbar"},Oo=["aria-selected","onClick"],Eo=["aria-selected"],No={class:"value-body"};function Po(t,e,s,l,i,n){const r=p("codemirror"),a=p("logs");return d(),u("div",Bo,[o("div",Ho,[(d(!0),u(B,null,H(i.formats,c=>(d(),u("button",{key:c.value,type:"button","aria-selected":i.currentFormat===c.value,class:q(c.value),onClick:g=>i.currentFormat=c.value},b(c.text),11,Oo))),128)),o("button",{type:"button",class:"copy",onClick:e[0]||(e[0]=(...c)=>n.copyToClipboard&&n.copyToClipboard(...c))},"Copy"),o("button",{type:"button",class:"line-wrap","aria-selected":i.lineWrapping===!0,onClick:e[1]||(e[1]=c=>i.lineWrapping=!i.lineWrapping)}," Line wrap ",8,Eo)]),o("div",No,[i.currentFormat==="json"&&i.formattedJson?(d(),T(r,{key:0,value:i.formattedJson,options:n.cmOptions,class:"json-value original-style"},null,8,["value","options"])):I("",!0),i.currentFormat==="text"?(d(),u("pre",{key:1,class:q(["text-value",{"meta-value":n.isNull||n.isBlob},{"line-wrap":i.lineWrapping}])},b(n.cellText),3)):I("",!0),i.messages&&i.messages.length>0?(d(),T(a,{key:2,messages:i.messages,class:"messages"},null,8,["messages"])):I("",!0)])])}const Do=f($o,[["render",Po],["__scopeId","data-v-daf48bfa"]]),zo={},Ro={width:"28",height:"27",viewBox:"0 0 28 27",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Ao(t,e,s,l,i,n){return d(),u("svg",Ro,e[0]||(e[0]=[o("path",{d:`M17.9475 8.33625L12.7838 13.5L17.9475 18.6638L16.35 20.25L9.60001
      13.5L16.35 6.75L17.9475 8.33625Z`,fill:"#506784"},null,-1)]))}const Fo=f(zo,[["render",Ao]]),Zo={},Uo={width:"27",height:"27",viewBox:"0 0 27 27",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Jo(t,e,s,l,i,n){return d(),u("svg",Uo,e[0]||(e[0]=[o("path",{d:`M17.3474 8.33625L12.1837 13.5L17.3474 18.6638L15.7499 20.25L8.99991
      13.5L15.7499 6.75L17.3474 8.33625Z`,fill:"#506784"},null,-1),o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.19995 19.8L7.19995 7.20001H9.19995V19.8H7.19995Z",fill:"#506784"},null,-1)]))}const jo=f(Zo,[["render",Jo]]),Wo={components:{IconButton:W,ArrowIcon:Fo,EdgeArrowIcon:jo},props:{modelValue:Number,total:Number},emits:["update:modelValue"]},Go={class:"record-navigator"};function Ko(t,e,s,l,i,n){const r=p("edge-arrow-icon"),a=p("icon-button"),c=p("arrow-icon");return d(),u("div",Go,[h(a,{disabled:s.modelValue===0,tooltip:"First row",tooltipPosition:"top-left",class:"first",onClick:e[0]||(e[0]=g=>t.$emit("update:modelValue",0))},{default:v(()=>[h(r,{disabled:!1})]),_:1},8,["disabled"]),h(a,{disabled:s.modelValue===0,tooltip:"Previous row",tooltipPosition:"top-left",class:"prev",onClick:e[1]||(e[1]=g=>t.$emit("update:modelValue",s.modelValue-1))},{default:v(()=>[h(c,{disabled:!1})]),_:1},8,["disabled"]),h(a,{disabled:s.modelValue===s.total-1,tooltip:"Next row",tooltipPosition:"top-left",class:"next",onClick:e[2]||(e[2]=g=>t.$emit("update:modelValue",s.modelValue+1))},{default:v(()=>[h(c,{disabled:!1})]),_:1},8,["disabled"]),h(a,{disabled:s.modelValue===s.total-1,tooltip:"Last row",tooltipPosition:"top-left",class:"last",onClick:e[3]||(e[3]=g=>t.$emit("update:modelValue",s.total-1))},{default:v(()=>[h(r,{disabled:!1})]),_:1},8,["disabled"])])}const Qo=f(Wo,[["render",Ko],["__scopeId","data-v-40ea32b6"]]),Yo={components:{RowNavigator:Qo},props:{dataSet:Object,time:String,rowIndex:{type:Number,default:0},selectedColumnIndex:Number},emits:["updateSelectedCell"],data(){return{selectedCellElement:null,currentRowIndex:this.rowIndex}},computed:{columns(){return this.dataSet.columns},rowCount(){return this.dataSet.values[this.columns[0]].length}},watch:{async currentRowIndex(){if(await ce(),this.selectedCellElement){const t=this.selectedCellElement;this.selectCell(null),this.selectCell(t)}}},mounted(){const t=this.selectedColumnIndex,e=this.currentRowIndex,s=this.$refs.table.querySelector(`td[data-col="${t}"][data-row="${e}"]`);s&&this.selectCell(s)},methods:{isBlob(t){return t&&ArrayBuffer.isView(t)},isNull(t){return t===null},getCellValue(t){return this.dataSet.values[t][this.currentRowIndex]},getCellText(t){const e=this.getCellValue(t);return this.isNull(e)?"NULL":this.isBlob(e)?"BLOB":e},onTableKeydown(t){const e={38:"up",40:"down"};!this.selectedCellElement||!Object.keys(e).includes(t.keyCode.toString())||(t.preventDefault(),this.moveFocusInTable(this.selectedCellElement,e[t.keyCode]))},onCellClick(t){this.selectCell(t.target.closest("td"),!1)},selectCell(t,e=!0){t?!t.ariaSelected||t.ariaSelected==="false"?(this.selectedCellElement&&(this.selectedCellElement.ariaSelected="false"),t.ariaSelected="true",this.selectedCellElement=t):(t.ariaSelected="false",this.selectedCellElement=null):(this.selectedCellElement&&(this.selectedCellElement.ariaSelected="false"),this.selectedCellElement=t),this.selectedCellElement&&e&&(this.selectedCellElement.scrollIntoView(),this.selectedCellElement.closest(".table-container").scrollTo({left:0})),this.$emit("updateSelectedCell",this.selectedCellElement)},moveFocusInTable(t,e){const s=+t.dataset.col,l=e==="up"?s-1:s+1,i=this.$refs.table.querySelector(`td[data-col="${l}"][data-row="${this.currentRowIndex}"]`);i&&this.selectCell(i)}}},Xo={class:"record-view"},e2={class:"table-container"},t2={class:"cell-data"},s2=["title"],i2=["data-col","data-row","data-isNull","data-isBlob"],n2={class:"cell-data"},o2={class:"table-footer"},l2={class:"table-footer-count"},r2={key:0};function a2(t,e,s,l,i,n){const r=p("row-navigator");return d(),u("div",Xo,[o("div",e2,[o("table",{ref:"table",class:"sqliteviz-table",tabindex:"0",onKeydown:e[1]||(e[1]=(...a)=>n.onTableKeydown&&n.onTableKeydown(...a))},[o("thead",null,[o("tr",null,[e[3]||(e[3]=o("th",null,null,-1)),o("th",null,[o("div",t2,"Row #"+b(i.currentRowIndex+1),1)])])]),o("tbody",null,[(d(!0),u(B,null,H(n.columns,(a,c)=>(d(),u("tr",{key:c},[o("th",{class:"column-cell",title:a},b(a),9,s2),(d(),u("td",{key:c,"data-col":c,"data-row":i.currentRowIndex,"data-isNull":n.isNull(n.getCellValue(a)),"data-isBlob":n.isBlob(n.getCellValue(a)),"aria-selected":!1,onClick:e[0]||(e[0]=(...g)=>n.onCellClick&&n.onCellClick(...g))},[o("div",n2,b(n.getCellText(a)),1)],8,i2))]))),128))])],544)]),o("div",o2,[o("div",l2,[S(b(n.rowCount)+" "+b(n.rowCount===1?"row":"rows")+" retrieved ",1),s.time?(d(),u("span",r2,"in "+b(s.time),1)):I("",!0)]),h(r,{modelValue:i.currentRowIndex,"onUpdate:modelValue":e[2]||(e[2]=a=>i.currentRowIndex=a),total:n.rowCount},null,8,["modelValue","total"])])])}const d2=f(Yo,[["render",a2],["__scopeId","data-v-33835863"]]),c2={name:"RunResult",components:{SqlTable:Ie,LoadingIndicator:j,Logs:oe,SideToolBar:fe,ExportToCsvIcon:Io,IconButton:W,ClipboardIcon:Me,ViewCellValueIcon:Lo,RowIcon:Mo,loadingDialog:$e,ValueViewer:Do,Record:d2,Splitpanes:pe},props:{tab:Object,result:Object,isGettingResults:Boolean,error:Object,time:[String,Number]},emits:["switchTo"],data(){return{resizeObserver:null,pageSize:20,preparingCopy:!1,dataToCopy:null,viewValuePanelVisible:!1,selectedCell:null,viewRecord:!1,defaultPage:1,defaultSelectedCell:null,enableTeleport:this.$store.state.isWorkspaceVisible}},computed:{resultSetTeleportTarget(){if(!this.enableTeleport)return;const t=`#${this.viewValuePanelVisible?"run-result-left-pane":"run-result-result-set"}`,e=`-${this.tab.id}`;return t+e}},watch:{result(){this.defaultSelectedCell=null,this.selectedCell=null}},activated(){this.enableTeleport=!0},deactivated(){this.enableTeleport=!1},mounted(){this.resizeObserver=new ResizeObserver(this.handleResize),this.resizeObserver.observe(this.$refs.runResultPanel),this.calculatePageSize()},beforeUnmount(){this.resizeObserver.unobserve(this.$refs.runResultPanel)},methods:{handleResize(){this.calculatePageSize()},calculatePageSize(){const e=this.$refs.runResultPanel.offsetHeight-27-5-35;this.pageSize=Math.max(Math.floor(e/35),20)},exportToCsv(){this.result&&this.result.values&&M.send("resultset.export",this.result.values[this.result.columns[0]].length,{to:"csv"}),k.exportToFile(se.serialize(this.result),"result_set.csv","text/csv")},async prepareCopy(){if(this.result&&this.result.values&&M.send("resultset.export",this.result.values[this.result.columns[0]].length,{to:"clipboard"}),"ClipboardItem"in window){this.preparingCopy=!0,this.$modal.show("prepareCSVCopy");const t=performance.now();await D.sleep(0),this.dataToCopy=se.serialize(this.result),performance.now()-t<950?(this.$modal.hide("prepareCSVCopy"),this.copyToClipboard()):this.preparingCopy=!1}else alert("Your browser doesn't support copying into the clipboard. If you use Firefox you can enable it by setting dom.events.asyncClipboard.clipboardItem to true.")},copyToClipboard(){ge.copyText(this.dataToCopy,"CSV copied to clipboard successfully"),this.$modal.hide("prepareCSVCopy")},cancelCopy(){this.dataToCopy=null,this.$modal.hide("prepareCSVCopy")},toggleViewValuePanel(){this.viewValuePanelVisible=!this.viewValuePanelVisible},toggleViewRecord(){this.viewRecord&&(this.defaultSelectedCell={row:this.$refs.recordView.currentRowIndex,col:this.selectedCell?+this.selectedCell.dataset.col:0},this.defaultPage=Math.ceil((this.$refs.recordView.currentRowIndex+1)/this.pageSize)),this.viewRecord=!this.viewRecord},onUpdateSelectedCell(t){this.selectedCell=t}}},u2={ref:"runResultPanel",class:"run-result-panel"},h2=["id"],p2=["id"],m2={class:"value-viewer-container"},f2={class:"table-preview"},g2={class:"table-preview result-before"},C2={key:0,class:"table-preview result-in-progress"},v2={class:"table-preview result-empty"};function b2(t,e,s,l,i,n){const r=p("value-viewer"),a=p("export-to-csv-icon"),c=p("icon-button"),g=p("clipboard-icon"),m=p("row-icon"),V=p("view-cell-value-icon"),x=p("side-tool-bar"),w=p("loading-dialog"),E=p("loading-indicator"),C=p("logs"),G=p("sql-table"),N=p("record");return d(),u("div",u2,[(d(),T(he(i.viewValuePanelVisible?"splitpanes":"div"),{before:{size:50,max:100},after:{size:50,max:100},default:{before:50,after:50},class:"run-result-panel-content"},Ge({"left-pane":v(()=>[o("div",{id:"run-result-left-pane-"+s.tab.id,class:"result-set-container"},null,8,h2)]),default:v(()=>[o("div",{id:"run-result-result-set-"+s.tab.id,class:"result-set-container"},null,8,p2)]),_:2},[i.viewValuePanelVisible?{name:"right-pane",fn:v(()=>[o("div",m2,[y(h(r,{cellValue:i.selectedCell?s.result.values[s.result.columns[i.selectedCell.dataset.col]][i.selectedCell.dataset.row]:""},null,8,["cellValue"]),[[_,i.selectedCell]]),y(o("div",f2," No cell selected to view ",512),[[_,!i.selectedCell]])])]),key:"0"}:void 0]),1024)),h(x,{panel:"table",onSwitchTo:e[0]||(e[0]=Oe=>t.$emit("switchTo",Oe))},{default:v(()=>[h(c,{disabled:!s.result,tooltip:"Export result set to CSV file",tooltipPosition:"top-left",onClick:n.exportToCsv},{default:v(()=>[h(a)]),_:1},8,["disabled","onClick"]),h(c,{ref:"copyToClipboardBtn",disabled:!s.result,tooltip:"Copy result set to clipboard",tooltipPosition:"top-left",onClick:n.prepareCopy},{default:v(()=>[h(g)]),_:1},8,["disabled","onClick"]),h(c,{ref:"rowBtn",disabled:!s.result,tooltip:"View record",tooltipPosition:"top-left",active:i.viewRecord,onClick:n.toggleViewRecord},{default:v(()=>[h(m)]),_:1},8,["disabled","active","onClick"]),h(c,{ref:"viewCellValueBtn",disabled:!s.result,tooltip:"View value",tooltipPosition:"top-left",active:i.viewValuePanelVisible,onClick:n.toggleViewValuePanel},{default:v(()=>[h(V)]),_:1},8,["disabled","active","onClick"])]),_:1}),h(w,{loadingMsg:"Building CSV...",successMsg:"CSV is ready",actionBtnName:"Copy",name:"prepareCSVCopy",title:"Copy to clipboard",loading:i.preparingCopy,onAction:n.copyToClipboard,onCancel:n.cancelCopy},null,8,["loading","onAction","onCancel"]),(d(),T(X,{defer:"",to:n.resultSetTeleportTarget,disabled:!i.enableTeleport},[o("div",null,[y(o("div",g2," Run your query and get results here ",512),[[_,s.result===null&&!s.isGettingResults&&!s.error]]),s.isGettingResults?(d(),u("div",C2,[h(E,{size:30}),e[1]||(e[1]=S(" Fetching results... "))])):I("",!0),y(o("div",v2," No rows retrieved according to your query ",512),[[_,s.result===void 0&&!s.isGettingResults&&!s.error]]),s.error?(d(),T(C,{key:1,messages:[s.error]},null,8,["messages"])):I("",!0),s.result&&!i.viewRecord?(d(),T(G,{key:2,"data-set":s.result,time:s.time,pageSize:i.pageSize,page:i.defaultPage,selectedCellCoordinates:i.defaultSelectedCell,class:"straight",onUpdateSelectedCell:n.onUpdateSelectedCell},null,8,["data-set","time","pageSize","page","selectedCellCoordinates","onUpdateSelectedCell"])):I("",!0),s.result&&i.viewRecord?(d(),T(N,{key:3,ref:"recordView","data-set":s.result,time:s.time,selectedColumnIndex:i.selectedCell?+i.selectedCell.dataset.col:0,rowIndex:i.selectedCell?+i.selectedCell.dataset.row:0,onUpdateSelectedCell:n.onUpdateSelectedCell},null,8,["data-set","time","selectedColumnIndex","rowIndex","onUpdateSelectedCell"])):I("",!0)])],8,["to","disabled"]))],512)}const w2=f(c2,[["render",b2],["__scopeId","data-v-a04ab1ca"]]),y2={name:"Tab",components:{SqlEditor:Gi,DataView:bo,RunResult:w2,Splitpanes:pe},props:{tab:Object},emits:[],data(){return{topPaneSize:this.tab.maximize?this.tab.layout[this.tab.maximize]==="above"?100:0:50,enableTeleport:this.$store.state.isWorkspaceVisible}},computed:{isActive(){return this.tab.id===this.$store.state.currentTabId}},watch:{isActive:{immediate:!0,async handler(){var t;this.isActive&&(await ce(),(t=this.$refs.sqlEditor)==null||t.focus())}},"tab.query"(){this.$store.commit("updateTab",{tab:this.tab,newValues:{isSaved:!1}})}},async activated(){this.enableTeleport=!0,this.isActive&&(await ce(),this.$refs.sqlEditor.focus())},deactivated(){this.enableTeleport=!1},async mounted(){this.tab.dataView=this.$refs.dataView},methods:{onSwitchView(t,e){const s=this.tab.layout[t];this.tab.layout[t]=this.tab.layout[e],this.tab.layout[e]=s,M.send("inquiry.panel",null,{panel:e})},onDataViewUpdate(){this.$store.commit("updateTab",{tab:this.tab,newValues:{isSaved:!1}})}}},_2={class:"tab-content-container"},I2=["id"],S2=["id"],V2=["id"];function k2(t,e,s,l,i,n){const r=p("splitpanes"),a=p("sql-editor"),c=p("run-result"),g=p("data-view");return y((d(),u("div",_2,[h(r,{class:"query-results-splitter",horizontal:"",before:{size:i.topPaneSize,max:100},after:{size:100-i.topPaneSize,max:100},default:{before:50,after:50}},{"left-pane":v(()=>[o("div",{id:"above-"+s.tab.id,class:"above"},null,8,I2)]),"right-pane":v(()=>[o("div",{id:"bottom-"+s.tab.id,ref:"bottomPane",class:"bottomPane"},null,8,S2)]),_:1},8,["before","after"]),o("div",{id:"hidden-"+s.tab.id,class:"hidden-part"},null,8,V2),(d(),T(X,{defer:"",to:i.enableTeleport?`#${s.tab.layout.sqlEditor}-${s.tab.id}`:void 0,disabled:!i.enableTeleport},[h(a,{ref:"sqlEditor",modelValue:s.tab.query,"onUpdate:modelValue":e[0]||(e[0]=m=>s.tab.query=m),isGettingResults:s.tab.isGettingResults,onSwitchTo:e[1]||(e[1]=m=>n.onSwitchView("sqlEditor",m)),onRun:e[2]||(e[2]=m=>s.tab.execute())},null,8,["modelValue","isGettingResults"])],8,["to","disabled"])),(d(),T(X,{defer:"",to:i.enableTeleport?`#${s.tab.layout.table}-${s.tab.id}`:void 0,disabled:!i.enableTeleport},[h(c,{tab:s.tab,result:s.tab.result,isGettingResults:s.tab.isGettingResults,error:s.tab.error,time:s.tab.time,onSwitchTo:e[3]||(e[3]=m=>n.onSwitchView("table",m))},null,8,["tab","result","isGettingResults","error","time"])],8,["to","disabled"])),(d(),T(X,{defer:"",to:i.enableTeleport?`#${s.tab.layout.dataView}-${s.tab.id}`:void 0,disabled:!i.enableTeleport},[h(g,{ref:"dataView","data-source":s.tab.result&&s.tab.result.values||null,initOptions:s.tab.viewOptions,initMode:s.tab.viewType,onSwitchTo:e[4]||(e[4]=m=>n.onSwitchView("dataView",m)),onUpdate:n.onDataViewUpdate},null,8,["data-source","initOptions","initMode","onUpdate"])],8,["to","disabled"]))],512)),[[_,n.isActive]])}const L2=f(y2,[["render",k2],["__scopeId","data-v-a1adb64e"]]),z={$on:(...t)=>Y.on(...t),$once:(...t)=>Y.once(...t),$off:(...t)=>Y.off(...t),$emit:(...t)=>Y.emit(...t)},T2={components:{Tab:L2,CloseIcon:Z},emits:[],data(){return{closingTab:null}},computed:{tabs(){return this.$store.state.tabs},selectedTabId(){return this.$store.state.currentTabId}},created(){window.addEventListener("beforeunload",this.leavingSqliteviz)},methods:{emitCreateTabEvent(){z.$emit("createNewInquiry")},leavingSqliteviz(t){this.tabs.some(e=>!e.isSaved)&&(t.preventDefault(),t.returnValue="")},selectTab(t){this.$store.commit("setCurrentTabId",t)},beforeCloseTab(t){this.closingTab=t,t.isSaved?this.closeTab(t):this.$modal.show("close-warn")},closeTab(t){this.$modal.hide("close-warn"),this.$store.commit("deleteTab",t)},saveAndClose(t){z.$on("inquirySaved",()=>{this.closeTab(t),z.$off("inquirySaved")}),this.selectTab(t.id),this.$modal.hide("close-warn"),this.$nextTick(()=>{z.$emit("saveInquiry")})}}},x2={id:"tabs"},q2={key:0,id:"tabs-header"},M2=["onClick"],$2={class:"tab-name"},B2={class:"star"},H2={key:0},O2={key:1,class:"tab-untitled"},E2={id:"start-guide"},N2={class:"dialog-header"},P2={class:"dialog-body"},D2={class:"dialog-buttons-container"};function z2(t,e,s,l,i,n){const r=p("close-icon"),a=p("tab"),c=p("router-link"),g=p("modal");return d(),u("div",x2,[n.tabs.length>0?(d(),u("div",q2,[(d(!0),u(B,null,H(n.tabs,(m,V)=>(d(),u("div",{key:V,class:q([{"tab-selected":m.id===n.selectedTabId},"tab"]),onClick:x=>n.selectTab(m.id)},[o("div",$2,[y(o("span",B2,"*",512),[[_,!m.isSaved]]),m.name?(d(),u("span",H2,b(m.name),1)):(d(),u("span",O2,b(m.tempName),1))]),o("div",null,[h(r,{class:"close-icon",size:10,onClick:x=>n.beforeCloseTab(m)},null,8,["onClick"])])],10,M2))),128))])):I("",!0),(d(!0),u(B,null,H(n.tabs,m=>(d(),T(a,{key:m.id,tab:m},null,8,["tab"]))),128)),y(o("div",E2,[o("span",{class:"link",onClick:e[0]||(e[0]=(...m)=>n.emitCreateTabEvent&&n.emitCreateTabEvent(...m))},"Create"),e[6]||(e[6]=S(" new inquiry from scratch or open one from ")),h(c,{class:"link",to:"/inquiries"},{default:v(()=>e[5]||(e[5]=[S("Inquiries")])),_:1})],512),[[_,n.tabs.length===0]]),h(g,{modalId:"close-warn",class:"dialog",contentStyle:"width: 560px;"},{default:v(()=>[o("div",N2,[S(" Close tab "+b(i.closingTab!==null?i.closingTab.name||`[${i.closingTab.tempName}]`:"")+" ",1),h(r,{onClick:e[1]||(e[1]=m=>t.$modal.hide("close-warn"))})]),o("div",P2," You have unsaved changes. Save changes in "+b(i.closingTab!==null?i.closingTab.name||`[${i.closingTab.tempName}]`:"")+" before closing? ",1),o("div",D2,[o("button",{class:"secondary",onClick:e[2]||(e[2]=m=>n.closeTab(i.closingTab))}," Close without saving "),o("button",{class:"secondary",onClick:e[3]||(e[3]=m=>t.$modal.hide("close-warn"))}," Don't close "),o("button",{class:"primary",onClick:e[4]||(e[4]=m=>n.saveAndClose(i.closingTab))}," Save and close ")])]),_:1})])}const R2=f(T2,[["render",z2]]),A2={name:"Workspace",components:{Schema:hi,Splitpanes:pe,Tabs:R2},data(){return{schemaWidth:this.$route.query.hide_schema==="1"?0:20}},async beforeCreate(){const t=this.$store.state.db.schema;if((!t||t.length===0)&&this.$store.state.tabs.length===0){const e=["/*"," * Your database is empty. In order to start building charts"," * you should create a table and insert data into it."," */","CREATE TABLE house","(","  name TEXT,","  points INTEGER",");","INSERT INTO house VALUES","('Gryffindor', 100),","('Hufflepuff', 90),","('Ravenclaw', 95),","('Slytherin', 80);"].join(`
`),s=await this.$store.dispatch("addTab",{query:e});this.$store.commit("setCurrentTabId",s),M.send("inquiry.create",null,{auto:!0})}},activated(){this.$store.commit("setIsWorkspaceVisible",!0)},deactivated(){this.$store.commit("setIsWorkspaceVisible",!1)}};function F2(t,e,s,l,i,n){const r=p("schema"),a=p("tabs"),c=p("splitpanes");return d(),u("div",null,[h(c,{class:"schema-tabs-splitter",before:{size:i.schemaWidth,max:30},after:{size:100-i.schemaWidth,max:100},default:{before:20,after:80}},{"left-pane":v(()=>[h(r)]),"right-pane":v(()=>[h(a)]),_:1},8,["before","after"])])}const Z2=f(A2,[["render",F2],["__scopeId","data-v-23fd9633"]]),U2={name:"RenameIcon",mixins:[R],emits:["click"],methods:{onClick(){this.hideTooltip(),this.$emit("click")}}};function J2(t,e,s,l,i,n){return d(),u("span",null,[(d(),u("svg",{class:"icon",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",onClick:e[0]||(e[0]=O((...r)=>n.onClick&&n.onClick(...r),["stop"])),onMouseenter:e[1]||(e[1]=(...r)=>t.showTooltip&&t.showTooltip(...r)),onMouseleave:e[2]||(e[2]=(...r)=>t.hideTooltip&&t.hideTooltip(...r))},e[3]||(e[3]=[o("path",{d:`M10.545 6.75L11.25 7.455L4.44 14.25H3.75V13.56L10.545 6.75ZM13.245 2.25C13.0575 2.25
        12.8625 2.325 12.72 2.4675L11.3475 3.84L14.16 6.6525L15.5325 5.28C15.825 4.9875 15.825
        4.5 15.5325 4.2225L13.7775 2.4675C13.6275 2.3175 13.44 2.25 13.245 2.25ZM10.545
        4.6425L2.25 12.9375V15.75H5.0625L13.3575 7.455L10.545 4.6425Z`,fill:"#A2B1C6"},null,-1)]),32)),o("span",{ref:"tooltip",class:"icon-tooltip",style:L(t.tooltipStyle)}," Rename inquiry ",4)])}const j2=f(U2,[["render",J2],["__scopeId","data-v-3ff5526c"]]),W2={name:"CopyIcon",mixins:[R],emits:["click"],methods:{onClick(){this.hideTooltip(),this.$emit("click")}}};function G2(t,e,s,l,i,n){return d(),u("span",null,[(d(),u("svg",{class:"icon",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",onClick:e[0]||(e[0]=O((...r)=>n.onClick&&n.onClick(...r),["stop"])),onMouseenter:e[1]||(e[1]=(...r)=>t.showTooltip&&t.showTooltip(...r)),onMouseleave:e[2]||(e[2]=(...r)=>t.hideTooltip&&t.hideTooltip(...r))},e[3]||(e[3]=[o("path",{d:`M14.25 15.75H6V5.25H14.25V15.75ZM14.25 3.75H6C5.60218 3.75 5.22064 3.90804 4.93934
        4.18934C4.65804 4.47064 4.5 4.85218 4.5 5.25V15.75C4.5 16.1478 4.65804 16.5294 4.93934
        16.8107C5.22064 17.092 5.60218 17.25 6 17.25H14.25C14.6478 17.25 15.0294 17.092 15.3107
        16.8107C15.592 16.5294 15.75 16.1478 15.75 15.75V5.25C15.75 4.85218 15.592 4.47064
        15.3107 4.18934C15.0294 3.90804 14.6478 3.75 14.25 3.75ZM12 0.75H3C2.60218 0.75 2.22064
        0.908035 1.93934 1.18934C1.65804 1.47064 1.5 1.85218 1.5 2.25V12.75H3V2.25H12V0.75Z`,fill:"#A2B1C6"},null,-1)]),32)),o("span",{ref:"tooltip",class:"icon-tooltip",style:L(t.tooltipStyle)}," Duplicate inquiry ",4)])}const K2=f(W2,[["render",G2],["__scopeId","data-v-c1373020"]]),Q2={name:"DeleteIcon",mixins:[R],emits:["click"],methods:{onClick(){this.hideTooltip(),this.$emit("click")}}};function Y2(t,e,s,l,i,n){return d(),u("span",null,[(d(),u("svg",{class:"icon",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",onClick:e[0]||(e[0]=O((...r)=>n.onClick&&n.onClick(...r),["stop"])),onMouseenter:e[1]||(e[1]=r=>t.showTooltip(r,"top-left")),onMouseleave:e[2]||(e[2]=(...r)=>t.hideTooltip&&t.hideTooltip(...r))},e[3]||(e[3]=[o("path",{d:`M6.75 2.25V3H3V4.5H3.75V14.25C3.75 14.6478 3.90804 15.0294 4.18934 15.3107C4.47064
        15.592 4.85218 15.75 5.25 15.75H12.75C13.1478 15.75 13.5294 15.592 13.8107
        15.3107C14.092 15.0294 14.25 14.6478 14.25 14.25V4.5H15V3H11.25V2.25H6.75ZM5.25
        4.5H12.75V14.25H5.25V4.5ZM6.75 6V12.75H8.25V6H6.75ZM9.75 6V12.75H11.25V6H9.75Z`,fill:"#A2B1C6"},null,-1)]),32)),o("span",{ref:"tooltip",class:"icon-tooltip",style:L(t.tooltipStyle)}," Delete inquiry ",4)])}const X2=f(Q2,[["render",Y2],["__scopeId","data-v-e8de9d58"]]),el={name:"Inquiries",components:{RenameIcon:j2,CopyIcon:K2,ExportIcon:Le,DeleteIcon:X2,CloseIcon:Z,TextField:ie,CheckBox:_e,LoadingIndicator:j},mixins:[R],data(){return{filter:null,newName:null,processedInquiryId:null,errorMsg:null,selectedInquiriesIds:new Set,selectedInquiriesCount:0,selectedNotPredefinedCount:0,selectAll:!1,deleteGroup:!1,resizeObserver:null,maxTableHeight:0}},computed:{inquiries(){return this.$store.state.inquiries},predefinedInquiries(){return this.$store.state.predefinedInquiries.map(t=>(t.isPredefined=!0,t))},predefinedInquiriesIds(){return new Set(this.predefinedInquiries.map(t=>t.id))},showedInquiries(){let t=this.allInquiries;return this.filter&&(t=t.filter(e=>e.name.toUpperCase().indexOf(this.filter.toUpperCase())>=0)),t},allInquiries(){return this.predefinedInquiries.concat(this.inquiries)},processedInquiryIndex(){return this.inquiries.findIndex(t=>t.id===this.processedInquiryId)},deleteDialogMsg(){return!this.deleteGroup&&(this.processedInquiryIndex===null||this.processedInquiryIndex<0||this.processedInquiryIndex>this.inquiries.length)?"":`Are you sure you want to delete ${this.deleteGroup?`${this.selectedNotPredefinedCount} ${this.selectedNotPredefinedCount>1?"inquiries":"inquiry"}`:`"${this.inquiries[this.processedInquiryIndex].name}"`}?`}},watch:{showedInquiries:{handler(){this.selectedInquiriesIds=new Set(this.showedInquiries.filter(t=>this.selectedInquiriesIds.has(t.id)).map(t=>t.id)),this.selectedInquiriesCount=this.selectedInquiriesIds.size,this.selectedNotPredefinedCount=[...this.selectedInquiriesIds].filter(t=>!this.predefinedInquiriesIds.has(t)).length,this.selectedInquiriesIds.size<this.showedInquiries.length&&(this.$refs.mainCheckBox&&(this.$refs.mainCheckBox.checked=!1),this.selectAll=!1)},deep:!0}},async created(){const t=this.$store.state.loadingPredefinedInquiries;if(!this.$store.state.predefinedInquiriesLoaded&&!t){try{this.$store.commit("setLoadingPredefinedInquiries",!0);const s=await A.readPredefinedInquiries();this.$store.commit("updatePredefinedInquiries",s),this.$store.commit("setPredefinedInquiriesLoaded",!0)}catch(s){console.error(s)}this.$store.commit("setLoadingPredefinedInquiries",!1)}},mounted(){this.resizeObserver=new ResizeObserver(this.calcMaxTableHeight),this.resizeObserver.observe(this.$refs["my-inquiries-content"]),this.tableResizeObserver=new ResizeObserver(this.calcNameWidth),this.tableResizeObserver.observe(this.$refs.table),this.calcNameWidth(),this.calcMaxTableHeight()},beforeUnmount(){this.resizeObserver.unobserve(this.$refs["my-inquiries-content"]),this.tableResizeObserver.unobserve(this.$refs.table)},methods:{emitCreateTabEvent(){z.$emit("createNewInquiry")},createdAtFormatted(t){if(!t)return"";const e={year:"numeric",month:"long",day:"numeric"},s={hour12:!1,hour:"2-digit",minute:"2-digit"};return new Date(t).toLocaleDateString("en-GB",e)+" "+new Date(t).toLocaleTimeString("en-GB",s)},calcNameWidth(){const t=this.$refs["name-td"]&&this.$refs["name-td"][0]?this.$refs["name-td"][0].getBoundingClientRect().width:0;this.$refs["name-th"].style=`width: ${t}px`},calcMaxTableHeight(){const t=this.$refs["my-inquiries-content"].offsetHeight-200;this.maxTableHeight=t-t%40+1},openInquiry(t){const e=this.showedInquiries[t];setTimeout(()=>{this.$store.dispatch("addTab",e).then(s=>{this.$store.commit("setCurrentTabId",s),this.$router.push("/workspace")})})},showRenameDialog(t){this.errorMsg=null,this.processedInquiryId=t,this.newName=this.inquiries[this.processedInquiryIndex].name,this.$modal.show("rename")},renameInquiry(){if(!this.newName){this.errorMsg="Inquiry name can't be empty";return}this.$store.dispatch("renameInquiry",{inquiryId:this.processedInquiryId,newName:this.newName}),this.$modal.hide("rename")},duplicateInquiry(t){const e=A.duplicateInquiry(this.showedInquiries[t]);this.$store.dispatch("addInquiry",e)},showDeleteDialog(t){this.deleteGroup=t.size>1,this.deleteGroup||(this.processedInquiryId=t.values().next().value),this.$modal.show("delete")},deleteInquiry(){this.$modal.hide("delete"),this.deleteGroup?(this.$store.dispatch("deleteInquiries",this.selectedInquiriesIds),this.selectedInquiriesIds.clear()):(this.$store.dispatch("deleteInquiries",new Set().add(this.processedInquiryId)),this.selectedInquiriesIds.has(this.processedInquiryId)&&this.selectedInquiriesIds.delete(this.processedInquiryId)),this.selectedInquiriesCount=this.selectedInquiriesIds.size},exportToFile(t,e){A.export(t,e)},exportSelectedInquiries(){const t=this.allInquiries.filter(e=>this.selectedInquiriesIds.has(e.id));this.exportToFile(t,"My sqliteviz inquiries.json")},importInquiries(){A.importInquiries().then(t=>{this.$store.commit("setInquiries",this.inquiries.concat(t))})},toggleSelectAll(t){this.selectAll=t,this.$refs.rowCheckBox.forEach(e=>{e.checked=t}),this.selectedInquiriesIds=t?new Set(this.showedInquiries.map(e=>e.id)):new Set,this.selectedInquiriesCount=this.selectedInquiriesIds.size,this.selectedNotPredefinedCount=t?[...this.selectedInquiriesIds].filter(e=>!this.predefinedInquiriesIds.has(e)).length:0},toggleRow(t,e){const s=this.predefinedInquiriesIds.has(e);t?(this.selectedInquiriesIds.add(e),s||(this.selectedNotPredefinedCount+=1)):(this.selectedInquiriesIds.size===this.showedInquiries.length&&(this.$refs.mainCheckBox.checked=!1,this.selectAll=!1),this.selectedInquiriesIds.delete(e),s||(this.selectedNotPredefinedCount-=1)),this.selectedInquiriesCount=this.selectedInquiriesIds.size}}},tl={id:"my-inquiries-container"},sl={key:0,id:"start-guide"},il={key:1,id:"loading-predefined-status"},nl={id:"my-inquiries-content",ref:"my-inquiries-content"},ol={id:"my-inquiries-toolbar"},ll={id:"toolbar-buttons"},rl={id:"toolbar-search"},al={id:"inquiries-not-found"},dl={class:"rounded-bg"},cl={class:"header-container"},ul={ref:"name-th",class:"fixed-header"},hl={ref:"table",class:"sqliteviz-table"},pl=["onClick"],ml={class:"cell-data"},fl={class:"name"},gl={class:"second-column"},Cl={class:"date-container"},vl={class:"icons-container"},bl={class:"dialog-header"},wl={class:"dialog-body"},yl={class:"dialog-buttons-container"},_l={class:"dialog-header"},Il={class:"dialog-body"},Sl={id:"note"},Vl={class:"dialog-buttons-container"};function kl(t,e,s,l,i,n){const r=p("loading-indicator"),a=p("text-field"),c=p("check-box"),g=p("rename-icon"),m=p("copy-icon"),V=p("export-icon"),x=p("delete-icon"),w=p("close-icon"),E=p("modal");return d(),u("div",tl,[n.allInquiries.length===0?(d(),u("div",sl,[e[15]||(e[15]=S(" You don't have saved inquiries so far. ")),o("span",{class:"link",onClick:e[0]||(e[0]=(...C)=>n.emitCreateTabEvent&&n.emitCreateTabEvent(...C))},"Create"),e[16]||(e[16]=S(" the one from scratch or ")),o("span",{class:"link",onClick:e[1]||(e[1]=(...C)=>n.importInquiries&&n.importInquiries(...C))},"import"),e[17]||(e[17]=S(" from a file. "))])):I("",!0),t.$store.state.loadingPredefinedInquiries?(d(),u("div",il,[h(r),e[18]||(e[18]=S(" Loading predefined inquiries... "))])):I("",!0),y(o("div",nl,[o("div",ol,[o("div",ll,[o("button",{id:"toolbar-btns-import",class:"toolbar",onClick:e[2]||(e[2]=(...C)=>n.importInquiries&&n.importInquiries(...C))}," Import "),y(o("button",{id:"toolbar-btns-export",class:"toolbar",onClick:e[3]||(e[3]=C=>n.exportSelectedInquiries())}," Export ",512),[[_,i.selectedInquiriesCount>0]]),y(o("button",{id:"toolbar-btns-delete",class:"toolbar",onClick:e[4]||(e[4]=C=>n.showDeleteDialog(i.selectedInquiriesIds))}," Delete ",512),[[_,i.selectedNotPredefinedCount>0]])]),o("div",rl,[h(a,{modelValue:i.filter,"onUpdate:modelValue":e[5]||(e[5]=C=>i.filter=C),placeholder:"Search inquiry by name",width:"300px"},null,8,["modelValue"])])]),y(o("div",al," No inquiries found ",512),[[_,n.showedInquiries.length===0]]),y(o("div",dl,[o("div",cl,[o("div",null,[o("div",ul,[h(c,{ref:"mainCheckBox",theme:"light",onClick:n.toggleSelectAll},null,8,["onClick"]),e[19]||(e[19]=o("div",{class:"name-th"},"Name",-1))],512),e[20]||(e[20]=o("div",{class:"fixed-header"},"Created at",-1))])]),o("div",{class:"table-container",style:L({"max-height":`${i.maxTableHeight}px`})},[o("table",hl,[o("tbody",null,[(d(!0),u(B,null,H(n.showedInquiries,(C,G)=>(d(),u("tr",{key:C.id,onClick:N=>n.openInquiry(G)},[o("td",{ref_for:!0,ref:"name-td"},[o("div",ml,[h(c,{ref_for:!0,ref:"rowCheckBox",init:i.selectAll||i.selectedInquiriesIds.has(C.id),"data-test":"rowCheckBox",onClick:N=>n.toggleRow(N,C.id)},null,8,["init","onClick"]),o("div",fl,b(C.name),1),C.isPredefined?(d(),u("div",{key:0,class:"badge",onMouseenter:e[6]||(e[6]=(...N)=>t.showTooltip&&t.showTooltip(...N)),onMouseleave:e[7]||(e[7]=(...N)=>t.hideTooltip&&t.hideTooltip(...N))},[e[21]||(e[21]=S(" Predefined ")),o("span",{ref_for:!0,ref:"tooltip",class:"icon-tooltip",style:L(t.tooltipStyle)}," Predefined inquiries come from the server. These inquiries cant be deleted or renamed. ",4)],32)):I("",!0)])],512),o("td",null,[o("div",gl,[o("div",Cl,b(n.createdAtFormatted(C.createdAt)),1),o("div",vl,[C.isPredefined?I("",!0):(d(),T(g,{key:0,onClick:N=>n.showRenameDialog(C.id)},null,8,["onClick"])),h(m,{onClick:N=>n.duplicateInquiry(G)},null,8,["onClick"]),h(V,{tooltip:"Export inquiry to file",tooltipPosition:"top-left",onClick:N=>n.exportToFile([C],`${C.name}.json`)},null,8,["onClick"]),C.isPredefined?I("",!0):(d(),T(x,{key:1,onClick:N=>n.showDeleteDialog(new Set().add(C.id))},null,8,["onClick"]))])])])],8,pl))),128))])],512)],4)],512),[[_,n.showedInquiries.length>0]])],512),[[_,n.allInquiries.length>0]]),h(E,{modalId:"rename",class:"dialog",contentStyle:"width: 560px;"},{default:v(()=>[o("div",bl,[e[22]||(e[22]=S(" Rename inquiry ")),h(w,{onClick:e[8]||(e[8]=C=>t.$modal.hide("rename"))})]),o("div",wl,[h(a,{modelValue:i.newName,"onUpdate:modelValue":e[9]||(e[9]=C=>i.newName=C),label:"New inquiry name",errorMsg:i.errorMsg,width:"100%"},null,8,["modelValue","errorMsg"])]),o("div",yl,[o("button",{class:"secondary",onClick:e[10]||(e[10]=C=>t.$modal.hide("rename"))},"Cancel"),o("button",{class:"primary",onClick:e[11]||(e[11]=(...C)=>n.renameInquiry&&n.renameInquiry(...C))},"Rename")])]),_:1}),h(E,{modalId:"delete",class:"dialog",contentStyle:"width: 480px;"},{default:v(()=>[o("div",_l,[S(" Delete "+b(i.deleteGroup?"inquiries":"inquiry")+" ",1),h(w,{onClick:e[12]||(e[12]=C=>t.$modal.hide("delete"))})]),o("div",Il,[S(b(n.deleteDialogMsg)+" ",1),y(o("div",Sl,e[23]||(e[23]=[o("img",{src:ne},null,-1),S(" Note: Predefined inquiries you've selected won't be deleted ")]),512),[[_,i.selectedInquiriesCount>i.selectedNotPredefinedCount]])]),o("div",Vl,[o("button",{class:"secondary",onClick:e[13]||(e[13]=C=>t.$modal.hide("delete"))},"Cancel"),o("button",{class:"primary",onClick:e[14]||(e[14]=(...C)=>n.deleteInquiry&&n.deleteInquiry(...C))},"Delete")])]),_:1})])}const Ll=f(el,[["render",kl],["__scopeId","data-v-1468f977"]]),Tl={name:"Welcome",components:{DbUploader:ke}},xl={id:"dbloader-container"};function ql(t,e,s,l,i,n){const r=p("db-uploader");return d(),u("div",xl,[h(r,{type:"illustrated"}),e[1]||(e[1]=o("div",{id:"note"}," Sqliteviz is fully client-side. Your database never leaves your computer. ",-1)),o("button",{id:"skip",class:"secondary",onClick:e[0]||(e[0]=a=>t.$router.push("/workspace"))}," Create empty database ")])}const Ml=f(Tl,[["render",ql],["__scopeId","data-v-9b349629"]]),$l="0.26.0",Bl={name:"AppDiagnosticInfo",components:{CloseIcon:Z},data(){return{info:[{name:"sqliteviz version",info:[$l]}]}},async created(){const t=this.$store.state;let e=(await t.db.execute("select sqlite_version()")).values;this.info.push({name:"SQLite version",info:e["sqlite_version()"]}),e=(await t.db.execute("PRAGMA compile_options")).values,this.info.push({name:"SQLite compile options",info:e.compile_options})}},Hl={id:"app-info-container"},Ol={class:"dialog-header"},El={class:"dialog-body"},Nl={class:"options"};function Pl(t,e,s,l,i,n){const r=p("close-icon"),a=p("modal");return d(),u("div",Hl,[o("img",{id:"app-info-icon",src:ne,onClick:e[0]||(e[0]=c=>t.$modal.show("app-info"))}),h(a,{modalId:"app-info",class:"dialog",contentClass:"app-info-modal"},{default:v(()=>[o("div",Ol,[e[2]||(e[2]=S(" App info ")),h(r,{onClick:e[1]||(e[1]=c=>t.$modal.hide("app-info"))})]),o("div",El,[(d(!0),u(B,null,H(i.info,(c,g)=>(d(),u("div",{key:g,class:"info-item"},[S(b(c.name)+" ",1),e[3]||(e[3]=o("div",{class:"divider"},null,-1)),o("div",Nl,[(d(!0),u(B,null,H(c.info,(m,V)=>(d(),u("div",{key:V},b(m),1))),128))])]))),128))])]),_:1})])}const Dl=f(Bl,[["render",Pl],["__scopeId","data-v-fcb9d7c6"]]),zl="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M26.8311%2034.6554C25.4675%2033.8178%2024.177%2032.8655%2022.9735%2031.8086V14.3616H30.5728V36.753C29.3146%2036.0982%2028.0673%2035.399%2026.8311%2034.6554ZM41.4669%2025.8486H33.8675V38.1514C36.3477%2039.3055%2038.884%2040.3334%2041.4669%2041.2313V25.8486ZM22.9735%2035.3046L22.4768%2034.9051C21.7152%2034.2725%2021.0033%2033.6232%2020.3245%2032.9739L2.2947%2030.8763L5.60596%2037.3024L28.7848%2039.2002C26.7511%2038.0537%2024.8082%2036.7513%2022.9735%2035.3046ZM41.0695%2044.6441C38.4829%2043.7946%2035.9458%2042.7997%2033.4702%2041.6641L32.543%2041.198L17.2616%2040.1825L19.8444%2045.593L46.5%2046.209C44.6788%2045.7761%2042.8411%2045.2434%2041.0695%2044.6441ZM9.34768%2014.3616C12.2649%2019.4905%2015.735%2024.2807%2019.6954%2028.6455V11.2651L2.99007%202.99115L1.5%2022.3859L18.702%2031.2592C14.1919%2026.5283%2010.9703%2020.7087%209.34768%2014.3616Z'%20fill='%23119DFF'/%3e%3c/svg%3e",Rl={name:"MainMenu",components:{TextField:ie,CloseIcon:Z,AppDiagnosticInfo:Dl},data(){return{name:"",errorMsg:null}},computed:{currentInquiry(){return this.$store.state.currentTab},isSaved(){return this.currentInquiry&&this.currentInquiry.isSaved},isPredefined(){return this.currentInquiry&&this.currentInquiry.isPredefined},runDisabled(){return this.currentInquiry&&(!this.$store.state.db||!this.currentInquiry.query)}},created(){z.$on("createNewInquiry",this.createNewInquiry),z.$on("saveInquiry",this.checkInquiryBeforeSave),document.addEventListener("keydown",this._keyListener)},beforeUnmount(){document.removeEventListener("keydown",this._keyListener)},methods:{createNewInquiry(){this.$store.dispatch("addTab").then(t=>{this.$store.commit("setCurrentTabId",t),this.$route.path!=="/workspace"&&this.$router.push("/workspace")}),M.send("inquiry.create",null,{auto:!1})},cancelSave(){this.$modal.hide("save"),z.$off("inquirySaved")},checkInquiryBeforeSave(){this.errorMsg=null,this.name="",A.isTabNeedName(this.currentInquiry)?this.$modal.show("save"):this.saveInquiry()},async saveInquiry(){if(A.isTabNeedName(this.currentInquiry)&&!this.name){this.errorMsg="Inquiry name can't be empty";return}const e=this.currentInquiry.result,s=this.currentInquiry.view,l=await this.$store.dispatch("saveInquiry",{inquiryTab:this.currentInquiry,newName:this.name});this.$store.commit("updateTab",{tab:this.currentInquiry,newValues:{name:l.name,id:l.id,query:l.query,viewType:l.viewType,viewOptions:l.viewOptions,isSaved:!0}}),this.$nextTick(()=>{this.currentInquiry.result=e,this.currentInquiry.view=s}),this.$modal.hide("save"),z.$emit("inquirySaved"),M.send("inquiry.save")},_keyListener(t){if(this.$route.path==="/workspace"){if((t.key==="r"||t.key==="Enter")&&(t.ctrlKey||t.metaKey)){t.preventDefault(),this.runDisabled||this.currentInquiry.execute();return}if(t.key==="s"&&(t.ctrlKey||t.metaKey)){t.preventDefault(),this.isSaved||this.checkInquiryBeforeSave();return}}t.key==="b"&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),this.createNewInquiry())}}},Al={id:"nav-links"},Fl={id:"nav-buttons"},Zl=["disabled"],Ul={class:"dialog-header"},Jl={class:"dialog-body"},jl={id:"save-note"},Wl={class:"dialog-buttons-container"};function Gl(t,e,s,l,i,n){const r=p("router-link"),a=p("app-diagnostic-info"),c=p("close-icon"),g=p("text-field"),m=p("modal");return d(),u("nav",null,[o("div",Al,[e[7]||(e[7]=o("a",{href:"https://sqliteviz.com"},[o("img",{src:zl})],-1)),h(r,{to:"/workspace"},{default:v(()=>e[5]||(e[5]=[S("Workspace")])),_:1}),h(r,{to:"/inquiries"},{default:v(()=>e[6]||(e[6]=[S("Inquiries")])),_:1}),e[8]||(e[8]=o("a",{href:"https://sqliteviz.com/docs",target:"_blank"},"Help",-1))]),o("div",Fl,[y(o("button",{id:"save-btn",class:"primary",disabled:n.isSaved,onClick:e[0]||(e[0]=(...V)=>n.checkInquiryBeforeSave&&n.checkInquiryBeforeSave(...V))}," Save ",8,Zl),[[_,n.currentInquiry&&t.$route.path==="/workspace"]]),o("button",{id:"create-btn",class:"primary",onClick:e[1]||(e[1]=(...V)=>n.createNewInquiry&&n.createNewInquiry(...V))}," Create "),h(a)]),h(m,{modalId:"save",class:"dialog",contentStyle:"width: 560px;"},{default:v(()=>[o("div",Ul,[e[9]||(e[9]=S(" Save inquiry ")),h(c,{onClick:n.cancelSave},null,8,["onClick"])]),o("div",Jl,[y(o("div",jl,e[10]||(e[10]=[o("img",{src:ne},null,-1),S(" Note: Predefined inquiries can't be edited. That's why your modifications will be saved as a new inquiry. Enter the name for it. ")]),512),[[_,n.isPredefined]]),h(g,{modelValue:i.name,"onUpdate:modelValue":e[2]||(e[2]=V=>i.name=V),label:"Inquiry name",errorMsg:i.errorMsg,width:"100%"},null,8,["modelValue","errorMsg"])]),o("div",Wl,[o("button",{class:"secondary",onClick:e[3]||(e[3]=(...V)=>n.cancelSave&&n.cancelSave(...V))},"Cancel"),o("button",{class:"primary",onClick:e[4]||(e[4]=(...V)=>n.saveInquiry&&n.saveInquiry(...V))},"Save")])]),_:1})])}const Kl=f(Rl,[["render",Gl],["__scopeId","data-v-ef3ea716"]]),Ql={name:"MainView",components:{MainMenu:Kl}};function Yl(t,e,s,l,i,n){const r=p("main-menu"),a=p("router-view");return d(),u("div",null,[h(r),h(a,{id:"main-view"},{default:v(({Component:c})=>[(d(),T(Ke,{include:"Workspace,Inquiries"},[(d(),T(he(c)))],1024))]),_:1})])}const Xl=f(Ql,[["render",Yl],["__scopeId","data-v-819870b1"]]),er={name:"LoadView",components:{Logs:oe},data(){return{newDb:null,messages:[],dataMsg:{},inquiryMsg:{}}},computed:{hasErrors(){return this.dataMsg.type==="error"||this.inquiryMsg.type==="error"}},async created(){const{data_url:t,data_format:e,inquiry_url:s,inquiry_id:l,maximize:i}=this.$route.query;M.send("share.load",null,{has_data_url:!!t,data_format:e,has_inquiry_url:!!s,inquiry_id_count:(l||[]).length,maximize:i}),await this.loadData(t,e);const n=await this.loadInquiries(s,l);n&&n.length>0&&await this.openInquiries(n,i),this.hasErrors||this.$router.push("/workspace?hide_schema=1")},methods:{async loadData(t,e){if(this.newDb=me.getNewDatabase(),t){this.dataMsg={message:"Preparing data...",type:"info"},this.messages.push(this.dataMsg);const s=setTimeout(()=>{this.dataMsg.type==="info"&&(this.dataMsg.type="loading")},1e3);e==="sqlite"?await this.getSqliteDb(t):(this.dataMsg.message="Unknown data format",this.dataMsg.type="error"),clearTimeout(s)}else await this.newDb.loadDb();this.$store.commit("setDb",this.newDb)},async getSqliteDb(t){try{const e=new URL(t).pathname.split("/").pop(),s=await k.readFile(t);if(!s.ok)throw new Error("Fetching DB failed");const l=await s.blob();l.name=e,await this.newDb.loadDb(l),this.dataMsg.message="Data is ready",this.dataMsg.type="success"}catch(e){console.error(e),this.dataMsg.message=e,this.dataMsg.type="error"}},async loadInquiries(t,e=[]){if(!t)return[];const s=setTimeout(()=>{this.inquiryMsg.type==="info"&&(this.inquiryMsg.type="loading")},1e3);try{this.inquiryMsg={message:"Preparing inquiries...",type:"info"},this.messages.push(this.inquiryMsg);const i=await(await k.readFile(t)).json();return this.inquiryMsg.message="Inquiries are ready",this.inquiryMsg.type="success",e.length>0?i.inquiries.filter(n=>e.includes(n.id)):i.inquiries}catch(l){console.error(l),this.inquiryMsg.message=l,this.inquiryMsg.type="error"}clearTimeout(s)},async openInquiries(t,e){let s=null;const l=e?this.getLayout(e):void 0;for(const i of t){const n=await this.$store.dispatch("addTab",{...i,id:void 0,layout:l,maximize:e});s||(s=n,this.$store.commit("setCurrentTabId",s))}this.$store.state.currentTab.execute()},getLayout(t){return t==="dataView"?{sqlEditor:"hidden",table:"above",dataView:"bottom"}:{sqlEditor:"above",table:"bottom",dataView:"hidden"}}}};function tr(t,e,s,l,i,n){const r=p("logs");return d(),u("div",null,[h(r,{id:"logs",messages:i.messages},null,8,["messages"]),n.hasErrors?(d(),u("button",{key:0,id:"open-workspace-btn",class:"secondary",onClick:e[0]||(e[0]=a=>t.$router.push("/workspace?hide_schema=1"))}," Open workspace ")):I("",!0)])}const sr=f(er,[["render",tr],["__scopeId","data-v-4772b802"]]),ir=[{path:"/",name:"Welcome",component:Ml},{path:"/",name:"MainView",component:Xl,children:[{path:"/workspace",name:"Workspace",component:Z2},{path:"/inquiries",name:"Inquiries",component:Ll}]},{path:"/load",name:"Load",component:sr}],Be=Qe({history:Ye(),routes:ir});Be.beforeEach(async(t,e,s)=>{if(!F.state.db&&t.name!=="Load"){const l=me.getNewDatabase();await l.loadDb(),F.commit("setDb",l)}s()});["localhost","127.0.0.1"].includes(location.hostname)||ot(()=>import("./registerServiceWorker-1SkHNPsI.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url);const He=Xe(ct).use(Be).use(F).use(et()).component("modal",tt),be=st();He.config.globalProperties.$modal={show:t=>be.open(t),hide:t=>be.close(t)};He.mount("#app");export{M as e};
//# sourceMappingURL=index-CkTGTivK.js.map
